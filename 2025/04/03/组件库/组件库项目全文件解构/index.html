<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>组件库全文件解构 | 松风狸 | Breezli</title><meta name="keywords" content="组件库,源码"><meta name="author" content="Breezli"><meta name="copyright" content="Breezli"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="组件库全文件解构"><meta name="application-name" content="组件库全文件解构"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="组件库全文件解构"><meta property="og:url" content="http://example.com/2025/04/03/%E7%BB%84%E4%BB%B6%E5%BA%93/%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE%E5%85%A8%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%84/index.html"><meta property="og:site_name" content="松风狸 | Breezli"><meta property="og:description" content="项目结构12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif?_r_=2fc805ad-7584-6008-91cd-3016a38959a8"><meta property="article:author" content="Breezli"><meta property="article:tag" content="前端, 博客"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif?_r_=2fc805ad-7584-6008-91cd-3016a38959a8"><meta name="description" content="项目结构12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/04/03/%E7%BB%84%E4%BB%B6%E5%BA%93/%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE%E5%85%A8%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%84/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css#fontawesome_animation 如果有就会加载，示例值：https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"春梦随云散，飞花逐水流          ......","backTitle":"草木缱绻，风月无边              ......"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"api","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":["💻 前端技术学者","📕 红迷","🌄 旅行爱好者","🎨 国画九级选手","💤 睡觉居士","📜 诗词爱好者"]},
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Breezli","link":"链接: ","source":"来源: 松风狸 | Breezli","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '松风狸 | Breezli',
  title: '组件库全文件解构',
  postAI: '',
  pageFillDescription: '项目结构, 项目解构, ├─ .nvmrc, ├─ env.d.ts, ├─ libs, ├─ vite-plugins, ├─ hooksPlugin.ts, ├─ index.ts, ├─ package.json, └─ vite.config.ts, └─ vitepress-preview-component, ├─ container, ├─ packages, ├─ components, ├─ Alert, –API–, ├─ Alert.test.tsx, ├─ Alert.vue, ├─ index.ts, ├─ style.css, └─ types.ts, ├─ Button, –API–, ├─ Button.test.tsx, ├─ Button.vue, ├─ ButtonGroup.vue, ├─ constants.ts, ├─ index.ts, ├─ style.css, └─ types.ts, ├─ Collapse, –API–, ├─ Collapse.test.tsx, ├─ Collapse.vue, ├─ CollapseItem.vue, ├─ constants.ts, ├─ index.ts, ├─ style.css, ├─ transitionEvents.ts, └─ types.ts, ├─ ConfigProvider, –API–, ├─ ConfigProvider.vue, ├─ constants.ts, ├─ hooks.ts, ├─ index.ts, └─ types.ts, ├─ Dropdown, –API–, ├─ constants.ts, ├─ Dropdown.test.tsx, ├─ Dropdown.vue, ├─ DropdownItem.vue, ├─ index.ts, ├─ style.css, └─ types.ts, ├─ Form, –API–, ├─ constants.ts, ├─ Form.vue, ├─ FormItem.vue, ├─ hooks.ts, ├─ index.ts, ├─ style.css, └─ types.ts, ├─ Icon, ├─ Icon.vue, ├─ index.ts, ├─ style.css, └─ types.ts, ├─ Input, –API–, ├─ index.ts, ├─ Input.test.tsx, ├─ Input.vue, ├─ style.css, └─ types.ts, ├─ Loading, –API–, ├─ directive.ts, ├─ index.ts, ├─ Loading.test.tsx, ├─ Loading.vue, ├─ service.ts, ├─ style.css, └─ types.ts, ├─ Message, –API–, ├─ index.ts, ├─ Message.test.tsx, ├─ Message.vue, ├─ methods.ts, ├─ style.css, └─ types.ts, ├─ MessageBox, –API–, ├─ index.ts, ├─ MessageBox.test.tsx, ├─ MessageBox.vue, ├─ methods.ts, ├─ style.css, └─ types.ts, ├─ Notification, –API–, ├─ index.ts, ├─ methods.ts, ├─ Notification.test.tsx, ├─ Notification.vue, ├─ style.css, └─ types.ts, ├─ Overlay, –API–, ├─ Overlay.vue, └─ types.ts, ├─ Popconfirm, –API–, ├─ index.ts, ├─ Popconfirm.test.tsx, ├─ Popconfirm.vue, ├─ style.css, └─ types.ts, ├─ Select, –API–, ├─ constants.ts, ├─ index.ts, ├─ Option.vue, ├─ Select.vue, ├─ style.css, ├─ types.ts, └─ useKeyMap.ts, ├─ Switch, –API–, ├─ index.ts, ├─ style.css, ├─ Switch.test.tsx, ├─ Switch.vue, └─ types.ts, ├─ Tooltip, –API–, ├─ index.ts, ├─ style.css, ├─ Tooltip.test.tsx, ├─ Tooltip.vue, ├─ types.ts, └─ useEventsToTiggerNode.ts, ├─ Upload, –API–, ├─ index.ts, ├─ types.ts, ├─ Upload.vue, └─ UploadList.vue, ├─ index.test.ts, ├─ index.ts, └─ package.json, ├─ constants, ├─ index.ts, ├─ key.ts, └─ package.json, ├─ core, ├─ build, ├─ vite.es.config.ts, └─ vite.umd.config.ts, ├─ componens.ts, ├─ index.ts, ├─ makeInstaller.ts, ├─ package.json, └─ pringLogo.ts, ├─ docs, ├─ .vitepress, ├─ config.ts, └─ theme, └─ index.ts, ├─ components, ├─ alert.md, ├─ button.md, ├─ collapse.md, ├─ dropdown.md, ├─ form.md, ├─ loading.md, ├─ message.md, ├─ messagebox.md, ├─ notification.md, ├─ popconfirm.md, └─ tooltip.md, ├─ demo, ├─ alert, ├─ button, ├─ collapse, │  │  │  ├─ dropdown, ├─ form, ├─ loading, ├─ message, ├─ messagebox, ├─ notification, ├─ popconfirm, └─ tooltip, ├─ get-started.md, ├─ index.md, └─ package.json, ├─ hooks, ├─ index.ts, ├─ package.json, ├─ useClickOutside.ts, ├─ useDisabledStyle.ts, ├─ useEventListener.ts, ├─ useFocusController.ts, ├─ useId.ts, ├─ useLocale.ts, ├─ useOffset.ts, ├─ useProp.ts, ├─ useZIndex.ts, ├─ vite.config.ts, └─ test, ├─ index.test.tsx, ├─ useClickOutset.test.tsx, └─ useEventListener.test.tsx, ├─ locale, ├─ index.ts, ├─ lang, ├─ en.ts, ├─ ja.ts, ├─ ko.ts, ├─ zh-cn.ts, └─ zh-tw.ts, └─ package.json, ├─ play, ├─ .storybook, ├─ main.js, └─ preview.js, ├─ index.html, ├─ public, └─ vite.svg, ├─ src, ├─ App.vue, ├─ main.ts, ├─ stories, ├─ Alert.stories.tsx, ├─ Button.stories.ts, └─ Collapse.stories.ts, └─ vite-env.d.ts, ├─ vite.config.ts, ├─ README.md, └─ package.json, ├─ theme, ├─ index.css, ├─ package.json, └─ reset.css, └─ utils, ├─ error.ts, ├─ index.ts, ├─ install.ts, ├─ package.json, ├─ style.ts, └─ tests, ├─ error.test.tsx, ├─ index.test.tsx, └─ install.test.tsx, ├─ package.json, ├─ pnpm-lock.yaml, ├─ pnpm-workspace.yaml, ├─ postcss.config.cjs, ├─ tsconfig.build.json, ├─ tsconfig.json, ├─ tsconfig.node.json, ├─ vitest.config.ts, └─ vitest.setup.ts, 各工作区依赖环境详情, 根目录, x2Fpackagesx2Futils, x2Fpackagesx2Fcomponents, x2Fpackagesx2Fconstants, x2Fpackagesx2Fcore, x2Fpackagesx2Fdocs, x2Fpackagesx2Fhooks, x2Fpackagesx2Flocale, x2Fpackagesx2Fplay, x2Fpackagesx2Ftheme项目结构这是一个组件库项目技术栈测试工具打包工具项目部署站点生成页面托管自动化部署项目解构控制版本的用来区分不同的运行环境生产开发和测试生产开发测试在项目的构建脚本或配置文件中会依据这些变量来决定是否启用某些调试工具日志记录或者优化措施生产环境情景当你构建并部署你的应用到生产服务器上时例如通过流程自动部署到或者其他任何生产环境假设你在配置文件中为生产环境设置了操作执行构建命令如后再将生成的静态资源部署到生产环境结果在启动或加载应用程序的过程中如果该函数被执行那么将会看到那个带有渐变色效果的艺术出现在服务器日志或者浏览器控制台中开发模式情景当你在本地开发环境中运行你的项目时比如使用或者类似的命令启动一个热重载的开发服务器操作直接在终端执行或者配置好的开发模式启动脚本结果在控制台中你会看到简单的提示消息这表明现在正处于开发模式下并且可以快速识别出当前的工作状态测试环境情景运行单元测试或集成测试时例如使用通常不会设置或变量为因此在这种情况下既不满足生产环境也不满足开发模式的条件操作执行测试命令如或结果控制台上不会显示上述的艺术或开发模式的消息以避免干扰测试输出辅助库工具自定义插件组件预览插件项目分包所有的组件逻辑提示标题类型描述性文本是否可以关闭文字是否居中是否展示图标主题样式关闭时触发的事件默认插槽用于设置的内容描述标题的内容打开关闭不符合定义的单组件测试是测试框架提供定义测试套件定义单个测试用例断言工具的测试工具库函数用于挂载组件以便测试引入需要测试的组件引入组件的类型定义确保的类型正确属性的类名测试属性被设置时组件添加了对应的类名如包含所有可能的值遍历每个类型通过挂载组件并传递当前值作为断言类名是否包含属性的类名测试属性被设置时组件添加了对应的类名如等布尔属性的类名测试一个参数化测试通过数组中的每一项生成多个测试用例当如被设置为时组件添加了对应的类名如挂载组件设置断言类名是否包含属性的属性测试当是时组件的属性等于如设置为为标签名是否为属性是否为属性的标签名测试当被设置为时组件的根元素为标签挂载组件并设置为断言标签名是否为小写事件测试点击按钮时触发事件使用模拟点击事件需确保异步完成断言是否有次触发组件实现响应式计算上下文依赖项注入标识按钮组上下文节流事件处理自定义的图标组件定义组件的名称为定义组件的设置默认值标签名原生按钮类型启用节流节流持续时间事件发射器插槽用于动态渲染内容注入按钮组上下文如果存在用于继承按钮组的配置如等计算属性优先使用按钮组上下文中的其次使用最后为空字符串计算属性优先使用按钮组上下文中的其次使用最后为空字符串定义计算属性优先使用其次使用按钮组上下文中的最后为计算属性当按钮有默认插槽内容时图标右侧添加的间距否则不添加间距触发事件并将事件对象传递给父组件使用对进行节流限制点击事件的触发频率暴露组件的内部状态和方法供父组件通过访问动态决定组件的根标签类型为组件实例绑定一个引用可通过获取到该按钮的元素使用对象语法动态绑定类名当存在时如添加类名当存在时如添加类名当为时添加类名当为时添加类名为则渲染为按钮被禁用当为时按钮自动获得焦点当为时调用防抖的方法否则调用普通点击事件条件插槽默认接收用户传来的标签默认提供加载图标不是库中的就默认图标为默认用户可改锁定的大小注入键主要作用是为按钮组组件提供上下文使得按钮组中的子按钮可以访问父级按钮组的相关信息原始数据类型用于创建唯一的标识符举个例子父组件会使用方法将某些数据或方法提供给子组件提供上下文子组件可以通过方法获取父组件提供的上下文注入上下文输出用方法将组件注册为全局组件折叠面板最新版本更新缓存测试基础结构以及对应文本点击标题展开关闭内容发送正确的事件内容变更手风琴模式手风琴模式错误处理手风琴模式存在删除数组中的一项不存在插入对应全局配置组件用于设置组件库的全局属性下拉菜单测试函数是否被正确应用测试组件是否被正确导出可选测试是否增强了组件的功能这里可以添加更多测试确保增强了组件的特定功能可选如果你的函数有特定的行为或属性确保它们被正确应用例如如果你的增加了一个特定的方法或属性表单用于收集用户输入图标组件输入框组件接收用户输入针对动态的测试正确的标签和节点针对的测试针对的测试初始值更新值会触发和事件异步更新不应该出现区域出现区域点击区域触发事件不应该出现区域点击切换缓存修改值且失去焦点才触发显示加载状态也很好看顶部消息弹出框调用方法应该创建对应的组件多次调用应该创建多个实例创建多个实例应该设置正确的中获取的数值都为的高度退出动画更流畅中心弹出框角落弹出通知框这个的高度遮罩层组件用于覆盖页面内容气泡确认框测试函数是否被正确应用测试组件是否被正确导出可选测试是否增强了组件的功能这里可以添加更多测试确保增强了组件的特定功能可选如果你的函数有特定的行为或属性确保它们被正确应用例如如果你的增加了一个特定的方法或属性测试组件是否能够接收所有检查是否被正确设置测试插槽内容弹出层是否出现下拉选择框组件用于从一组选项中选择一个或多个值开关组件用于在两种状态之间切换确保这是你的组件的路径文字提示显示额外的信息测试函数是否被正确应用测试组件是否被正确导出可选测试是否增强了组件的功能这里可以添加更多测试确保增强了组件的特定功能可选如果你的函数有特定的行为或属性确保它们被正确应用例如如果你的增加了一个特定的方法或属性弹出层是否出现再次点击等待动画区域外点击关闭注销流程省略其他设置测试悬停显示测试悬外隐藏右键菜单触发的测试省略其他设置测试右键菜单显示测试右键菜单隐藏可以模拟点击外部区域手动模式的测试省略其他设置测试手动触发显示和隐藏假设方法可以通过某种方式访问禁用状态的测试省略其他设置测试禁用状态下点击不会触发显示虚拟触发节点的测试省略其他设置测试虚拟节点的事件触发为了一个初始设计上的小失误后续重构虚拟目标节点时解决上传组件用于上传文件项目依赖无开发依赖客户端用于测试或示例常量系统项目依赖空包开发依赖客户端用于测试或示例核心包托管模式包的入口同时作为的唯一出口负责聚合所有子模块如等的功能并提供给外部使用构建入口放的两个配置文件构建在构建完成后将目录移动到目录使用命令执行移动操作通过和处理异步操作支持的单文件组件生成构建性能分析报告生成类型定义文件压缩代码仅生产环境启用自定义构建钩子如清理文件和移动文件输出目录为配置库的入口文件名称文件名格式声明外部依赖避免打包到最终输出中手动分块策略第三方库自定义钩子工具函数组件目录如对应组件名称的分块构建同步读取文件集中导出组件将组件注册为插件用户通过可以一次性安装所有组件全局注册构建配置插件安装器将组件集合转换为插件并支持全局配置如主题国际化防止重复安装插件通过注册所有组件支持全局配置如通过提供主题或默认选项项目依赖开发依赖压缩插件打包分析插件文件压缩插件项目元数据与依赖管理定义构建目标入口文件依赖关系等使用构建的组件库指定使用模块格式的入口文件格式的入口文件类型定义文件的位置定义模块导出路径分别指向不同环境的入口文件入口入口类型定义额外指定了对目录下资源的导入规则许可证类型为一个简化的开源许可证开发环境插件用于压缩代码提供构建结果的可视化分析解析器和压缩工具插件用于压缩资源文件图标集核心库通常用于定位提示框菜单等元素异步表单验证库补充核心依赖库被重复下载此时我们应该在结构就变成了通常用于库或插件这些库或插件不直接包含在最终应用中但需要与其他包协同工作当你安装一个包时如果该包有或会检查这些依赖是否已经安装在项目中如果没有它会给出警告但不会默认安装它们构建时输出和提示信息在生产环境构建时打印彩色在开发环境提示当前模式项目正在生产环境中运行彩色渐变的文字样式是占位符表示接下来的一个参数应该被解释为样式是实际要打印到控制台的文字内容即那个艺术风格的项目处于开发模式下简单地向控制台输出一条有助于开发者快速识别项目的当前状态是处于开发阶段组件库项目文档站点依赖无通过根目录继承开发依赖组件预览插件插件文档框架钩子函数自定义的组合式逻辑复用用于处理各种功能需求的入口文件导出所有依赖无必须由用户安装核心库的模块版本监听用户是否点击了某个元素之外的区域实现下拉菜单弹窗等需要点击外部关闭的功能动态控制组件的禁用样式可以根据属性动态添加或移除样式类封装了一个通用的事件监听器支持在组件生命周期内自动绑定和解绑事件避免内存泄漏对焦点的管理功能聚焦某个元素或在多个元素之间切换焦点生成唯一的通常用于组件内部需要唯一标识符的场景提供国际化支持动态获取当前语言环境下的文本内容计算某个元素相对于视口或其他父级元素的偏移量实现悬浮层弹出框等需要精确定位的功能上一个实例最下面的坐标第一个是本元素应该的为下一个实例预留的底部封装了对组件的处理逻辑提供更安全的默认值和类型检查管理弹窗的层级确保组件的层级关系正确如弹窗加载遮罩等测试文件对入口文件的单元测试对的单元测试验证其点击外部区域的行为是否符合预期对的单元测试验证事件监听器的绑定和解绑是否正常国际化语言包空包实验室项目依赖无通过根目录继承开发依赖截图测试工具的扩展插件的支持的集成的插件命令行工具核心样式系统样式构建流程集中在包采用核心包托管模式包仅作为源码存在项目依赖无工具函数和辅助方法支持组件库的底层逻辑错误处理相关的工具函数例如抛出错误捕获异常等导出公共类型或接口给附加一些方法和对象使用举例依赖无处理动态样式或变量对的单元测试验证错误处理逻辑是否正确对入口文件的单元测试对的单元测试验证组件注册逻辑是否正常根目录依赖构建子项目的静态文档站点开发依赖的类型定义的类型定义的类型定义的插件的插件的覆盖率插件测试工具的配置跨平台环境变量设置压缩工具环境模拟并行运行脚本插件代码格式化工具打包工具命令封装生成声明文件的编译器图标库核心实体图标的集成用于弹窗定位的工作区内的组件库工作区内的钩子库工作区内的主题库工作区内的工具库工作区内的国际化库工作区内的常量库表单验证库的模块版本核心库开发依赖国际化库总结核心依赖所有相关包的依赖图标库表单验证开发依赖测试构建工具查看依赖树查看依赖原因环境工作区的配置文件用于管理多个包之间的依赖关系所有位于目录下的子目录都被视为独立的包并且是工作区的一部分同样的目录下的子目录也被视为独立的包被视为工作区的一部分如果你有一个包在文件夹中依赖了另一个位于文件夹中的包不会从远程仓库下载该依赖而是创建一个符号链接指向该本地包的位置当你在一个工作区内的任意一个包中安装依赖时会将这些依赖安装在工作区根目录下的文件夹内工作区内所有的包可以共享相同的依赖版本减少了重复安装和存储空间的浪费是一个使用转换的工具该文件是的配置文件详情见文档中文网或一系列插件支持嵌套循环功能循环控制颜色混合编译器的配置文件定义如何编译项目中的文件使用提供的基础配置并在其基础上进行扩展包含一系列编译选项编译后的目标版本为使用模块系统为了支持最新的模块标准列出了编译过程中需要包含的库文件忽略所有声明文件的类型检查加快编译速度适应现代构建工具如的模块解析机制将被保留以便后续处理严格模式禁止未使用的局部变量禁止未使用的函数参数应被包含在编译过程中的文件应被排除在编译过程中的文件专门为环境下的配置文件基于版本的标准配置所有以结尾的文件都应该被包含进来该项目是一个复合项目可以与其他项目共享编译输出使用模块系统为了支持最新的模块标准适应现代构建工具如的模块解析机制指定要包含的类型声明确保的全局变量和模块都能被正确识别测试框架的配置文件引用类型声明告诉编译器包含的类型定义定义配置对象函数被应用到构建过程中的插件对单文件组件的支持语法的支持定义全局常量将测试框架暴露为全局变量可以直接使用等而无需每次都导入测试将在模拟的浏览器环境中运行对标需要操作的测试指定在所有测试之前自动运行用于全局的初始化工作通常用于在运行测试之前执行一些初始化逻辑在这个项目中初始化图标库整个测试过程中使用风格的图标所有的风格图标集将图标添加到了的库中任何需要使用图标的组件或测试都可以直接访问这些图标而不需要再次单独引入它们避免了由于图标未加载而导致的测试失败扩展大小旋转各工作区依赖环境详情根目录生产环境依赖开发环境依赖生产环境依赖无明确声明开发环境依赖无仅包含一个测试脚本生产环境依赖在中可能是误置开发环境依赖无明确声明除了外生产环境依赖无开发环境依赖无生产环境依赖开发环境依赖生产环境依赖无开发环境依赖生产环境依赖无开发环境依赖无但有生产环境依赖无开发环境依赖无生产环境依赖无开发环境依赖无生产环境依赖无开发环境依赖请注意对于其中被放置在中这可能是错误配置除非它确实只用于开发环境此外某些包如使用了来定义其对其他包的依赖关系这些依赖需要由使用者提供',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-04-03 08:46:08',
  postMainColor: '#ffffff',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/map.css"><link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/512.png"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">松风狸 | Breezli</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/music/?id=13242559326&amp;server=netease"><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/charts/"><i class="anzhiyufont anzhiyu-icon-cube faa-tada" style="font-size: 0.9em;"></i><span> 统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 梦境</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-plant-fill faa-tada" style="font-size: 0.9em;"></i><span> 簪花人间</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/cinema/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 匣中秋水</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/gallerygroup/"><i class="anzhiyufont anzhiyu-icon-instagram faa-tada" style="font-size: 0.9em;"></i><span> 彩云霁月</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 社交</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/games/"><i class="anzhiyufont anzhiyu-icon-rocket faa-tada" style="font-size: 0.9em;"></i><span> 游戏</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">17</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">19</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">三月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">32</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BB%84%E4%BB%B6%E5%BA%93/" itemprop="url">组件库</a></span><span class="article-meta tags"></span></div></div><h1 class="post-title" itemprop="name headline">组件库全文件解构</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-04-02T20:37:00.507Z" title="发表于 2025-04-03 04:37:00">2025-04-03</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-04-03T00:46:08.362Z" title="更新于 2025-04-03 08:46:08">2025-04-03</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="组件库全文件解构"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为成都"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>成都</span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/04/03/%E7%BB%84%E4%BB%B6%E5%BA%93/%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE%E5%85%A8%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%84/"><header><a class="post-meta-categories" href="/categories/%E7%BB%84%E4%BB%B6%E5%BA%93/" itemprop="url">组件库</a><h1 id="CrawlerTitle" itemprop="name headline">组件库全文件解构</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Breezli</span><time itemprop="dateCreated datePublished" datetime="2025-04-02T20:37:00.507Z" title="发表于 2025-04-03 04:37:00">2025-04-03</time><time itemprop="dateCreated datePublished" datetime="2025-04-03T00:46:08.362Z" title="更新于 2025-04-03 08:46:08">2025-04-03</time></header><h1 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br></pre></td><td class="code"><pre><span class="line">这是一个组件库项目，技术栈：Vue 3 + TypeScript + Vite，测试工具：Vitest + Storybook，打包工具：Rollup + Vue-Test-Utils，项目部署：VitePress站点生成 + GitHubPages页面托管 + github actions CI/CD 自动化部署</span><br><span class="line"></span><br><span class="line">Veyra</span><br><span class="line">├─ .nvmrc</span><br><span class="line">├─ env.d.ts</span><br><span class="line">├─ libs</span><br><span class="line">│  ├─ README.md</span><br><span class="line">│  ├─ vite-plugins</span><br><span class="line">│  │  ├─ hooksPlugin.ts</span><br><span class="line">│  │  ├─ index.ts</span><br><span class="line">│  │  ├─ package.json</span><br><span class="line">│  │  └─ vite.config.ts</span><br><span class="line">│  └─ vitepress-preview-component</span><br><span class="line">│     ├─ container</span><br><span class="line">│     │  ├─ ant-design-ui</span><br><span class="line">│     │  │  ├─ ant-design.scss</span><br><span class="line">│     │  │  └─ AntDesign.vue</span><br><span class="line">│     │  ├─ element-plus</span><br><span class="line">│     │  │  ├─ element-plus.scss</span><br><span class="line">│     │  │  └─ ElementPlus.vue</span><br><span class="line">│     │  └─ naive-ui</span><br><span class="line">│     │     ├─ naive-ui.scss</span><br><span class="line">│     │     └─ NaiveUI.vue</span><br><span class="line">│     ├─ hooks</span><br><span class="line">│     │  ├─ use-codecopy.ts</span><br><span class="line">│     │  ├─ use-codefold.ts</span><br><span class="line">│     │  └─ use-namespaces.ts</span><br><span class="line">│     ├─ icons</span><br><span class="line">│     │  ├─ code-close.vue</span><br><span class="line">│     │  ├─ code-copy.vue</span><br><span class="line">│     │  ├─ code-open.vue</span><br><span class="line">│     │  └─ copy-success.vue</span><br><span class="line">│     ├─ index.ts</span><br><span class="line">│     ├─ messages</span><br><span class="line">│     │  ├─ index.ts</span><br><span class="line">│     │  ├─ message-notice.scss</span><br><span class="line">│     │  └─ message-notice.vue</span><br><span class="line">│     ├─ package.json</span><br><span class="line">│     ├─ styles</span><br><span class="line">│     │  └─ various.scss</span><br><span class="line">│     ├─ tsconfig.json</span><br><span class="line">│     ├─ types.d.ts</span><br><span class="line">│     └─ vite.config.ts</span><br><span class="line">├─ package.json</span><br><span class="line">├─ packages</span><br><span class="line">│  ├─ components</span><br><span class="line">│  │  ├─ Alert</span><br><span class="line">│  │  │  ├─ Alert.test.tsx</span><br><span class="line">│  │  │  ├─ Alert.vue</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Button</span><br><span class="line">│  │  │  ├─ Button.test.tsx</span><br><span class="line">│  │  │  ├─ Button.vue</span><br><span class="line">│  │  │  ├─ ButtonGroup.vue</span><br><span class="line">│  │  │  ├─ constants.ts</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Collapse</span><br><span class="line">│  │  │  ├─ Collapse.test.tsx</span><br><span class="line">│  │  │  ├─ Collapse.vue</span><br><span class="line">│  │  │  ├─ CollapseItem.vue</span><br><span class="line">│  │  │  ├─ constants.ts</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  ├─ transitionEvents.ts</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ ConfigProvider</span><br><span class="line">│  │  │  ├─ ConfigProvider.vue</span><br><span class="line">│  │  │  ├─ constants.ts</span><br><span class="line">│  │  │  ├─ hooks.ts</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Dropdown</span><br><span class="line">│  │  │  ├─ constants.ts</span><br><span class="line">│  │  │  ├─ Dropdown.test.tsx</span><br><span class="line">│  │  │  ├─ Dropdown.vue</span><br><span class="line">│  │  │  ├─ DropdownItem.vue</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Form</span><br><span class="line">│  │  │  ├─ constants.ts</span><br><span class="line">│  │  │  ├─ Form.vue</span><br><span class="line">│  │  │  ├─ FormItem.vue</span><br><span class="line">│  │  │  ├─ hooks.ts</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Icon</span><br><span class="line">│  │  │  ├─ Icon.vue</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ index.test.ts</span><br><span class="line">│  │  ├─ index.ts</span><br><span class="line">│  │  ├─ Input</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ Input.test.tsx</span><br><span class="line">│  │  │  ├─ Input.vue</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Loading</span><br><span class="line">│  │  │  ├─ directive.ts</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ Loading.test.tsx</span><br><span class="line">│  │  │  ├─ Loading.vue</span><br><span class="line">│  │  │  ├─ service.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Message</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ Message.test.tsx</span><br><span class="line">│  │  │  ├─ Message.vue</span><br><span class="line">│  │  │  ├─ methods.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ MessageBox</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ MessageBox.test.tsx</span><br><span class="line">│  │  │  ├─ MessageBox.vue</span><br><span class="line">│  │  │  ├─ methods.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Notification</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ methods.ts</span><br><span class="line">│  │  │  ├─ Notification.test.tsx</span><br><span class="line">│  │  │  ├─ Notification.vue</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Overlay</span><br><span class="line">│  │  │  ├─ Overlay.vue</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ package.json</span><br><span class="line">│  │  ├─ Popconfirm</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ Popconfirm.test.tsx</span><br><span class="line">│  │  │  ├─ Popconfirm.vue</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Select</span><br><span class="line">│  │  │  ├─ constants.ts</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ Option.vue</span><br><span class="line">│  │  │  ├─ Select.vue</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  ├─ types.ts</span><br><span class="line">│  │  │  └─ useKeyMap.ts</span><br><span class="line">│  │  ├─ Switch</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  ├─ Switch.test.tsx</span><br><span class="line">│  │  │  ├─ Switch.vue</span><br><span class="line">│  │  │  └─ types.ts</span><br><span class="line">│  │  ├─ Tooltip</span><br><span class="line">│  │  │  ├─ index.ts</span><br><span class="line">│  │  │  ├─ style.css</span><br><span class="line">│  │  │  ├─ Tooltip.test.tsx</span><br><span class="line">│  │  │  ├─ Tooltip.vue</span><br><span class="line">│  │  │  ├─ types.ts</span><br><span class="line">│  │  │  └─ useEventsToTiggerNode.ts</span><br><span class="line">│  │  └─ Upload</span><br><span class="line">│  │     ├─ index.ts</span><br><span class="line">│  │     ├─ types.ts</span><br><span class="line">│  │     ├─ Upload.vue</span><br><span class="line">│  │     └─ UploadList.vue</span><br><span class="line">│  ├─ constants</span><br><span class="line">│  │  ├─ index.ts</span><br><span class="line">│  │  ├─ key.ts</span><br><span class="line">│  │  └─ package.json</span><br><span class="line">│  ├─ core</span><br><span class="line">│  │  ├─ build</span><br><span class="line">│  │  │  ├─ vite.es.config.ts</span><br><span class="line">│  │  │  └─ vite.umd.config.ts</span><br><span class="line">│  │  ├─ componens.ts</span><br><span class="line">│  │  ├─ index.ts</span><br><span class="line">│  │  ├─ makeInstaller.ts</span><br><span class="line">│  │  ├─ package.json</span><br><span class="line">│  │  └─ pringLogo.ts</span><br><span class="line">│  ├─ docs</span><br><span class="line">│  │  ├─ .vitepress</span><br><span class="line">│  │  │  ├─ config.ts</span><br><span class="line">│  │  │  └─ theme</span><br><span class="line">│  │  │     └─ index.ts</span><br><span class="line">│  │  ├─ components</span><br><span class="line">│  │  │  ├─ alert.md</span><br><span class="line">│  │  │  ├─ button.md</span><br><span class="line">│  │  │  ├─ collapse.md</span><br><span class="line">│  │  │  ├─ dropdown.md</span><br><span class="line">│  │  │  ├─ form.md</span><br><span class="line">│  │  │  ├─ loading.md</span><br><span class="line">│  │  │  ├─ message.md</span><br><span class="line">│  │  │  ├─ messagebox.md</span><br><span class="line">│  │  │  ├─ notification.md</span><br><span class="line">│  │  │  ├─ popconfirm.md</span><br><span class="line">│  │  │  └─ tooltip.md</span><br><span class="line">│  │  ├─ demo</span><br><span class="line">│  │  │  ├─ alert</span><br><span class="line">│  │  │  │  ├─ Basic.vue</span><br><span class="line">│  │  │  │  ├─ Close.vue</span><br><span class="line">│  │  │  │  ├─ Desc.vue</span><br><span class="line">│  │  │  │  ├─ IconDesc.vue</span><br><span class="line">│  │  │  │  ├─ ShowIcon.vue</span><br><span class="line">│  │  │  │  ├─ TextCenter.vue</span><br><span class="line">│  │  │  │  └─ Theme.vue</span><br><span class="line">│  │  │  ├─ button</span><br><span class="line">│  │  │  │  ├─ Basic.vue</span><br><span class="line">│  │  │  │  ├─ Disabled.vue</span><br><span class="line">│  │  │  │  ├─ Group.vue</span><br><span class="line">│  │  │  │  ├─ Icon.vue</span><br><span class="line">│  │  │  │  ├─ Loading.vue</span><br><span class="line">│  │  │  │  ├─ Size.vue</span><br><span class="line">│  │  │  │  ├─ Tag.vue</span><br><span class="line">│  │  │  │  └─ Throttle.vue</span><br><span class="line">│  │  │  ├─ collapse</span><br><span class="line">│  │  │  │  ├─ Accordion.vue</span><br><span class="line">│  │  │  │  ├─ Basic.vue</span><br><span class="line">│  │  │  │  ├─ CustomTitle.vue</span><br><span class="line">│  │  │  │  └─ Disabled.vue</span><br><span class="line">│  │  │  ├─ dropdown</span><br><span class="line">│  │  │  │  ├─ Basic.vue</span><br><span class="line">│  │  │  │  ├─ Command.vue</span><br><span class="line">│  │  │  │  ├─ Disabled.vue</span><br><span class="line">│  │  │  │  ├─ HideOnClick.vue</span><br><span class="line">│  │  │  │  ├─ InstanceMethod.vue</span><br><span class="line">│  │  │  │  ├─ Size.vue</span><br><span class="line">│  │  │  │  ├─ SplitButton.vue</span><br><span class="line">│  │  │  │  └─ Trigger.vue</span><br><span class="line">│  │  │  ├─ form</span><br><span class="line">│  │  │  │  ├─ Basic.vue</span><br><span class="line">│  │  │  │  ├─ CustomValidate.vue</span><br><span class="line">│  │  │  │  ├─ Position.vue</span><br><span class="line">│  │  │  │  └─ Validate.vue</span><br><span class="line">│  │  │  ├─ loading</span><br><span class="line">│  │  │  │  ├─ Basic.vue</span><br><span class="line">│  │  │  │  ├─ Custom.vue</span><br><span class="line">│  │  │  │  └─ Fullscreen.vue</span><br><span class="line">│  │  │  ├─ message</span><br><span class="line">│  │  │  │  ├─ Basic.vue</span><br><span class="line">│  │  │  │  ├─ Center.vue</span><br><span class="line">│  │  │  │  ├─ Closeable.vue</span><br><span class="line">│  │  │  │  ├─ Test.vue</span><br><span class="line">│  │  │  │  └─ Type.vue</span><br><span class="line">│  │  │  ├─ messagebox</span><br><span class="line">│  │  │  │  ├─ Alert.vue</span><br><span class="line">│  │  │  │  ├─ Center.vue</span><br><span class="line">│  │  │  │  ├─ Confirm.vue</span><br><span class="line">│  │  │  │  ├─ Custom.vue</span><br><span class="line">│  │  │  │  ├─ Prompt.vue</span><br><span class="line">│  │  │  │  └─ VNode.vue</span><br><span class="line">│  │  │  ├─ notification</span><br><span class="line">│  │  │  │  ├─ Basic.vue</span><br><span class="line">│  │  │  │  ├─ Closeable.vue</span><br><span class="line">│  │  │  │  └─ Type.vue</span><br><span class="line">│  │  │  ├─ popconfirm</span><br><span class="line">│  │  │  │  ├─ Basic.vue</span><br><span class="line">│  │  │  │  ├─ Callback.vue</span><br><span class="line">│  │  │  │  └─ Custom.vue</span><br><span class="line">│  │  │  └─ tooltip</span><br><span class="line">│  │  │     ├─ Basic.vue</span><br><span class="line">│  │  │     ├─ Disabled.vue</span><br><span class="line">│  │  │     └─ Slot.vue</span><br><span class="line">│  │  ├─ get-started.md</span><br><span class="line">│  │  ├─ index.md</span><br><span class="line">│  │  └─ package.json</span><br><span class="line">│  ├─ hooks</span><br><span class="line">│  │  ├─ index.ts</span><br><span class="line">│  │  ├─ package.json</span><br><span class="line">│  │  ├─ useClickOutside.ts</span><br><span class="line">│  │  ├─ useDisabledStyle.ts</span><br><span class="line">│  │  ├─ useEventListener.ts</span><br><span class="line">│  │  ├─ useFocusController.ts</span><br><span class="line">│  │  ├─ useId.ts</span><br><span class="line">│  │  ├─ useLocale.ts</span><br><span class="line">│  │  ├─ useOffset.ts</span><br><span class="line">│  │  ├─ useProp.ts</span><br><span class="line">│  │  ├─ useZIndex.ts</span><br><span class="line">│  │  ├─ vite.config.ts</span><br><span class="line">│  │  └─ __test__</span><br><span class="line">│  │     ├─ index.test.tsx</span><br><span class="line">│  │     ├─ useClickOutset.test.tsx</span><br><span class="line">│  │     └─ useEventListener.test.tsx</span><br><span class="line">│  ├─ locale</span><br><span class="line">│  │  ├─ index.ts</span><br><span class="line">│  │  ├─ lang</span><br><span class="line">│  │  │  ├─ en.ts</span><br><span class="line">│  │  │  ├─ ja.ts</span><br><span class="line">│  │  │  ├─ ko.ts</span><br><span class="line">│  │  │  ├─ zh-cn.ts</span><br><span class="line">│  │  │  └─ zh-tw.ts</span><br><span class="line">│  │  └─ package.json</span><br><span class="line">│  ├─ play</span><br><span class="line">│  │  ├─ .storybook</span><br><span class="line">│  │  │  ├─ main.js</span><br><span class="line">│  │  │  └─ preview.js</span><br><span class="line">│  │  ├─ index.html</span><br><span class="line">│  │  ├─ package.json</span><br><span class="line">│  │  ├─ public</span><br><span class="line">│  │  │  └─ vite.svg</span><br><span class="line">│  │  ├─ README.md</span><br><span class="line">│  │  ├─ src</span><br><span class="line">│  │  │  ├─ App.vue</span><br><span class="line">│  │  │  ├─ main.ts</span><br><span class="line">│  │  │  ├─ stories</span><br><span class="line">│  │  │  │  ├─ Alert.stories.tsx</span><br><span class="line">│  │  │  │  ├─ Button.stories.ts</span><br><span class="line">│  │  │  │  └─ Collapse.stories.ts</span><br><span class="line">│  │  │  └─ vite-env.d.ts</span><br><span class="line">│  │  └─ vite.config.ts</span><br><span class="line">│  ├─ README.md</span><br><span class="line">│  ├─ theme</span><br><span class="line">│  │  ├─ index.css</span><br><span class="line">│  │  ├─ package.json</span><br><span class="line">│  │  └─ reset.css</span><br><span class="line">│  └─ utils</span><br><span class="line">│     ├─ error.ts</span><br><span class="line">│     ├─ index.ts</span><br><span class="line">│     ├─ install.ts</span><br><span class="line">│     ├─ package.json</span><br><span class="line">│     ├─ style.ts</span><br><span class="line">│     └─ __tests__</span><br><span class="line">│        ├─ error.test.tsx</span><br><span class="line">│        ├─ index.test.tsx</span><br><span class="line">│        └─ install.test.tsx</span><br><span class="line">├─ pnpm-lock.yaml</span><br><span class="line">├─ pnpm-workspace.yaml</span><br><span class="line">├─ postcss.config.cjs</span><br><span class="line">├─ tsconfig.build.json</span><br><span class="line">├─ tsconfig.json</span><br><span class="line">├─ tsconfig.node.json</span><br><span class="line">├─ vitest.config.ts</span><br><span class="line">└─ vitest.setup.ts</span><br></pre></td></tr></table></figure>

<h1 id="项目解构"><a href="#项目解构" class="headerlink" title="项目解构"></a>项目解构</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctrl+i</span><br><span class="line">alt+shift+5</span><br></pre></td></tr></table></figure>

<h1 id="├─-nvmrc"><a href="#├─-nvmrc" class="headerlink" title="├─ .nvmrc"></a>├─ .<em><del>nvmrc</del></em></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v18.17.0</span><br></pre></td></tr></table></figure>

<p>控制nodejs版本的</p>
<h1 id="├─-env-d-ts"><a href="#├─-env-d-ts" class="headerlink" title="├─ env.d.ts"></a>├─ <em><del>env.d.ts</del></em></h1><blockquote>
<p>用来区分不同的运行环境：生产（production）、开发（development）和测试（test）</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> <span class="attr">PROD</span>: <span class="built_in">boolean</span>; <span class="comment">//生产</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> <span class="attr">DEV</span>: <span class="built_in">boolean</span>; <span class="comment">//开发</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> <span class="attr">TEST</span>: <span class="built_in">boolean</span>; <span class="comment">//测试</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>在项目的构建脚本或配置文件中，会依据这些变量来决定是否启用某些调试工具、日志记录或者优化措施。</p>
</blockquote>
<ol>
<li><strong>生产环境 (Production)</strong>:<ul>
<li><strong>情景</strong>: 当你构建并部署你的应用到生产服务器上时（例如通过 CI&#x2F;CD 流程自动部署到 GitHub Pages 或者其他任何生产环境）。假设你在 Vite 配置文件中为生产环境设置了 <code>PROD=true</code>。</li>
<li><strong>操作</strong>: 执行构建命令如 <code>npm run build</code> 后，再将生成的静态资源部署到生产环境。</li>
<li><strong>结果</strong>: 在启动或加载应用程序的过程中，如果该函数被执行，那么将会看到那个带有渐变色效果的ASCII艺术logo出现在服务器日志或者浏览器控制台中。</li>
</ul>
</li>
<li><strong>开发模式 (Development)</strong>:<ul>
<li><strong>情景</strong>: 当你在本地开发环境中运行你的Vue 3 + TypeScript项目时，比如使用 <code>npm run serve</code> 或者类似的命令启动一个热重载的开发服务器。</li>
<li><strong>操作</strong>: 直接在终端执行 <code>npm run serve</code> 或者配置好的开发模式启动脚本。</li>
<li><strong>结果</strong>: 在控制台中你会看到简单的提示消息 <code>[EricUI]:dev mode...</code>，这表明现在正处于开发模式下，并且可以快速识别出当前的工作状态。</li>
</ul>
</li>
<li><strong>测试环境 (Testing)</strong>:<ul>
<li><strong>情景</strong>: 运行单元测试或集成测试时（例如使用 Vitest），通常不会设置 <code>PROD</code> 或 <code>DEV</code> 变量为 true。因此，在这种情况下，既不满足生产环境也不满足开发模式的条件。</li>
<li><strong>操作</strong>: 执行测试命令如 <code>npm test</code> 或 <code>vitest</code>。</li>
<li><strong>结果</strong>: 控制台上不会显示上述的ASCII艺术logo或开发模式的消息，以避免干扰测试输出。</li>
</ul>
</li>
</ol>
<h1 id="├─-libs"><a href="#├─-libs" class="headerlink" title="├─ libs"></a>├─ <em><del>libs</del></em></h1><blockquote>
<p>辅助库&amp;工具</p>
</blockquote>
<h2 id="├─-vite-plugins"><a href="#├─-vite-plugins" class="headerlink" title="├─ vite-plugins"></a>├─ vite-plugins</h2><blockquote>
<p>自定义vite插件</p>
</blockquote>
<h3 id="├─-hooksPlugin-ts"><a href="#├─-hooksPlugin-ts" class="headerlink" title="├─ hooksPlugin.ts"></a>├─ hooksPlugin.ts</h3><h3 id="├─-index-ts"><a href="#├─-index-ts" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h3><h3 id="├─-package-json"><a href="#├─-package-json" class="headerlink" title="├─ package.json"></a>├─ package.json</h3><h3 id="└─-vite-config-ts"><a href="#└─-vite-config-ts" class="headerlink" title="└─ vite.config.ts"></a>└─ vite.config.ts</h3><h2 id="└─-vitepress-preview-component"><a href="#└─-vitepress-preview-component" class="headerlink" title="└─ vitepress-preview-component"></a>└─ vitepress-preview-component</h2><blockquote>
<p>vitepress组件预览插件</p>
</blockquote>
<h3 id="├─-container"><a href="#├─-container" class="headerlink" title="├─ container"></a>├─ container</h3><p>│     │  ├─ ant-design-ui<br>│     │  │  ├─ ant-design.scss<br>│     │  │  └─ AntDesign.vue<br>│     │  ├─ element-plus<br>│     │  │  ├─ element-plus.scss<br>│     │  │  └─ ElementPlus.vue<br>│     │  └─ naive-ui<br>│     │     ├─ naive-ui.scss<br>│     │     └─ NaiveUI.vue</p>
<p>│     ├─ hooks<br>│     │  ├─ use-codecopy.ts<br>│     │  ├─ use-codefold.ts<br>│     │  └─ use-namespaces.ts</p>
<p>│     ├─ icons<br>│     │  ├─ code-close.vue<br>│     │  ├─ code-copy.vue<br>│     │  ├─ code-open.vue<br>│     │  └─ copy-success.vue</p>
<p>│     ├─ index.ts</p>
<p>│     ├─ messages<br>│     │  ├─ index.ts<br>│     │  ├─ message-notice.scss<br>│     │  └─ message-notice.vue</p>
<p>│     ├─ package.json<br>│     ├─ styles<br>│     │  └─ various.scss</p>
<p>│     ├─ tsconfig.json</p>
<p>│     ├─ types.d.ts</p>
<p>│     └─ vite.config.ts</p>
<h1 id="├─-packages"><a href="#├─-packages" class="headerlink" title="├─ packages"></a>├─ <em><del>packages</del></em></h1><blockquote>
<p>项目分包</p>
</blockquote>
<h2 id="├─-components"><a href="#├─-components" class="headerlink" title="├─ components"></a>├─ <em><del>components</del></em></h2><blockquote>
<p>所有的组件逻辑</p>
</blockquote>
<h3 id="├─-Alert"><a href="#├─-Alert" class="headerlink" title="├─ Alert"></a>├─ Alert</h3><blockquote>
<p>提示</p>
</blockquote>
<h4 id="–API–"><a href="#–API–" class="headerlink" title="–API–"></a>–API–</h4><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Default</th>
</tr>
</thead>
<tbody><tr>
<td>title</td>
<td>Alert 标题</td>
<td><code>string</code></td>
<td>—</td>
</tr>
<tr>
<td>type</td>
<td>Alert 类型</td>
<td><code>enum</code> - <code>&#39;success&#39;| &#39;warning&#39;| &#39;danger&#39;| &#39;info&#39;</code></td>
<td>info</td>
</tr>
<tr>
<td>description</td>
<td>描述性文本</td>
<td><code>string</code></td>
<td>—</td>
</tr>
<tr>
<td>closable</td>
<td>是否可以关闭</td>
<td><code>boolean</code></td>
<td>true</td>
</tr>
<tr>
<td>center</td>
<td>文字是否居中</td>
<td><code>boolean</code></td>
<td>false</td>
</tr>
<tr>
<td>show-icon</td>
<td>是否展示图标</td>
<td><code>boolean</code></td>
<td>false</td>
</tr>
<tr>
<td>effect</td>
<td>主题样式</td>
<td><code>enum</code> - <code>&#39;light&#39;| &#39;dark&#39;\</code></td>
<td>light</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody><tr>
<td>close</td>
<td>关闭 Alert 时触发的事件</td>
<td><code>(event: MouseEvent)=&gt; void</code></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>default</td>
<td>默认插槽，用于设置 Alert 的内容描述</td>
</tr>
<tr>
<td>title</td>
<td>标题的内容</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody><tr>
<td>open</td>
<td>打开 Alert</td>
<td><code>() =&gt; void</code></td>
</tr>
<tr>
<td>close</td>
<td>关闭 Alert</td>
<td><code>() =&gt; void</code></td>
</tr>
</tbody></table>
<h4 id="├─-Alert-test-tsx"><a href="#├─-Alert-test-tsx" class="headerlink" title="├─ Alert.test.tsx"></a>├─ Alert.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, it, expect, vi &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">AlertType</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&quot;@vue/test-utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Alert</span> <span class="keyword">from</span> <span class="string">&quot;./Alert.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Icon</span> <span class="keyword">from</span> <span class="string">&quot;../Icon/Icon.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Alert.vue&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> title = <span class="string">&quot;Test Alert&quot;</span>;</span><br><span class="line">  <span class="keyword">const</span> desc = <span class="string">&quot;This is a test description&quot;</span>;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should render the alert with default props&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Alert</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        title,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: desc,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">global</span>: &#123;</span><br><span class="line">        <span class="attr">stubs</span>: [<span class="string">&quot;ErIcon&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(title);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(desc);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// close icon</span></span><br><span class="line">    <span class="keyword">const</span> iconElement = wrapper.<span class="title function_">findComponent</span>(<span class="title class_">Icon</span>);</span><br><span class="line">    <span class="title function_">expect</span>(iconElement.<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(iconElement.<span class="title function_">attributes</span>(<span class="string">&quot;icon&quot;</span>)).<span class="title function_">toBe</span>(<span class="string">&quot;xmark&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> wrapper2 = <span class="title function_">mount</span>(<span class="function">() =&gt;</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">Alert</span> <span class="attr">title</span>=<span class="string">&#123;title&#125;</span> <span class="attr">description</span>=<span class="string">&#123;desc&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Alert</span>&gt;</span></span></span><br><span class="line">    ));</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper2.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(title);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper2.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(desc);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  it.<span class="title function_">each</span>([</span><br><span class="line">    [<span class="string">&quot;info&quot;</span>, <span class="string">&quot;circle-info&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;success&quot;</span>, <span class="string">&quot;check-circle&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;warning&quot;</span>, <span class="string">&quot;circle-exclamation&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;danger&quot;</span>, <span class="string">&quot;circle-xmark&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;error&quot;</span>, <span class="string">&quot;circle-xmark&quot;</span>],</span><br><span class="line">    [<span class="string">&quot;non-compliance&quot;</span>, <span class="string">&quot;circle-info&quot;</span>], <span class="comment">// 不符合 type 定义的</span></span><br><span class="line">  ])(<span class="string">&quot;should has the correct icon when props type is %s&quot;</span>, <span class="function">(<span class="params"><span class="keyword">type</span>, iconName</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Alert</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        title,</span><br><span class="line">        <span class="attr">closable</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">showIcon</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="keyword">type</span> <span class="keyword">as</span> <span class="title class_">AlertType</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: desc,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">global</span>: &#123;</span><br><span class="line">        <span class="attr">stubs</span>: [<span class="string">&quot;ErIcon&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> iconElement = wrapper.<span class="title function_">findComponent</span>(<span class="title class_">Icon</span>);</span><br><span class="line">    <span class="title function_">expect</span>(iconElement.<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(iconElement.<span class="title function_">attributes</span>(<span class="string">&quot;icon&quot;</span>)).<span class="title function_">toBe</span>(iconName);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should emit close event when close icon is clicked&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> onClose = vi.<span class="title function_">fn</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Alert</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        title,</span><br><span class="line">        <span class="attr">closable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">showIcon</span>: <span class="literal">false</span>,</span><br><span class="line">        onClose,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: desc,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">global</span>: &#123;</span><br><span class="line">        <span class="attr">stubs</span>: [<span class="string">&quot;ErIcon&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    wrapper.<span class="title function_">findComponent</span>(<span class="title class_">Icon</span>).<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(onClose).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should allow custom content via slots&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Alert</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;test title&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: desc,</span><br><span class="line">        title,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(desc);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(title);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="property">not</span>.<span class="title function_">toContain</span>(<span class="string">&quot;test title&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should support centering text&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Alert</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        title,</span><br><span class="line">        <span class="attr">description</span>: desc,</span><br><span class="line">        <span class="attr">center</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//class</span></span><br><span class="line">    <span class="keyword">const</span> rootNode = wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-alert&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(rootNode.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;text-center&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should not render close icon when closable is false&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Alert</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123; <span class="attr">closable</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-alert__close&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBe</span>(<span class="literal">false</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should toggle visibility when open and close methods are called&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Alert</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123; title, <span class="attr">closable</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="property">vm</span>.<span class="title function_">close</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-alert&quot;</span>).<span class="title function_">attributes</span>().<span class="property">style</span>).<span class="title function_">toBe</span>(<span class="string">&quot;display: none;&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="property">vm</span>.<span class="title function_">open</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-alert&quot;</span>).<span class="title function_">attributes</span>().<span class="property">style</span>).<span class="title function_">toBe</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h4 id="├─-Alert-vue"><a href="#├─-Alert-vue" class="headerlink" title="├─ Alert.vue"></a>├─ Alert.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; AlertProps, AlertEmits, AlertInstance &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; ref, useSlots, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; typeIconMap &#125; from &quot;@eric-ui/utils&quot;;</span><br><span class="line">import ErIcon from &quot;../Icon/Icon.vue&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErAlert&quot;,</span><br><span class="line">&#125;);</span><br><span class="line">const props = withDefaults(defineProps&lt;AlertProps&gt;(), &#123;</span><br><span class="line">  effect: &quot;light&quot;,</span><br><span class="line">  type: &quot;info&quot;,</span><br><span class="line">  closable: true,</span><br><span class="line">&#125;);</span><br><span class="line">const emits = defineEmits&lt;AlertEmits&gt;();</span><br><span class="line">const slots = useSlots();</span><br><span class="line"></span><br><span class="line">const visible = ref(true);</span><br><span class="line"></span><br><span class="line">const iconName = computed(() =&gt; typeIconMap.get(props.type) ?? &quot;circle-info&quot;);</span><br><span class="line">const withDescription = computed(() =&gt; props.description || slots.default);</span><br><span class="line"></span><br><span class="line">function close() &#123;</span><br><span class="line">  visible.value = false;</span><br><span class="line">  emits(&quot;close&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function open() &#123;</span><br><span class="line">  visible.value = true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">defineExpose&lt;AlertInstance&gt;(&#123;</span><br><span class="line">  open,</span><br><span class="line">  close,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;transition name=&quot;er-alert-fade&quot;&gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      v-show=&quot;visible&quot;</span><br><span class="line">      class=&quot;er-alert&quot;</span><br><span class="line">      role=&quot;alert&quot;</span><br><span class="line">      :class=&quot;&#123;</span><br><span class="line">        [`er-alert__$&#123;type&#125;`]: type,</span><br><span class="line">        [`er-alert__$&#123;effect&#125;`]: effect,</span><br><span class="line">        &#x27;text-center&#x27;: center,</span><br><span class="line">      &#125;&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;er-icon</span><br><span class="line">        v-if=&quot;showIcon&quot;</span><br><span class="line">        class=&quot;er-alert__icon&quot;</span><br><span class="line">        :class=&quot;&#123; &#x27;big-icon&#x27;: withDescription &#125;&quot;</span><br><span class="line">        :icon=&quot;iconName&quot;</span><br><span class="line">      /&gt;</span><br><span class="line">      &lt;div class=&quot;er-alert__content&quot;&gt;</span><br><span class="line">        &lt;span</span><br><span class="line">          class=&quot;er-alert__title&quot;</span><br><span class="line">          :class=&quot;&#123; &#x27;with-desc&#x27;: withDescription &#125;&quot;</span><br><span class="line">          :style=&quot;&#123; display: center &amp;&amp; !showIcon ? &#x27;flow&#x27; : &#x27;inline&#x27; &#125;&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;slot name=&quot;title&quot;&gt;&#123;&#123; title &#125;&#125;&lt;/slot&gt;</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">        &lt;p class=&quot;er-alert__description&quot;&gt;</span><br><span class="line">          &lt;slot&gt;&#123;&#123; description &#125;&#125;&lt;/slot&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;div class=&quot;er-alert__close&quot; v-if=&quot;closable&quot;&gt;</span><br><span class="line">          &lt;er-icon @click.stop=&quot;close&quot; icon=&quot;xmark&quot; /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/transition&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>





<h4 id="├─-index-ts-1"><a href="#├─-index-ts-1" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Alert</span> <span class="keyword">from</span> <span class="string">&quot;./Alert.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErAlert</span> = <span class="title function_">withInstall</span>(<span class="title class_">Alert</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>





<h4 id="├─-style-css"><a href="#├─-style-css" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-alert</span> &#123;</span><br><span class="line">  <span class="attr">--er-alert-padding</span>: <span class="number">8px</span> <span class="number">16px</span>;</span><br><span class="line">  <span class="attr">--er-alert-border-radius-base</span>: <span class="built_in">var</span>(--er-border-radius-base);</span><br><span class="line">  <span class="attr">--er-alert-bg-color</span>: <span class="built_in">var</span>(--er-color-white);</span><br><span class="line">  <span class="attr">--er-alert-title-font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attr">--er-alert-title-font-size-with-desc</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attr">--er-alert-desc-font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attr">--er-alert-text-color</span>: <span class="built_in">var</span>(--er-text-color-primary);</span><br><span class="line">  <span class="attr">--er-alert-top-margin</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attr">--er-alert-icon-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attr">--er-alert-icon-margin</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attr">--er-alert-big-icon-size</span>: <span class="number">28px</span>;</span><br><span class="line">  <span class="attr">--er-alert-big-icon-margin</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-alert</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="built_in">var</span>(--er-alert-padding);</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--er-alert-border-radius-base);</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-alert-bg-color);</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="built_in">var</span>(--er-alert-top-margin);</span><br><span class="line">  <span class="selector-class">.er-alert__icon</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-alert-text-color);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-alert-icon-size);</span><br><span class="line">    <span class="attribute">width</span>: <span class="built_in">var</span>(--er-alert-icon-size);</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="built_in">var</span>(--er-alert-icon-margin);</span><br><span class="line">    &amp;<span class="selector-class">.big-icon</span>&#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-alert-big-icon-size);</span><br><span class="line">      <span class="attribute">width</span>: <span class="built_in">var</span>(--er-alert-big-icon-size);</span><br><span class="line">      <span class="attribute">margin-right</span>: <span class="built_in">var</span>(--er-alert-big-icon-margin);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-alert__content</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>:  <span class="built_in">var</span>(--er-alert-text-color);</span><br><span class="line">    <span class="attribute">vertical-align</span>: text-top;</span><br><span class="line">    <span class="selector-class">.er-alert__title</span>&#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-alert-title-font-size);</span><br><span class="line">      <span class="attribute">line-height</span>: <span class="number">24px</span>;</span><br><span class="line">      &amp;<span class="selector-class">.with-desc</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-alert-title-font-size-with-desc);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="selector-class">.er-alert__description</span>&#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-alert-desc-font-size);</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.er-alert__close</span> &#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-alert-close-font-size);</span><br><span class="line">      <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">      <span class="attribute">position</span>: absolute;</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">right</span>: <span class="number">15px</span>;</span><br><span class="line">      <span class="attribute">cursor</span>: pointer;</span><br><span class="line">      :<span class="built_in">deep</span>(.er-icon) &#123;</span><br><span class="line">        <span class="attribute">vertical-align</span>: top;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.er-alert__light</span> &#123;</span><br><span class="line">      <span class="selector-class">.er-alert__close</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--er-text-color-placeholder);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.er-alert__dark</span> &#123;</span><br><span class="line">      <span class="selector-class">.er-alert__close</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--er-color-white);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.text-center</span> &#123;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="selector-tag">span</span>,<span class="selector-tag">p</span> &#123;</span><br><span class="line">      <span class="attribute">text-align</span>: center;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-alert-fade-enter-from</span>,</span><br><span class="line"><span class="selector-class">.er-alert-fade-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@each</span> $val in success,warning,info,danger &#123; </span><br><span class="line">  <span class="selector-class">.er-alert__</span>$(val)<span class="selector-class">.er-alert__light</span> &#123;</span><br><span class="line">    <span class="attr">--er-alert-text-color</span>: <span class="built_in">var</span>(--er-color-$(val));</span><br><span class="line">    <span class="attr">--er-alert-bg-color</span>: <span class="built_in">var</span>(--er-color-$(val)-light-<span class="number">9</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-alert__</span>$(val)<span class="selector-class">.er-alert__dark</span> &#123;</span><br><span class="line">    <span class="attr">--er-alert-text-color</span>: <span class="built_in">var</span>(--er-color-white);</span><br><span class="line">    <span class="attr">--er-alert-bg-color</span>: <span class="built_in">var</span>(--er-color-$(val));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="└─-types-ts"><a href="#└─-types-ts" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">AlertType</span> = <span class="string">&quot;success&quot;</span> | <span class="string">&quot;info&quot;</span> | <span class="string">&quot;warning&quot;</span> | <span class="string">&quot;danger&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">AlertProps</span> &#123;</span><br><span class="line">  <span class="attr">title</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">type</span>?: <span class="title class_">AlertType</span>;</span><br><span class="line">  <span class="attr">description</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">effect</span>?: <span class="string">&quot;light&quot;</span> | <span class="string">&quot;dark&quot;</span>;</span><br><span class="line">  <span class="attr">closable</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">center</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">showIcon</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">AlertEmits</span> &#123;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;close&quot;</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">AlertInstance</span> &#123;</span><br><span class="line">  <span class="title function_">open</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">close</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="├─-Button"><a href="#├─-Button" class="headerlink" title="├─ Button"></a>├─ Button</h3><h4 id="–API–-1"><a href="#–API–-1" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-Button-test-tsx"><a href="#├─-Button-test-tsx" class="headerlink" title="├─ Button.test.tsx"></a>├─ Button.test.tsx</h4><blockquote>
<p>单组件测试</p>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, it, expect &#125; <span class="keyword">from</span> <span class="string">&#x27;vitest&#x27;</span> <span class="comment">//vitest 是测试框架，提供 describe（定义测试套件）、it（定义单个测试用例）、expect（断言工具）</span></span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&#x27;@vue/test-utils&#x27;</span> <span class="comment">//Vue 的测试工具库，mount 函数用于挂载 Vue 组件以便测试</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Button</span> <span class="keyword">from</span> <span class="string">&#x27;./Button.vue&#x27;</span> <span class="comment">//引入需要测试的 Button.vue 组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ButtonProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span> <span class="comment">//引入组件的 props 类型定义，确保 props 的类型正确</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Button.vue&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">	<span class="comment">// type 属性的类名测试</span></span><br><span class="line">	<span class="title function_">it</span>(<span class="string">&#x27;type 属性被设置时，组件添加了对应的类名（如 er-button--primary）&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">const</span> types = [<span class="string">&#x27;primary&#x27;</span>, <span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;warning&#x27;</span>, <span class="string">&#x27;danger&#x27;</span>, <span class="string">&#x27;info&#x27;</span>] <span class="comment">//包含所有可能的 type 值</span></span><br><span class="line">		types.<span class="title function_">forEach</span>(<span class="function">(<span class="params"><span class="keyword">type</span></span>) =&gt;</span> &#123;</span><br><span class="line">			<span class="comment">//遍历每个type类型</span></span><br><span class="line">			<span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Button</span>, &#123;</span><br><span class="line">				<span class="comment">//通过 mount 挂载 Button 组件，并传递当前 type 值作为 props</span></span><br><span class="line">				<span class="attr">props</span>: &#123; <span class="attr">type</span>: <span class="keyword">type</span> <span class="keyword">as</span> <span class="title class_">ButtonProps</span>[<span class="string">&#x27;type&#x27;</span>] &#125;,</span><br><span class="line">			&#125;)</span><br><span class="line">			<span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">`er-button--<span class="subst">$&#123;<span class="keyword">type</span>&#125;</span>`</span>) <span class="comment">//断言类名是否包含 er-button--$&#123;type&#125;</span></span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// size 属性的类名测试</span></span><br><span class="line">	<span class="title function_">it</span>(<span class="string">&#x27;size 属性被设置时，组件添加了对应的类名（如 er-button--large）&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">const</span> sizes = [<span class="string">&#x27;large&#x27;</span>, <span class="string">&#x27;default&#x27;</span>, <span class="string">&#x27;small&#x27;</span>]</span><br><span class="line">		sizes.<span class="title function_">forEach</span>(<span class="function">(<span class="params">size</span>) =&gt;</span> &#123;</span><br><span class="line">			<span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Button</span>, &#123;</span><br><span class="line">				<span class="attr">props</span>: &#123; <span class="attr">size</span>: size <span class="keyword">as</span> <span class="title class_">ButtonProps</span>[<span class="string">&#x27;size&#x27;</span>] &#125;,</span><br><span class="line">			&#125;)</span><br><span class="line">			<span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">`er-button--<span class="subst">$&#123;size&#125;</span>`</span>)</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// plain、round 等布尔属性的类名测试</span></span><br><span class="line">	it.<span class="title function_">each</span>([</span><br><span class="line">		<span class="comment">//一个参数化测试，通过数组中的每一项（[prop, className]）生成多个测试用例</span></span><br><span class="line">		[<span class="string">&#x27;plain&#x27;</span>, <span class="string">&#x27;is-plain&#x27;</span>],</span><br><span class="line">		[<span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;is-round&#x27;</span>],</span><br><span class="line">		[<span class="string">&#x27;circle&#x27;</span>, <span class="string">&#x27;is-circle&#x27;</span>],</span><br><span class="line">		[<span class="string">&#x27;disabled&#x27;</span>, <span class="string">&#x27;is-disabled&#x27;</span>],</span><br><span class="line">		[<span class="string">&#x27;loading&#x27;</span>, <span class="string">&#x27;is-loading&#x27;</span>],</span><br><span class="line">	])(</span><br><span class="line">		<span class="string">&#x27;当 prop（如 plain）被设置为 true 时，组件添加了对应的类名（如 is-plain）&#x27;</span>,</span><br><span class="line">		<span class="function">(<span class="params">prop, className</span>) =&gt;</span> &#123;</span><br><span class="line">			<span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Button</span>, &#123;</span><br><span class="line">				<span class="comment">//挂载组件</span></span><br><span class="line">				<span class="attr">props</span>: &#123; [prop]: <span class="literal">true</span> &#125;, <span class="comment">//设置 props[prop] = true</span></span><br><span class="line">			&#125;)</span><br><span class="line">			<span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(className) <span class="comment">//断言类名是否包含 className</span></span><br><span class="line">		&#125;</span><br><span class="line">	)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// nativeType 属性的 type 属性测试</span></span><br><span class="line">	<span class="title function_">it</span>(<span class="string">&#x27;当 tag 是 button 时，组件的 type 属性等于 nativeType（如 submit）&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Button</span>, &#123;</span><br><span class="line">			<span class="attr">props</span>: &#123; <span class="attr">tag</span>: <span class="string">&#x27;button&#x27;</span>, <span class="attr">nativeType</span>: <span class="string">&#x27;submit&#x27;</span> &#125;, <span class="comment">//设置 tag 为 button，nativeType 为 submit</span></span><br><span class="line">		&#125;)</span><br><span class="line">		<span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">tagName</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;BUTTON&#x27;</span>) <span class="comment">//标签名是否为 BUTTON</span></span><br><span class="line">		<span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">type</span>).<span class="title function_">toBe</span>(<span class="string">&#x27;submit&#x27;</span>) <span class="comment">//type 属性是否为 submit</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// tag 属性的标签名测试</span></span><br><span class="line">	<span class="title function_">it</span>(<span class="string">&#x27;当 tag 被设置为 a 时，组件的根元素为 &lt;a&gt; 标签&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Button</span>, &#123;</span><br><span class="line">			<span class="attr">props</span>: &#123; <span class="attr">tag</span>: <span class="string">&#x27;a&#x27;</span> &#125;, <span class="comment">//挂载组件并设置 tag 为 a</span></span><br><span class="line">		&#125;)</span><br><span class="line">		<span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">tagName</span>.<span class="title function_">toLowerCase</span>()).<span class="title function_">toBe</span>(<span class="string">&#x27;a&#x27;</span>) <span class="comment">//断言标签名是否为 a（小写）</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// click 事件测试</span></span><br><span class="line">	<span class="title function_">it</span>(<span class="string">&#x27;点击按钮时触发 click 事件&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">		<span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Button</span>)</span><br><span class="line">		<span class="keyword">await</span> wrapper.<span class="title function_">trigger</span>(<span class="string">&#x27;click&#x27;</span>) <span class="comment">//使用 trigger(&#x27;click&#x27;) 模拟点击事件（需 await 确保异步完成）</span></span><br><span class="line">		<span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>().<span class="property">click</span>).<span class="title function_">toHaveLength</span>(<span class="number">1</span>) <span class="comment">//断言 emitted().click 是否有 1 次触发</span></span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h4 id="├─-Button-vue"><a href="#├─-Button-vue" class="headerlink" title="├─ Button.vue"></a>├─ Button.vue</h4><blockquote>
<p>组件实现</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, computed, inject &#125; from &quot;vue&quot;;//响应式,计算,上下文依赖项注入</span><br><span class="line">import type &#123; ButtonProps, ButtonEmits, ButtonInstance &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; BUTTON_GROUP_CTX_KEY &#125; from &quot;./constants&quot;;//标识按钮组上下文</span><br><span class="line">import &#123; throttle &#125; from &quot;lodash-es&quot;;//节流事件处理</span><br><span class="line">import TyIcon from &quot;../Icon/Icon.vue&quot;;//自定义的图标组件TyIcon</span><br><span class="line">defineOptions(&#123;//定义组件的名称为 ErButton</span><br><span class="line">  name: &quot;ErButton&quot;,</span><br><span class="line">&#125;);</span><br><span class="line">const props = withDefaults(defineProps&lt;ButtonProps&gt;(), &#123;//定义组件的props+设置默认值</span><br><span class="line">  tag: &quot;button&quot;,//HTML 标签名</span><br><span class="line">  nativeType: &quot;button&quot;,//原生按钮类型</span><br><span class="line">  useThrottle: true,//启用节流</span><br><span class="line">  throttleDuration: 500,//节流持续时间</span><br><span class="line">&#125;);</span><br><span class="line">const emits = defineEmits&lt;ButtonEmits&gt;();//事件发射器</span><br><span class="line">const slots = defineSlots();//插槽，用于动态渲染内容</span><br><span class="line">const buttonGroupCtx = inject(BUTTON_GROUP_CTX_KEY, void 0);//注入按钮组上下文（如果存在），用于继承按钮组的配置（如 size、type 等）</span><br><span class="line"></span><br><span class="line">const _ref = ref&lt;HTMLButtonElement&gt;();</span><br><span class="line">//计算属性 size，优先使用按钮组上下文中的 size，其次使用 props.size，最后为空字符串</span><br><span class="line">const size = computed(() =&gt; buttonGroupCtx?.size ?? props.size ?? &quot;&quot;);</span><br><span class="line">//计算属性 type，优先使用按钮组上下文中的 type，其次使用 props.type，最后为空字符串</span><br><span class="line">const type = computed(() =&gt; buttonGroupCtx?.type ?? props.type ?? &quot;&quot;);</span><br><span class="line">//定义计算属性 disabled，优先使用 props.disabled，其次使用按钮组上下文中的 disabled，最后为 false</span><br><span class="line">const disabled = computed(() =&gt; props.disabled || buttonGroupCtx?.disabled || false);</span><br><span class="line">//计算属性 iconStyle，当按钮有默认插槽内容时，图标右侧添加 6px 的间距，否则不添加间距</span><br><span class="line">const iconStyle = computed(() =&gt; (&#123;marginRight: slots.default ? &quot;6px&quot; : &quot;0px&quot;,&#125;));</span><br><span class="line"></span><br><span class="line">//触发 click 事件并将事件对象传递给父组件</span><br><span class="line">const handleBtnClick = (e: MouseEvent) =&gt; &#123;</span><br><span class="line">  emits(&quot;click&quot;, e);</span><br><span class="line">&#125;;</span><br><span class="line">//使用 throttle 对 handleBtnClick 进行节流，限制点击事件的触发频率</span><br><span class="line">const handlBtneCLickThrottle = throttle(handleBtnClick, props.throttleDuration);</span><br><span class="line"></span><br><span class="line">//暴露组件的内部状态和方法，供父组件通过 ref 访问</span><br><span class="line">defineExpose&lt;ButtonInstance&gt;(&#123;</span><br><span class="line">  ref: _ref,</span><br><span class="line">  disabled,</span><br><span class="line">  size,</span><br><span class="line">  type,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;component</span><br><span class="line">    :is=&quot;tag&quot;//动态决定组件的根标签类型（button/a）</span><br><span class="line">    ref=&quot;_ref&quot;//为组件实例绑定一个引用`ref`（可通过 `this.$refs._ref` 获取到该按钮的 DOM 元素）</span><br><span class="line">    class=&quot;er-button&quot;</span><br><span class="line">    :class=&quot;&#123;//使用对象语法动态绑定类名</span><br><span class="line">      [`er-button--$&#123;type&#125;`]: type, //当 `type` 存在时（如 `primary`、`success`），添加类名 `er-button--primary`</span><br><span class="line">      [`er-button--$&#123;size&#125;`]: size, //当 `size` 存在时（如 `large`、`small`），添加类名 `er-button--large`</span><br><span class="line">      &#x27;is-plain&#x27;: plain, //当 plain 为 true 时，添加类名 `is-plain`</span><br><span class="line">      &#x27;is-round&#x27;: round, //当 round 为 true 时，添加类名 `is-round`</span><br><span class="line">      &#x27;is-circle&#x27;: circle,</span><br><span class="line">      &#x27;is-disabled&#x27;: disabled,</span><br><span class="line">      &#x27;is-loading&#x27;: loading,</span><br><span class="line">    &#125;&quot;</span><br><span class="line">    :disabled=&quot;disabled || loading ? true : void 0&quot; //`disabled` 为 `true`，则渲染为 `&lt;button disabled&gt;`按钮被禁用</span><br><span class="line">    :type=&quot;tag === &#x27;button&#x27; ? nativeType : void 0&quot;</span><br><span class="line">    :autofocus=&quot;autofocus&quot; //当 `autofocus` 为 `true` 时，按钮自动获得焦点</span><br><span class="line">    @click=&quot;</span><br><span class="line">      (e: MouseEvent) =&gt;</span><br><span class="line">        useThrottle ? handlBtneCLickThrottle(e) : handleBtnClick(e)</span><br><span class="line">    &quot; //当 `useThrottle` 为 `true` 时，调用防抖的 `handlBtneCLickThrottle` 方法；否则调用普通点击事件 `handleBtnClick`</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;template v-if=&quot;loading&quot;&gt;//条件插槽</span><br><span class="line">      &lt;slot name=&quot;loading&quot;&gt;//默认 || 接收用户传来的&lt;er-icon&gt;标签</span><br><span class="line">        &lt;er-icon//默认提供spinner加载图标</span><br><span class="line">          class=&quot;loading-icon&quot;</span><br><span class="line">          :icon=&quot;loadingIcon ?? &#x27;spinner&#x27;&quot;//不是库中的Icon就默认图标为spinner</span><br><span class="line">          :style=&quot;iconStyle&quot;//默认style，用户可改</span><br><span class="line">          size=&quot;1x&quot;//锁定的大小</span><br><span class="line">          spin//</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/slot&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;er-icon</span><br><span class="line">      :icon=&quot;icon&quot;</span><br><span class="line">      size=&quot;1x&quot;</span><br><span class="line">      :style=&quot;iconStyle&quot;</span><br><span class="line">      v-if=&quot;icon &amp;&amp; !loading&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/component&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>



<h4 id="├─-ButtonGroup-vue"><a href="#├─-ButtonGroup-vue" class="headerlink" title="├─ ButtonGroup.vue"></a>├─ ButtonGroup.vue</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; ButtonGroupProps &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; provide, reactive, toRef &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; BUTTON_GROUP_CTX_KEY &#125; from &quot;./constants&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErButtonGroup&quot;,</span><br><span class="line">&#125;);</span><br><span class="line">const props = defineProps&lt;ButtonGroupProps&gt;();</span><br><span class="line"></span><br><span class="line">provide(</span><br><span class="line">  BUTTON_GROUP_CTX_KEY,</span><br><span class="line">  reactive(&#123;</span><br><span class="line">    size: toRef(props, &quot;size&quot;),</span><br><span class="line">    type: toRef(props, &quot;type&quot;),</span><br><span class="line">    disabled: toRef(props, &quot;disabled&quot;),</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;er-button-group&quot;&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>



<h4 id="├─-constants-ts"><a href="#├─-constants-ts" class="headerlink" title="├─ constants.ts"></a>├─ constants.ts</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">InjectionKey</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ButtonGroupContext</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//注入键（Injection Key）（BUTTON_GROUP_CTX_KEY）</span></span><br><span class="line"><span class="comment">//主要作用是为按钮组组件（`ButtonGroup`）提供上下文（context），使得按钮组中的子按钮可以访问父级按钮组的相关信息。</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">BUTTON_GROUP_CTX_KEY</span>: </span><br><span class="line"><span class="title class_">InjectionKey</span>&lt;<span class="title class_">ButtonGroupContext</span>&gt; =</span><br><span class="line">  <span class="title class_">Symbol</span>(<span class="string">&quot;buttonGroupContext&quot;</span>);<span class="comment">//原始数据类型，用于创建唯一的标识符</span></span><br></pre></td></tr></table></figure>

<p>举个例子</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line"><span class="comment">//会使用 `provide` 方法将某些数据或方法提供给子组件</span></span><br><span class="line"><span class="keyword">import</span> &#123; provide &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>; </span><br><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">BUTTON_GROUP_CTX_KEY</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./constants&quot;</span>; </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; </span><br><span class="line">	<span class="title function_">setup</span>(<span class="params"></span>) &#123; </span><br><span class="line">		<span class="keyword">const</span> buttonGroupContext = &#123; <span class="attr">size</span>: <span class="string">&quot;large&quot;</span>, <span class="attr">type</span>: <span class="string">&quot;primary&quot;</span>, &#125;; </span><br><span class="line">		<span class="title function_">provide</span>(<span class="variable constant_">BUTTON_GROUP_CTX_KEY</span>, buttonGroupContext); <span class="comment">// 提供上下文 </span></span><br><span class="line">		<span class="keyword">return</span> &#123;&#125;; </span><br><span class="line">	&#125;, </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//子组件</span></span><br><span class="line"><span class="comment">//可以通过 `inject` 方法获取父组件提供的上下文</span></span><br><span class="line"><span class="keyword">import</span> &#123; inject &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">BUTTON_GROUP_CTX_KEY</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./constants&quot;</span>; </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	<span class="title function_">setup</span>(<span class="params"></span>) &#123; </span><br><span class="line">		<span class="keyword">const</span> buttonGroupContext = <span class="title function_">inject</span>(<span class="variable constant_">BUTTON_GROUP_CTX_KEY</span>); <span class="comment">// 注入上下文 </span></span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(buttonGroupContext); <span class="comment">// 输出 &#123; size: &quot;large&quot;, type: &quot;primary&quot; &#125; </span></span><br><span class="line">		<span class="keyword">return</span> &#123;&#125;; </span><br><span class="line">	&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


<h4 id="├─-index-ts-2"><a href="#├─-index-ts-2" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
<p>用 <code>withInstall</code> 方法将组件注册为全局组件</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Button</span> <span class="keyword">from</span> <span class="string">&quot;./Button.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ButtonGroup</span> <span class="keyword">from</span> <span class="string">&quot;./ButtonGroup.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@tyche/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErButton</span> = <span class="title function_">withInstall</span>(<span class="title class_">Button</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErButtonGroup</span> = <span class="title function_">withInstall</span>(<span class="title class_">ButtonGroup</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>



<h4 id="├─-style-css-1"><a href="#├─-style-css-1" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="└─-types-ts-1"><a href="#└─-types-ts-1" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">type</span> <span class="title class_">Component</span>, <span class="keyword">type</span> <span class="title class_">ComputedRef</span>, <span class="keyword">type</span> <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ButtonType</span> = <span class="string">&#x27;primary&#x27;</span> | <span class="string">&#x27;success&#x27;</span> | <span class="string">&#x27;warning&#x27;</span> | <span class="string">&#x27;danger&#x27;</span> | <span class="string">&#x27;info&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">NativeType</span> = <span class="string">&#x27;button&#x27;</span> | <span class="string">&#x27;submit&#x27;</span> | <span class="string">&#x27;reset&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ButtonSize</span> = <span class="string">&#x27;default&#x27;</span> | <span class="string">&#x27;large&#x27;</span> | <span class="string">&#x27;small&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ButtonProps</span> &#123;</span><br><span class="line">	<span class="attr">tag</span>?: <span class="built_in">string</span> | <span class="title class_">Component</span></span><br><span class="line">	<span class="attr">type</span>?: <span class="title class_">ButtonType</span></span><br><span class="line">	<span class="attr">size</span>?: <span class="title class_">ButtonSize</span></span><br><span class="line">	<span class="attr">plain</span>?: <span class="built_in">boolean</span></span><br><span class="line">	<span class="attr">round</span>?: <span class="built_in">boolean</span></span><br><span class="line">	<span class="attr">circle</span>?: <span class="built_in">boolean</span></span><br><span class="line">	<span class="attr">disabled</span>?: <span class="built_in">boolean</span></span><br><span class="line">	<span class="attr">autofocus</span>?: <span class="built_in">boolean</span></span><br><span class="line">	<span class="attr">nativeType</span>?: <span class="title class_">NativeType</span></span><br><span class="line">	<span class="attr">icon</span>?: <span class="built_in">string</span></span><br><span class="line">	<span class="attr">loading</span>?: <span class="built_in">boolean</span></span><br><span class="line">	<span class="attr">loadingIcon</span>?: <span class="built_in">string</span></span><br><span class="line">	<span class="attr">useThrottle</span>?: <span class="built_in">boolean</span></span><br><span class="line">	<span class="attr">throttleDuration</span>?: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ButtonGroupProps</span> &#123;</span><br><span class="line">	<span class="attr">size</span>?: <span class="title class_">ButtonSize</span></span><br><span class="line">	<span class="attr">type</span>?: <span class="title class_">ButtonType</span></span><br><span class="line">	<span class="attr">disabled</span>?: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ButtonGroupContext</span> &#123;</span><br><span class="line">	<span class="attr">size</span>?: <span class="title class_">ButtonSize</span></span><br><span class="line">	<span class="attr">type</span>?: <span class="title class_">ButtonType</span></span><br><span class="line">	<span class="attr">disabled</span>?: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ButtonEmits</span> &#123;</span><br><span class="line">	(<span class="attr">e</span>: <span class="string">&#x27;click&#x27;</span>, <span class="attr">value</span>: <span class="title class_">MouseEvent</span>): <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ButtonInstance</span> &#123;</span><br><span class="line">	<span class="attr">ref</span>: <span class="title class_">Ref</span>&lt;<span class="title class_">HTMLButtonElement</span> | <span class="built_in">void</span>&gt;</span><br><span class="line">	<span class="attr">disabled</span>: <span class="title class_">ComputedRef</span>&lt;<span class="built_in">boolean</span>&gt;</span><br><span class="line">	<span class="attr">size</span>: <span class="title class_">ComputedRef</span>&lt;<span class="built_in">string</span>&gt;</span><br><span class="line">	<span class="attr">type</span>: <span class="title class_">ComputedRef</span>&lt;<span class="built_in">string</span>&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Collapse"><a href="#├─-Collapse" class="headerlink" title="├─ Collapse"></a>├─ Collapse</h3><blockquote>
<p>折叠面板</p>
</blockquote>
<h4 id="–API–-2"><a href="#–API–-2" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-Collapse-test-tsx"><a href="#├─-Collapse-test-tsx" class="headerlink" title="├─ Collapse.test.tsx"></a>├─ Collapse.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; beforeAll, describe, expect, test, vi &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">DOMWrapper</span>, mount, <span class="keyword">type</span> <span class="title class_">VueWrapper</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@vue/test-utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> transitionEvents <span class="keyword">from</span> <span class="string">&quot;./transitionEvents&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Collapse</span> <span class="keyword">from</span> <span class="string">&quot;./Collapse.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">CollapseItem</span> <span class="keyword">from</span> <span class="string">&quot;./CollapseItem.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> onChange = vi.<span class="title function_">fn</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">wrapper</span>: <span class="title class_">VueWrapper</span>,</span><br><span class="line">  <span class="attr">headers</span>: <span class="title class_">DOMWrapper</span>&lt;<span class="title class_">Element</span>&gt;[],</span><br><span class="line">  <span class="attr">contents</span>: <span class="title class_">DOMWrapper</span>&lt;<span class="title class_">Element</span>&gt;[];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">firstHeader</span>: <span class="title class_">DOMWrapper</span>&lt;<span class="title class_">Element</span>&gt;,</span><br><span class="line">  <span class="attr">secondHeader</span>: <span class="title class_">DOMWrapper</span>&lt;<span class="title class_">Element</span>&gt;,</span><br><span class="line">  <span class="attr">disabledHeader</span>: <span class="title class_">DOMWrapper</span>&lt;<span class="title class_">Element</span>&gt;,</span><br><span class="line">  <span class="attr">firstContent</span>: <span class="title class_">DOMWrapper</span>&lt;<span class="title class_">Element</span>&gt;,</span><br><span class="line">  <span class="attr">secondContent</span>: <span class="title class_">DOMWrapper</span>&lt;<span class="title class_">Element</span>&gt;,</span><br><span class="line">  <span class="attr">disabledContent</span>: <span class="title class_">DOMWrapper</span>&lt;<span class="title class_">Element</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Collapse.vue&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">beforeAll</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    wrapper = <span class="title function_">mount</span>(</span><br><span class="line">      <span class="function">() =&gt;</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Collapse</span> <span class="attr">modelValue</span>=<span class="string">&#123;[</span>&quot;<span class="attr">a</span>&quot;]&#125; &#123;<span class="attr">...</span>&#123; <span class="attr">onChange</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">CollapseItem</span> <span class="attr">name</span>=<span class="string">&quot;a&quot;</span> <span class="attr">title</span>=<span class="string">&quot;title a&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            content a</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">CollapseItem</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">CollapseItem</span> <span class="attr">name</span>=<span class="string">&quot;b&quot;</span> <span class="attr">title</span>=<span class="string">&quot;title b&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            content b</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">CollapseItem</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">CollapseItem</span> <span class="attr">name</span>=<span class="string">&quot;c&quot;</span> <span class="attr">title</span>=<span class="string">&quot;title c&quot;</span> <span class="attr">disabled</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            content c</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">CollapseItem</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Collapse</span>&gt;</span></span></span><br><span class="line">      ),</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">global</span>: &#123;</span><br><span class="line">          <span class="attr">stubs</span>: [<span class="string">&quot;ErIcon&quot;</span>],</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">attachTo</span>: <span class="variable language_">document</span>.<span class="property">body</span>, <span class="comment">// 最新版本 jsdom 更新缓存 bug</span></span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    headers = wrapper.<span class="title function_">findAll</span>(<span class="string">&quot;.er-collapse-item__header&quot;</span>);</span><br><span class="line">    contents = wrapper.<span class="title function_">findAll</span>(<span class="string">&quot;.er-collapse-item__wapper&quot;</span>);</span><br><span class="line"></span><br><span class="line">    firstHeader = headers[<span class="number">0</span>];</span><br><span class="line">    secondHeader = headers[<span class="number">1</span>];</span><br><span class="line">    disabledHeader = headers[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    firstContent = contents[<span class="number">0</span>];</span><br><span class="line">    secondContent = contents[<span class="number">1</span>];</span><br><span class="line">    disabledContent = contents[<span class="number">2</span>];</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;测试基础结构以及对应文本&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// lenght</span></span><br><span class="line">    <span class="title function_">expect</span>(headers.<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">3</span>);</span><br><span class="line">    <span class="title function_">expect</span>(contents.<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// title</span></span><br><span class="line">    <span class="title function_">expect</span>(firstHeader.<span class="title function_">text</span>()).<span class="title function_">toBe</span>(<span class="string">&quot;title a&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// content</span></span><br><span class="line">    <span class="title function_">expect</span>(firstHeader.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;is-active&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(firstContent.<span class="title function_">isVisible</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(secondHeader.<span class="title function_">classes</span>()).<span class="property">not</span>.<span class="title function_">toContain</span>(<span class="string">&quot;is-active&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(secondContent.<span class="title function_">isVisible</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(firstContent.<span class="title function_">text</span>()).<span class="title function_">toBe</span>(<span class="string">&quot;content a&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(secondContent.<span class="title function_">text</span>()).<span class="title function_">toBe</span>(<span class="string">&quot;content b&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;点击标题展开/关闭内容&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// events</span></span><br><span class="line">    <span class="keyword">await</span> firstHeader.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(firstContent.<span class="title function_">isVisible</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">    <span class="keyword">await</span> secondHeader.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(secondHeader.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;is-active&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(secondHeader.<span class="title function_">isVisible</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(firstHeader.<span class="title function_">classes</span>()).<span class="property">not</span>.<span class="title function_">toContain</span>(<span class="string">&quot;is-active&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(firstContent.<span class="title function_">isVisible</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;发送正确的事件&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(onChange).<span class="title function_">toHaveBeenCalledTimes</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="title function_">expect</span>(onChange).<span class="title function_">toHaveBeenCalledWith</span>([]);</span><br><span class="line">    <span class="title function_">expect</span>(onChange).<span class="title function_">toHaveBeenLastCalledWith</span>([<span class="string">&quot;b&quot;</span>]);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;disabled 内容&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// disabled</span></span><br><span class="line">    <span class="title function_">expect</span>(disabledHeader.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;is-disabled&quot;</span>);</span><br><span class="line">    onChange.<span class="title function_">mockClear</span>();</span><br><span class="line">    <span class="keyword">await</span> disabledHeader.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(disabledContent.<span class="title function_">isVisible</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(onChange).<span class="property">not</span>.<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;modelValue 变更&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    wrapper.<span class="title function_">setValue</span>([<span class="string">&quot;b&quot;</span>], <span class="string">&quot;modelValue&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="property">vm</span>.$nextTick();</span><br><span class="line">    <span class="title function_">expect</span>(secondHeader.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;is-active&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(firstHeader.<span class="title function_">classes</span>()).<span class="property">not</span>.<span class="title function_">toContain</span>(<span class="string">&quot;is-active&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;手风琴模式&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    wrapper = <span class="title function_">mount</span>(</span><br><span class="line">      <span class="function">() =&gt;</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Collapse</span> <span class="attr">accordion</span> <span class="attr">modelValue</span>=<span class="string">&#123;[</span>&quot;<span class="attr">a</span>&quot;]&#125; &#123;<span class="attr">...</span>&#123; <span class="attr">onChange</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">CollapseItem</span> <span class="attr">name</span>=<span class="string">&quot;a&quot;</span> <span class="attr">title</span>=<span class="string">&quot;title a&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            content a</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">CollapseItem</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">CollapseItem</span> <span class="attr">name</span>=<span class="string">&quot;b&quot;</span> <span class="attr">title</span>=<span class="string">&quot;title b&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            content b</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">CollapseItem</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Collapse</span>&gt;</span></span></span><br><span class="line">      ),</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">global</span>: &#123;</span><br><span class="line">          <span class="attr">stubs</span>: [<span class="string">&quot;ErIcon&quot;</span>],</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">attachTo</span>: <span class="variable language_">document</span>.<span class="property">body</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    headers = wrapper.<span class="title function_">findAll</span>(<span class="string">&quot;.er-collapse-item__header&quot;</span>);</span><br><span class="line">    contents = wrapper.<span class="title function_">findAll</span>(<span class="string">&quot;.er-collapse-item__wapper&quot;</span>);</span><br><span class="line"></span><br><span class="line">    firstHeader = headers[<span class="number">0</span>];</span><br><span class="line">    secondHeader = headers[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    firstContent = contents[<span class="number">0</span>];</span><br><span class="line">    secondContent = contents[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">await</span> firstHeader.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> secondHeader.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(onChange).<span class="title function_">toHaveBeenCalledTimes</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="title function_">expect</span>(onChange).<span class="title function_">toHaveBeenCalledWith</span>([<span class="string">&quot;b&quot;</span>]);</span><br><span class="line">    <span class="title function_">expect</span>(firstHeader.<span class="title function_">classes</span>()).<span class="property">not</span>.<span class="title function_">toContain</span>(<span class="string">&quot;is-active&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(secondHeader.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;is-active&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;手风琴模式 错误处理&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> warn = vi.<span class="title function_">spyOn</span>(<span class="variable language_">console</span>, <span class="string">&quot;warn&quot;</span>).<span class="title function_">mockImplementation</span>(<span class="function">() =&gt;</span> &#123;&#125;);</span><br><span class="line">    <span class="title function_">mount</span>(</span><br><span class="line">      <span class="function">() =&gt;</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">Collapse</span> <span class="attr">accordion</span> <span class="attr">modelValue</span>=<span class="string">&#123;[</span>&quot;<span class="attr">a</span>&quot;, &quot;<span class="attr">b</span>&quot;]&#125; &#123;<span class="attr">...</span>&#123; <span class="attr">onChange</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">CollapseItem</span> <span class="attr">name</span>=<span class="string">&quot;a&quot;</span> <span class="attr">title</span>=<span class="string">&quot;title a&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            content a</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">CollapseItem</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">CollapseItem</span> <span class="attr">name</span>=<span class="string">&quot;b&quot;</span> <span class="attr">title</span>=<span class="string">&quot;title b&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            content b</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">CollapseItem</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">CollapseItem</span> <span class="attr">name</span>=<span class="string">&quot;c&quot;</span> <span class="attr">title</span>=<span class="string">&quot;title c&quot;</span> <span class="attr">disabled</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            content c</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">CollapseItem</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Collapse</span>&gt;</span></span></span><br><span class="line">      ),</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">global</span>: &#123;</span><br><span class="line">          <span class="attr">stubs</span>: [<span class="string">&quot;ErIcon&quot;</span>],</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="title function_">expect</span>(warn.<span class="property">mock</span>.<span class="property">calls</span>).<span class="title function_">toMatchInlineSnapshot</span>(</span><br><span class="line">      <span class="string">`</span></span><br><span class="line"><span class="string">        [</span></span><br><span class="line"><span class="string">          [</span></span><br><span class="line"><span class="string">            [ErUIError: [ErCollapse] accordion mode should only have one active item],</span></span><br><span class="line"><span class="string">          ],</span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">      `</span></span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Collapse/transitionEvents.ts&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;beforeEnter&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    transitionEvents.<span class="title function_">beforeEnter</span>(wrapper.<span class="property">element</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">style</span>.<span class="property">height</span>).<span class="title function_">toBe</span>(<span class="string">&quot;0px&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">style</span>.<span class="property">overflow</span>).<span class="title function_">toBe</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;enter&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    transitionEvents.<span class="title function_">enter</span>(wrapper.<span class="property">element</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">style</span>.<span class="property">height</span>).<span class="title function_">toBe</span>(</span><br><span class="line">      <span class="string">`<span class="subst">$&#123;wrapper.element.scrollHeight&#125;</span>px`</span></span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;afterEnter&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    transitionEvents.<span class="title function_">afterEnter</span>(wrapper.<span class="property">element</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">style</span>.<span class="property">height</span>).<span class="title function_">toBe</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">style</span>.<span class="property">overflow</span>).<span class="title function_">toBe</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;beforeLeave&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    transitionEvents.<span class="title function_">beforeLeave</span>(wrapper.<span class="property">element</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">style</span>.<span class="property">height</span>).<span class="title function_">toBe</span>(</span><br><span class="line">      <span class="string">`<span class="subst">$&#123;wrapper.element.scrollHeight&#125;</span>px`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">style</span>.<span class="property">overflow</span>).<span class="title function_">toBe</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;leave&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    transitionEvents.<span class="title function_">leave</span>(wrapper.<span class="property">element</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">style</span>.<span class="property">height</span>).<span class="title function_">toBe</span>(<span class="string">&quot;0px&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;afterLeave&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    transitionEvents.<span class="title function_">afterLeave</span>(wrapper.<span class="property">element</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">style</span>.<span class="property">height</span>).<span class="title function_">toBe</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="property">element</span>.<span class="property">style</span>.<span class="property">overflow</span>).<span class="title function_">toBe</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="├─-Collapse-vue"><a href="#├─-Collapse-vue" class="headerlink" title="├─ Collapse.vue"></a>├─ Collapse.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, provide, watch &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; each &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import type &#123;</span><br><span class="line">  CollapseItemName,</span><br><span class="line">  CollapseProps,</span><br><span class="line">  CollapseEmits,</span><br><span class="line">&#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; debugWarn &#125; from &quot;@eric-ui/utils&quot;;</span><br><span class="line">import &#123; COLLAPSE_CTX_KEY &#125; from &quot;./constants&quot;;</span><br><span class="line"></span><br><span class="line">const COMPONENT_NAME = &quot;ErCollapse&quot; as const;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: COMPONENT_NAME,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const props = defineProps&lt;CollapseProps&gt;();</span><br><span class="line">const emits = defineEmits&lt;CollapseEmits&gt;();</span><br><span class="line">const activeNames = ref&lt;CollapseItemName[]&gt;(props.modelValue);</span><br><span class="line"></span><br><span class="line">if (props.accordion &amp;&amp; activeNames.value.length &gt; 1) &#123;</span><br><span class="line">  debugWarn(COMPONENT_NAME, &quot;accordion mode should only have one active item&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleItemClick(item: CollapseItemName) &#123;</span><br><span class="line">  let _activeNames = [...activeNames.value];</span><br><span class="line">  // 手风琴模式</span><br><span class="line">  if (props.accordion) &#123;</span><br><span class="line">    _activeNames = [_activeNames[0] === item ? &quot;&quot; : item];</span><br><span class="line">    updateActiveNames(_activeNames);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  const index = _activeNames.indexOf(item);</span><br><span class="line">  if (index &gt; -1) &#123;</span><br><span class="line">    // 存在，删除数组中的一项</span><br><span class="line">    _activeNames.splice(index, 1);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    // 不存在，插入对应 name</span><br><span class="line">    _activeNames.push(item);</span><br><span class="line">  &#125;</span><br><span class="line">  updateActiveNames(_activeNames);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function updateActiveNames(val: CollapseItemName[]) &#123;</span><br><span class="line">  activeNames.value = val;</span><br><span class="line">  each([&quot;update:modelValue&quot;, &quot;change&quot;], (e) =&gt;</span><br><span class="line">    emits(e as &quot;update:modelValue&quot; &amp; &quot;change&quot;, val)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  () =&gt; props.modelValue,</span><br><span class="line">  (val) =&gt; updateActiveNames(val)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">provide(COLLAPSE_CTX_KEY, &#123;</span><br><span class="line">  activeNames,</span><br><span class="line">  handleItemClick,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;er-collapse&quot;&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-CollapseItem-vue"><a href="#├─-CollapseItem-vue" class="headerlink" title="├─ CollapseItem.vue"></a>├─ CollapseItem.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; type CollapseItemProps &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; inject, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; COLLAPSE_CTX_KEY &#125; from &quot;./constants&quot;;</span><br><span class="line">import transitionEvents from &quot;./transitionEvents&quot;;</span><br><span class="line">import ErIcon from &quot;../Icon/Icon.vue&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErCollapseItem&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const props = defineProps&lt;CollapseItemProps&gt;();</span><br><span class="line"></span><br><span class="line">const ctx = inject(COLLAPSE_CTX_KEY);</span><br><span class="line"></span><br><span class="line">const isActive = computed(() =&gt; ctx?.activeNames.value?.includes(props.name));</span><br><span class="line"></span><br><span class="line">function handleClick() &#123;</span><br><span class="line">  if (props.disabled) return;</span><br><span class="line">  ctx?.handleItemClick(props.name);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    class=&quot;er-collapse-item&quot;</span><br><span class="line">    :class=&quot;&#123;</span><br><span class="line">      &#x27;is-disabled&#x27;: disabled,</span><br><span class="line">    &#125;&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      class=&quot;er-collapse-item__header&quot;</span><br><span class="line">      :id=&quot;`item-header-$&#123;name&#125;`&quot;</span><br><span class="line">      :class=&quot;&#123;</span><br><span class="line">        &#x27;is-disabled&#x27;: disabled,</span><br><span class="line">        &#x27;is-active&#x27;: isActive,</span><br><span class="line">      &#125;&quot;</span><br><span class="line">      @click=&quot;handleClick&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;span class=&quot;er-collapse-item__title&quot;&gt;</span><br><span class="line">        &lt;slot name=&quot;title&quot;&gt;</span><br><span class="line">          &#123;&#123; title &#125;&#125;</span><br><span class="line">        &lt;/slot&gt;</span><br><span class="line">      &lt;/span&gt;</span><br><span class="line">      &lt;er-icon icon=&quot;angle-right&quot; class=&quot;header-angle&quot; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;transition name=&quot;slide&quot; v-on=&quot;transitionEvents&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;er-collapse-item__wapper&quot; v-show=&quot;isActive&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;er-collapse-item__content&quot; :id=&quot;`item-content-$&#123;name&#125;`&quot;&gt;</span><br><span class="line">          &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/transition&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-constants-ts-1"><a href="#├─-constants-ts-1" class="headerlink" title="├─ constants.ts"></a>├─ constants.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">InjectionKey</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">CollapseContext</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">COLLAPSE_CTX_KEY</span>: <span class="title class_">InjectionKey</span>&lt;<span class="title class_">CollapseContext</span>&gt; =</span><br><span class="line">  <span class="title class_">Symbol</span>(<span class="string">&quot;collapseContext&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="├─-index-ts-3"><a href="#├─-index-ts-3" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Collapse</span> <span class="keyword">from</span> <span class="string">&quot;./Collapse.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">CollapseItem</span> <span class="keyword">from</span> <span class="string">&quot;./CollapseItem.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErCollapse</span> = <span class="title function_">withInstall</span>(<span class="title class_">Collapse</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErCollapseItem</span> = <span class="title function_">withInstall</span>(<span class="title class_">CollapseItem</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-2"><a href="#├─-style-css-2" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-collapse</span> &#123;</span><br><span class="line">  <span class="attr">--er-collapse-border-color</span>: <span class="built_in">var</span>(--er-border-color-light);</span><br><span class="line">  <span class="attr">--er-collapse-header-height</span>: <span class="number">48px</span>;</span><br><span class="line">  <span class="attr">--er-collapse-header-bg-color</span>: <span class="built_in">var</span>(--er-fill-color-blank);</span><br><span class="line">  <span class="attr">--er-collapse-header-text-color</span>: <span class="built_in">var</span>(--er-text-color-primary);</span><br><span class="line">  <span class="attr">--er-collapse-header-font-size</span>: <span class="number">13px</span>;</span><br><span class="line">  <span class="attr">--er-collapse-content-bg-color</span>: <span class="built_in">var</span>(--er-fill-color-blank);</span><br><span class="line">  <span class="attr">--er-collapse-content-font-size</span>: <span class="number">13px</span>;</span><br><span class="line">  <span class="attr">--er-collapse-content-text-color</span>: <span class="built_in">var</span>(--er-text-color-primary);</span><br><span class="line">  <span class="attr">--er-collapse-disabled-text-color</span>: <span class="built_in">var</span>(--er-disabled-text-color);</span><br><span class="line">  <span class="attr">--er-collapse-disabled-border-color</span>: <span class="built_in">var</span>(--er-border-color-lighter);</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-collapse-border-color);</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-collapse-border-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-collapse-item__header</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">  <span class="attribute">height</span>: <span class="built_in">var</span>(--er-collapse-header-height);</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="built_in">var</span>(--er-collapse-header-height);</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-collapse-header-bg-color);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--er-collapse-header-text-color);</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-collapse-header-font-size);</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">500</span>;</span><br><span class="line">  <span class="attribute">transition</span>: border-bottom-color <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-collapse-border-color);</span><br><span class="line">  &amp;<span class="selector-class">.is-disabled</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-collapse-disabled-text-color);</span><br><span class="line">    <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">    <span class="attribute">background-image</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-active</span> &#123;</span><br><span class="line">    <span class="attribute">border-bottom-color</span>: transparent;</span><br><span class="line">    <span class="selector-class">.header-angle</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">90deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.header-angle</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: transform <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-collapse-item__content</span> &#123;</span><br><span class="line">  <span class="attribute">will-change</span>: height;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-collapse-content-bg-color);</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-collapse-content-font-size);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--er-collapse-content-text-color);</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-collapse-border-color);</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">25px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.slide-enter-active</span>,</span><br><span class="line"><span class="selector-class">.slide-leave-active</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: height <span class="built_in">var</span>(--er-transition-duration) ease-in-out;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="├─-transitionEvents-ts"><a href="#├─-transitionEvents-ts" class="headerlink" title="├─ transitionEvents.ts"></a>├─ transitionEvents.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">_setHeightZero</span> = (<span class="params"><span class="attr">el</span>: <span class="title class_">HTMLElement</span></span>) =&gt; (el.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&quot;0px&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">_setHeightScroll</span> = (<span class="params"><span class="attr">el</span>: <span class="title class_">HTMLElement</span></span>) =&gt;</span><br><span class="line">  (el.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`<span class="subst">$&#123;el.scrollHeight&#125;</span>px`</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">_setHeightEmpty</span> = (<span class="params"><span class="attr">el</span>: <span class="title class_">HTMLElement</span></span>) =&gt; (el.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">_setOverflowHidden</span> = (<span class="params"><span class="attr">el</span>: <span class="title class_">HTMLElement</span></span>) =&gt; (el.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&quot;hidden&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">_setOverflowEmpty</span> = (<span class="params"><span class="attr">el</span>: <span class="title class_">HTMLElement</span></span>) =&gt; (el.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">transitionEvents</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="function">(<span class="params"><span class="attr">el</span>: <span class="title class_">HTMLElement</span></span>) =&gt;</span> <span class="built_in">void</span>&gt; = &#123;</span><br><span class="line">  <span class="title function_">beforeEnter</span>(<span class="params">el</span>) &#123;</span><br><span class="line">    <span class="title function_">_setHeightZero</span>(el);</span><br><span class="line">    <span class="title function_">_setOverflowHidden</span>(el);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">enter</span>: <span class="function">(<span class="params">el</span>) =&gt;</span> <span class="title function_">_setHeightScroll</span>(el),</span><br><span class="line">  <span class="title function_">afterEnter</span>(<span class="params">el</span>) &#123;</span><br><span class="line">    <span class="title function_">_setHeightEmpty</span>(el);</span><br><span class="line">    <span class="title function_">_setOverflowEmpty</span>(el);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">beforeLeave</span>(<span class="params">el</span>) &#123;</span><br><span class="line">    <span class="title function_">_setHeightScroll</span>(el);</span><br><span class="line">    <span class="title function_">_setOverflowHidden</span>(el);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">leave</span>: <span class="function">(<span class="params">el</span>) =&gt;</span> <span class="title function_">_setHeightZero</span>(el),</span><br><span class="line">  <span class="title function_">afterLeave</span>(<span class="params">el</span>) &#123;</span><br><span class="line">    <span class="title function_">_setHeightEmpty</span>(el);</span><br><span class="line">    <span class="title function_">_setOverflowEmpty</span>(el);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> transitionEvents;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-2"><a href="#└─-types-ts-2" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CollapseItemName</span> = <span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">CollapseProps</span> &#123;</span><br><span class="line">  <span class="attr">modelValue</span>: <span class="title class_">CollapseItemName</span>[];</span><br><span class="line">  <span class="attr">accordion</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">CollapseItemProps</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="title class_">CollapseItemName</span>;</span><br><span class="line">  <span class="attr">title</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">disabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">CollapseContext</span> &#123;</span><br><span class="line">  <span class="attr">activeNames</span>: <span class="title class_">Ref</span>&lt;<span class="title class_">CollapseItemName</span>[]&gt;;</span><br><span class="line">  <span class="title function_">handleItemClick</span>(<span class="attr">name</span>: <span class="title class_">CollapseItemName</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">CollapseEmits</span> &#123;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;update:modelValue&quot;</span>, <span class="attr">value</span>: <span class="title class_">CollapseItemName</span>[]): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;change&quot;</span>, <span class="attr">value</span>: <span class="title class_">CollapseItemName</span>[]): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-ConfigProvider"><a href="#├─-ConfigProvider" class="headerlink" title="├─ ConfigProvider"></a>├─ ConfigProvider</h3><blockquote>
<p>全局配置组件，用于设置组件库的全局属性</p>
</blockquote>
<h4 id="–API–-3"><a href="#–API–-3" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-ConfigProvider-vue"><a href="#├─-ConfigProvider-vue" class="headerlink" title="├─ ConfigProvider.vue"></a>├─ ConfigProvider.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; ConfigProviderProps &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; provideGlobalConfig &#125; from &quot;./hooks&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErConfigProvider&quot;,</span><br><span class="line">&#125;);</span><br><span class="line">const props = defineProps&lt;ConfigProviderProps&gt;();</span><br><span class="line">const config = provideGlobalConfig(props);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;slot name=&quot;default&quot; :config=&quot;config&quot;&gt;&lt;/slot&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-constants-ts-2"><a href="#├─-constants-ts-2" class="headerlink" title="├─ constants.ts"></a>├─ constants.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ConfigProviderProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">InjectionKey</span>, <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ConfigProviderContext</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">ConfigProviderProps</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">configProviderContextKey</span>: <span class="title class_">InjectionKey</span>&lt;</span><br><span class="line">  <span class="title class_">Ref</span>&lt;<span class="title class_">ConfigProviderContext</span>&gt;</span><br><span class="line">&gt; = <span class="title class_">Symbol</span>()</span><br></pre></td></tr></table></figure>

<h4 id="├─-hooks-ts"><a href="#├─-hooks-ts" class="headerlink" title="├─ hooks.ts"></a>├─ hooks.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  ref,</span><br><span class="line">  getCurrentInstance,</span><br><span class="line">  inject,</span><br><span class="line">  computed,</span><br><span class="line">  provide,</span><br><span class="line">  unref,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">MaybeRef</span>, <span class="title class_">Ref</span>, <span class="title class_">App</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  configProviderContextKey,</span><br><span class="line">  <span class="keyword">type</span> <span class="title class_">ConfigProviderContext</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;./constants&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createI18n, i18nSymbol &#125; <span class="keyword">from</span> <span class="string">&quot;vue3-i18n&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">TranslatePair</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/locale&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">English</span> <span class="keyword">from</span> <span class="string">&quot;@eric-ui/locale/lang/en&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; merge &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; debugWarn &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> globalConfig = ref&lt;<span class="title class_">ConfigProviderContext</span>&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> useGlobalConfig&lt;</span><br><span class="line">  K <span class="keyword">extends</span> keyof <span class="title class_">ConfigProviderContext</span>,</span><br><span class="line">  D <span class="keyword">extends</span> <span class="title class_">ConfigProviderContext</span>[K],</span><br><span class="line">&gt;(<span class="attr">key</span>: K, <span class="attr">defaultVal</span>?: D): <span class="title class_">Ref</span>&lt;<span class="title class_">Exclude</span>&lt;<span class="title class_">ConfigProviderContext</span>[K], <span class="built_in">void</span>&gt;&gt;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useGlobalConfig</span>(<span class="params"></span>): <span class="title class_">Ref</span>&lt;<span class="title class_">ConfigProviderContext</span>&gt;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useGlobalConfig</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">key</span>?: keyof <span class="title class_">ConfigProviderContext</span>,</span></span><br><span class="line"><span class="params">  defaultVal = <span class="built_in">void</span> <span class="number">0</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> config = <span class="title function_">getCurrentInstance</span>()</span><br><span class="line">    ? <span class="title function_">inject</span>(configProviderContextKey, globalConfig)</span><br><span class="line">    : globalConfig;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> key ? <span class="title function_">computed</span>(<span class="function">() =&gt;</span> config.<span class="property">value</span>?.[key] ?? defaultVal) : config;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">_createI18n</span> = (<span class="params"><span class="attr">opts</span>?: <span class="title class_">ConfigProviderContext</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">mergeMsg</span> = (<span class="params"><span class="attr">msg</span>: <span class="title class_">TranslatePair</span></span>) =&gt;</span><br><span class="line">    <span class="title function_">merge</span>(msg, opts?.<span class="property">extendsI18nMsg</span> ?? &#123;&#125;);</span><br><span class="line">  <span class="keyword">if</span> (!opts?.<span class="property">locale</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">createI18n</span>(&#123;</span><br><span class="line">      <span class="attr">locale</span>: <span class="string">&quot;en&quot;</span>,</span><br><span class="line">      <span class="attr">messages</span>: <span class="title function_">mergeMsg</span>(&#123;</span><br><span class="line">        <span class="attr">en</span>: <span class="title class_">English</span>.<span class="property">el</span>,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">createI18n</span>(&#123;</span><br><span class="line">    <span class="attr">locale</span>: opts.<span class="property">locale</span>?.<span class="property">name</span> || <span class="string">&quot;en&quot;</span>,</span><br><span class="line">    <span class="attr">messages</span>: <span class="title function_">mergeMsg</span>(&#123;</span><br><span class="line">      [opts.<span class="property">locale</span>?.<span class="property">name</span> || <span class="string">&quot;en&quot;</span>]: opts.<span class="property">locale</span>?.<span class="property">el</span> || &#123;&#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">provideGlobalConfig</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">config</span>: <span class="title class_">MaybeRef</span>&lt;<span class="title class_">ConfigProviderContext</span>&gt; = &#123; locale: English &#125;,</span></span><br><span class="line"><span class="params">  <span class="attr">app</span>?: <span class="title class_">App</span>,</span></span><br><span class="line"><span class="params">  <span class="variable language_">global</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> instance = <span class="title function_">getCurrentInstance</span>();</span><br><span class="line">  <span class="keyword">const</span> oldConfig = instance ? <span class="title function_">useGlobalConfig</span>() : <span class="built_in">void</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> provideFn = app?.<span class="property">provide</span> ?? (instance ? provide : <span class="built_in">void</span> <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!provideFn) &#123;</span><br><span class="line">    <span class="title function_">debugWarn</span>(</span><br><span class="line">      <span class="string">&quot;provideGlobalConfig&quot;</span>,</span><br><span class="line">      <span class="string">&quot;provideGlobalConfig() can only be used inside setup()&quot;</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> context = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> cfg = <span class="title function_">unref</span>(config);</span><br><span class="line">    <span class="keyword">if</span> (!oldConfig?.<span class="property">value</span>) <span class="keyword">return</span> cfg;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">merge</span>(oldConfig.<span class="property">value</span>, cfg);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> i18n = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">_createI18n</span>(context.<span class="property">value</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">provideFn</span>(configProviderContextKey, context);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">provideFn</span>(i18nSymbol, i18n.<span class="property">value</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (app) app.<span class="title function_">use</span>(i18n.<span class="property">value</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">global</span> || !globalConfig.<span class="property">value</span>) globalConfig.<span class="property">value</span> = context.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> context;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="├─-index-ts-4"><a href="#├─-index-ts-4" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ConfigProvider</span> <span class="keyword">from</span> <span class="string">&quot;./ConfigProvider.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;withInstall&#125; <span class="keyword">from</span> <span class="string">&#x27;@eric-ui/utils&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErConfigProvider</span> = <span class="title function_">withInstall</span>(<span class="title class_">ConfigProvider</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;./hooks&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-3"><a href="#└─-types-ts-3" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Language</span>, <span class="title class_">TranslatePair</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/locale&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ConfigProviderProps</span> &#123;</span><br><span class="line">  <span class="attr">locale</span>?: <span class="title class_">Language</span>;</span><br><span class="line">  <span class="attr">extendsI18nMsg</span>?: <span class="title class_">TranslatePair</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Dropdown"><a href="#├─-Dropdown" class="headerlink" title="├─ Dropdown"></a>├─ Dropdown</h3><blockquote>
<p>下拉菜单</p>
</blockquote>
<h4 id="–API–-4"><a href="#–API–-4" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-constants-ts-3"><a href="#├─-constants-ts-3" class="headerlink" title="├─ constants.ts"></a>├─ constants.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">InjectionKey</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">DropdownContext</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">DROPDOWN_CTX_KEY</span>: <span class="title class_">InjectionKey</span>&lt;<span class="title class_">DropdownContext</span>&gt; =</span><br><span class="line">  <span class="title class_">Symbol</span>(<span class="string">&quot;dropdownContext&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="├─-Dropdown-test-tsx"><a href="#├─-Dropdown-test-tsx" class="headerlink" title="├─ Dropdown.test.tsx"></a>├─ Dropdown.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, it, test, expect, vi, beforeEach &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&quot;@vue/test-utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ErDropdown</span>, <span class="title class_">ErDropdownItem</span> &#125; <span class="keyword">from</span> <span class="string">&quot;.&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">DropdownItemProps</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Dropdown</span> <span class="keyword">from</span> <span class="string">&quot;./Dropdown.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">DropdownItem</span> <span class="keyword">from</span> <span class="string">&quot;./DropdownItem.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line">vi.<span class="title function_">mock</span>(<span class="string">&quot;@popperjs/core&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Dropdown/index.ts&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 测试 withInstall 函数是否被正确应用</span></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should be exported with withInstall()&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">ErDropdown</span>.<span class="property">install</span>).<span class="title function_">toBeDefined</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">ErDropdownItem</span>.<span class="property">install</span>).<span class="title function_">toBeDefined</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 测试 Dropdown 组件是否被正确导出</span></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should be exported Dropdown component&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">ErDropdown</span>).<span class="title function_">toBe</span>(<span class="title class_">Dropdown</span>);</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">ErDropdownItem</span>).<span class="title function_">toBe</span>(<span class="title class_">DropdownItem</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 可选：测试 withInstall 是否增强了 Tooltip 组件的功能</span></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;should enhance Dropdown component&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> enhancedDropdown = <span class="title function_">withInstall</span>(<span class="title class_">Dropdown</span>);</span><br><span class="line">    <span class="title function_">expect</span>(enhancedDropdown).<span class="title function_">toBe</span>(<span class="title class_">ErDropdown</span>);</span><br><span class="line">    <span class="comment">// 这里可以添加更多测试，确保 withInstall 增强了组件的特定功能</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 可选：如果你的 withInstall 函数有特定的行为或属性，确保它们被正确应用</span></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;should apply specific enhancements&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> enhancedDropdown = <span class="title function_">withInstall</span>(<span class="title class_">Dropdown</span>);</span><br><span class="line">    <span class="comment">// 例如，如果你的 withInstall 增加了一个特定的方法或属性</span></span><br><span class="line">    <span class="title function_">expect</span>(enhancedDropdown).<span class="title function_">toHaveProperty</span>(<span class="string">&quot;install&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Dropdown.vue&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    vi.<span class="title function_">useFakeTimers</span>();</span><br><span class="line">    vi.<span class="title function_">clearAllMocks</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should render slots correctly&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">items</span>: <span class="title class_">DropdownItemProps</span>[] = [</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">&quot;Item 1&quot;</span>, <span class="attr">command</span>: <span class="string">&quot;item1&quot;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">&quot;Item 2&quot;</span>, <span class="attr">command</span>: <span class="string">&quot;item2&quot;</span> &#125;,</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Dropdown</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">trigger</span>: <span class="string">&quot;click&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;trigger&quot;</span>&gt;</span>Default slot content<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>,</span><br><span class="line">        <span class="attr">dropdown</span>: <span class="function">() =&gt;</span> items.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">DropdownItem</span> &#123;<span class="attr">...item</span>&#125; /&gt;</span></span>),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;Default slot content&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-dropdown&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should emit command event when item is clicked&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">items</span>: <span class="title class_">DropdownItemProps</span>[] = [</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">&quot;Item 1&quot;</span>, <span class="attr">disabled</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">&quot;Item 2&quot;</span>, <span class="attr">command</span>: <span class="string">&quot;item2&quot;</span>, <span class="attr">divided</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">const</span> onCommand = vi.<span class="title function_">fn</span>();</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Dropdown</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">trigger</span>: <span class="string">&quot;click&quot;</span>,</span><br><span class="line">        onCommand,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;trigger&quot;</span>&gt;</span>Default slot content<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>,</span><br><span class="line">        <span class="attr">dropdown</span>: <span class="function">() =&gt;</span> items.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">DropdownItem</span> &#123;<span class="attr">...item</span>&#125; /&gt;</span></span>),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> triggerArea = wrapper.<span class="title function_">find</span>(<span class="string">&quot;#trigger&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(triggerArea.<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line"></span><br><span class="line">    triggerArea.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-dropdown__menu&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">findAll</span>(<span class="string">&quot;li&quot;</span>).<span class="title function_">at</span>(<span class="number">0</span>)?.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(onCommand).<span class="title function_">toBeCalledTimes</span>(<span class="number">0</span>); <span class="comment">// disabled</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">findAll</span>(<span class="string">&quot;li&quot;</span>).<span class="title function_">at</span>(<span class="number">2</span>)?.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(onCommand).<span class="title function_">toBeCalled</span>();</span><br><span class="line">    <span class="title function_">expect</span>(onCommand).<span class="title function_">toBeCalledWith</span>(<span class="string">&quot;item2&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should toggle visibility when split btn is clicked&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">items</span>: <span class="title class_">DropdownItemProps</span>[] = [</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">&quot;Item 1&quot;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">&quot;Item 2&quot;</span>, <span class="attr">command</span>: <span class="string">&quot;item2&quot;</span> &#125;,</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">const</span> onClick = vi.<span class="title function_">fn</span>();</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Dropdown</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">trigger</span>: <span class="string">&quot;click&quot;</span>,</span><br><span class="line">        <span class="attr">splitButton</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">items</span>: items,</span><br><span class="line">        onClick,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;trigger&quot;</span>&gt;</span>Default slot content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> triggerArea = wrapper.<span class="title function_">find</span>(<span class="string">&quot;#trigger&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(triggerArea.<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    triggerArea.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-dropdown__menu&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(onClick).<span class="title function_">toBeCalled</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="├─-Dropdown-vue"><a href="#├─-Dropdown-vue" class="headerlink" title="├─ Dropdown.vue"></a>├─ Dropdown.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, computed, provide &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; omit, isNil &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import type &#123;</span><br><span class="line">  DropdownProps,</span><br><span class="line">  DropdownEmits,</span><br><span class="line">  DropdownInstance,</span><br><span class="line">  DropdownItemProps,</span><br><span class="line">  DropdownContext,</span><br><span class="line">&#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; useId, useDisabledStyle &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line">import &#123; DROPDOWN_CTX_KEY &#125; from &quot;./constants&quot;;</span><br><span class="line">import type &#123; TooltipInstance &#125; from &quot;../Tooltip/types&quot;;</span><br><span class="line"></span><br><span class="line">import &#123; type ButtonInstance, ErButton, ErButtonGroup &#125; from &quot;../Button&quot;;</span><br><span class="line">import DropdownItem from &quot;./DropdownItem.vue&quot;;</span><br><span class="line">import Tooltip from &quot;../Tooltip/Tooltip.vue&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErDropdown&quot;,</span><br><span class="line">  inheritAttrs: false,</span><br><span class="line">&#125;);</span><br><span class="line">const props = withDefaults(defineProps&lt;DropdownProps&gt;(), &#123;</span><br><span class="line">  hideOnClick: true,</span><br><span class="line">  items: () =&gt; [] as DropdownItemProps[],</span><br><span class="line">&#125;);</span><br><span class="line">const emits = defineEmits&lt;DropdownEmits&gt;();</span><br><span class="line">const slots = defineSlots();</span><br><span class="line"></span><br><span class="line">const tooltipRef = ref&lt;TooltipInstance&gt;();</span><br><span class="line">const triggerRef = ref&lt;ButtonInstance&gt;();</span><br><span class="line"></span><br><span class="line">const tooltipProps = computed(() =&gt;</span><br><span class="line">  omit(props, [&quot;items&quot;, &quot;hideAfterClick&quot;, &quot;size&quot;, &quot;type&quot;, &quot;splitButton&quot;])</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">function handleItemClick(e: DropdownItemProps) &#123;</span><br><span class="line">  props.hideOnClick &amp;&amp; tooltipRef.value?.hide();</span><br><span class="line">  !isNil(e.command) &amp;&amp; emits(&quot;command&quot;, e.command);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">!TEST &amp;&amp; useDisabledStyle();</span><br><span class="line">defineExpose&lt;DropdownInstance&gt;(&#123;</span><br><span class="line">  open: () =&gt; tooltipRef.value?.show(),</span><br><span class="line">  close: () =&gt; tooltipRef.value?.hide(),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">provide&lt;DropdownContext&gt;(DROPDOWN_CTX_KEY, &#123;</span><br><span class="line">  handleItemClick,</span><br><span class="line">  size: computed(() =&gt; props.size),</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    class=&quot;er-dropdown&quot;</span><br><span class="line">    :id=&quot;`dropdown-$&#123;useId().value&#125;`&quot;</span><br><span class="line">    :class=&quot;&#123; &#x27;is-disabled&#x27;: props.disabled &#125;&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;tooltip</span><br><span class="line">      ref=&quot;tooltipRef&quot;</span><br><span class="line">      v-bind=&quot;tooltipProps&quot;</span><br><span class="line">      :virtual-triggering=&quot;splitButton&quot;</span><br><span class="line">      :virtual-ref=&quot;triggerRef&quot;</span><br><span class="line">      @visible-change=&quot;$emit(&#x27;visible-change&#x27;, $event)&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;er-button-group</span><br><span class="line">        :type=&quot;type&quot;</span><br><span class="line">        :size=&quot;size&quot;</span><br><span class="line">        :disabled=&quot;disabled&quot;</span><br><span class="line">        v-if=&quot;splitButton&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;er-button @click=&quot;$emit(&#x27;click&#x27;, $event)&quot;&gt;</span><br><span class="line">          &lt;slot name=&quot;default&quot;&gt;&lt;/slot&gt;</span><br><span class="line">        &lt;/er-button&gt;</span><br><span class="line">        &lt;er-button ref=&quot;triggerRef&quot; icon=&quot;angle-down&quot; /&gt;</span><br><span class="line">      &lt;/er-button-group&gt;</span><br><span class="line">      &lt;slot v-else name=&quot;default&quot;&gt;&lt;/slot&gt;</span><br><span class="line"></span><br><span class="line">      &lt;template #content&gt;</span><br><span class="line">        &lt;ul class=&quot;er-dropdown__menu&quot;&gt;</span><br><span class="line">          &lt;slot name=&quot;dropdown&quot;&gt;</span><br><span class="line">            &lt;template</span><br><span class="line">              v-for=&quot;item in items&quot;</span><br><span class="line">              :key=&quot;item.command ?? useId().value&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              &lt;dropdown-item v-bind=&quot;item&quot; /&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">          &lt;/slot&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/tooltip&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line"></span><br><span class="line">:deep(.er-button-group) &#123;</span><br><span class="line">  &amp; &gt; :last-child &#123;</span><br><span class="line">    padding: 5px 7px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-DropdownItem-vue"><a href="#├─-DropdownItem-vue" class="headerlink" title="├─ DropdownItem.vue"></a>├─ DropdownItem.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; type DropdownItemProps &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; DROPDOWN_CTX_KEY &#125; from &quot;./constants&quot;;</span><br><span class="line">import &#123; useId &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line">import &#123; inject, computed &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErDropdownItem&quot;,</span><br><span class="line">&#125;);</span><br><span class="line">const props = withDefaults(defineProps&lt;DropdownItemProps&gt;(), &#123;</span><br><span class="line">  divided: false,</span><br><span class="line">  disabled: false,</span><br><span class="line">  command: useId().value,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const ctx = inject(DROPDOWN_CTX_KEY);</span><br><span class="line">const size = computed(() =&gt; ctx?.size.value);</span><br><span class="line"></span><br><span class="line">function handleClick() &#123;</span><br><span class="line">  if (props.disabled) return;</span><br><span class="line">  ctx?.handleItemClick(props);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;li v-if=&quot;divided&quot; role=&quot;separator&quot; class=&quot;divided-placeholder&quot;&gt;&lt;/li&gt;</span><br><span class="line">  &lt;li</span><br><span class="line">    :id=&quot;`dropdown-item-$&#123;command ?? useId().value&#125;`&quot;</span><br><span class="line">    :class=&quot;&#123;</span><br><span class="line">      &#x27;er-dropdown__item&#x27;: true,</span><br><span class="line">      [&#x27;er-dropdown__item--&#x27; + size]: size,</span><br><span class="line">      &#x27;is-disabled&#x27;: disabled,</span><br><span class="line">      &#x27;is-divided&#x27;: divided,</span><br><span class="line">    &#125;&quot;</span><br><span class="line">    @click=&quot;handleClick&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;slot&gt;</span><br><span class="line">      &#123;&#123; label &#125;&#125;</span><br><span class="line">    &lt;/slot&gt;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-index-ts-5"><a href="#├─-index-ts-5" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Dropdown</span> <span class="keyword">from</span> <span class="string">&quot;./Dropdown.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">DropdownItem</span> <span class="keyword">from</span> <span class="string">&quot;./DropdownItem.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErDropdown</span> = <span class="title function_">withInstall</span>(<span class="title class_">Dropdown</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErDropdownItem</span> = <span class="title function_">withInstall</span>(<span class="title class_">DropdownItem</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-3"><a href="#├─-style-css-3" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-dropdown</span> <span class="selector-class">.er-dropdown__menu</span> &#123;</span><br><span class="line">  <span class="attr">--er-dropdown-menuItem-hover-fill</span>: <span class="built_in">var</span>(--er-color-primary-light-<span class="number">9</span>);</span><br><span class="line">  <span class="attr">--er-dropdown-menuItem-hover-color</span>: <span class="built_in">var</span>(--er-color-primary);</span><br><span class="line">  <span class="attr">--er-dropdown-menuItem-disabled-color</span>: <span class="built_in">var</span>(--er-border-color-lighter);</span><br><span class="line">  <span class="attr">--er-dropdown-menuItem-divided-color</span>: <span class="built_in">var</span>(--er-border-color-lighter);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-dropdown</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="selector-class">.er-tooltip</span> &#123;</span><br><span class="line">    <span class="attr">--er-popover-padding</span>: <span class="number">5px</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-disabled</span>&gt;*&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-text-color-placeholder) <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: not-allowed <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-dropdown__menu</span> &#123;</span><br><span class="line">  <span class="attribute">list-style-type</span>: none;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="selector-class">.er-dropdown__item</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">22px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-font-size-base);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-text-color-regular);</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-dropdown-menuItem-hover-fill);</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-dropdown-menuItem-hover-color);</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.is-disabled</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-dropdown-menuItem-disabled-color);</span><br><span class="line">      <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">      <span class="attribute">background-image</span>: none;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.er-dropdown__item--large</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">7px</span> <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">22px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-dropdown__item--small</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.divided-placeholder</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">6px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-dropdown-menuItem-divided-color);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-4"><a href="#└─-types-ts-4" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">VNode</span>, <span class="title class_">ComputedRef</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">TooltipProps</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../Tooltip/types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ButtonType</span>, <span class="title class_">ButtonSize</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../Button/types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">DropdownCommand</span> = <span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">DropdownItemProps</span> &#123;</span><br><span class="line">  <span class="attr">command</span>?: <span class="title class_">DropdownCommand</span>;</span><br><span class="line">  <span class="attr">label</span>?: <span class="built_in">string</span> | <span class="title class_">VNode</span>;</span><br><span class="line">  <span class="attr">disabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">divided</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">DropdownProps</span> <span class="keyword">extends</span> <span class="title class_">TooltipProps</span> &#123;</span><br><span class="line">  <span class="attr">type</span>?: <span class="title class_">ButtonType</span>;</span><br><span class="line">  <span class="attr">size</span>?: <span class="title class_">ButtonSize</span>;</span><br><span class="line">  <span class="attr">items</span>?: <span class="title class_">DropdownItemProps</span>[];</span><br><span class="line">  <span class="attr">hideOnClick</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">splitButton</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">DropdownEmits</span> &#123;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;visible-change&quot;</span>, <span class="attr">value</span>: <span class="built_in">boolean</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;command&quot;</span>, <span class="attr">value</span>: <span class="title class_">DropdownCommand</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;click&quot;</span>, <span class="attr">value</span>: <span class="title class_">MouseEvent</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">DropdownInstance</span> &#123;</span><br><span class="line">  <span class="title function_">open</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">close</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">DropdownContext</span> &#123;</span><br><span class="line">  <span class="title function_">handleItemClick</span>(<span class="attr">item</span>: <span class="title class_">DropdownItemProps</span>): <span class="built_in">void</span>;</span><br><span class="line">  <span class="attr">size</span>: <span class="title class_">ComputedRef</span>&lt;<span class="title class_">ButtonSize</span> | <span class="built_in">void</span>&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Form"><a href="#├─-Form" class="headerlink" title="├─ Form"></a>├─ Form</h3><blockquote>
<p>表单，用于收集用户输入</p>
</blockquote>
<h4 id="–API–-5"><a href="#–API–-5" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-constants-ts-4"><a href="#├─-constants-ts-4" class="headerlink" title="├─ constants.ts"></a>├─ constants.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">InjectionKey</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">FormContext</span>, <span class="title class_">FormItemContext</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">FORM_CTX_KEY</span>: <span class="title class_">InjectionKey</span>&lt;<span class="title class_">FormContext</span>&gt; = <span class="title class_">Symbol</span>(<span class="string">&quot;formContext&quot;</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">FORM_ITEM_CTX_KEY</span>: <span class="title class_">InjectionKey</span>&lt;<span class="title class_">FormItemContext</span>&gt; =</span><br><span class="line">  <span class="title class_">Symbol</span>(<span class="string">&quot;formItemContext&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="├─-Form-vue"><a href="#├─-Form-vue" class="headerlink" title="├─ Form.vue"></a>├─ Form.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; provide, reactive, toRefs &#125; from &quot;vue&quot;;</span><br><span class="line">import type &#123;</span><br><span class="line">  FormProps,</span><br><span class="line">  FormEmits,</span><br><span class="line">  FormItemContext,</span><br><span class="line">  FormContext,</span><br><span class="line">  FormInstance,</span><br><span class="line">  FormValidateCallback,</span><br><span class="line">&#125; from &quot;./types&quot;;</span><br><span class="line">import type &#123; ValidateFieldsError &#125; from &quot;async-validator&quot;;</span><br><span class="line">import &#123; FORM_CTX_KEY &#125; from &quot;./constants&quot;;</span><br><span class="line">import &#123; each, filter, includes, size &#125; from &quot;lodash-es&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123; name: &quot;ErForm&quot; &#125;);</span><br><span class="line">const props = withDefaults(defineProps&lt;FormProps&gt;(), &#123;</span><br><span class="line">  showMessage: true,</span><br><span class="line">  hideRequiredAsterisk: false,</span><br><span class="line">  requiredAsteriskPosition: &quot;left&quot;,</span><br><span class="line">  labelPosition: &quot;right&quot;,</span><br><span class="line">&#125;);</span><br><span class="line">const emits = defineEmits&lt;FormEmits&gt;();</span><br><span class="line">const fields: FormItemContext[] = [];</span><br><span class="line"></span><br><span class="line">const addField: FormContext[&quot;addField&quot;] = function (field) &#123;</span><br><span class="line">  if (!field.prop) return;</span><br><span class="line">  fields.push(field);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const removeField: FormContext[&quot;removeField&quot;] = function (field) &#123;</span><br><span class="line">  if (!field.prop) return;</span><br><span class="line">  fields.splice(fields.indexOf(field), 1);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const validate: FormInstance[&quot;validate&quot;] = async function (</span><br><span class="line">  callback?: FormValidateCallback</span><br><span class="line">) &#123;</span><br><span class="line">  return validateField([], callback);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const validateField: FormInstance[&quot;validateField&quot;] = async function (</span><br><span class="line">  keys: string[] = [],</span><br><span class="line">  callback?: FormValidateCallback</span><br><span class="line">) &#123;</span><br><span class="line">  const filterArr = size(keys)</span><br><span class="line">    ? filter(fields, (field) =&gt; includes(keys, field.prop))</span><br><span class="line">    : fields;</span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line">    const result = await doValidateField(filterArr);</span><br><span class="line">    if (result === true) &#123;</span><br><span class="line">      callback?.(result);</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">  &#125; catch (e) &#123;</span><br><span class="line">    if (e instanceof Error) throw e;</span><br><span class="line">    const invalidFields = e as ValidateFieldsError;</span><br><span class="line"></span><br><span class="line">    callback?.(false, invalidFields);</span><br><span class="line">    return Promise.reject(invalidFields);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const resetFields: FormInstance[&quot;resetFields&quot;] = function (</span><br><span class="line">  keys: string[] = []</span><br><span class="line">) &#123;</span><br><span class="line">  each(filterFields(fields, keys), (field) =&gt; field.resetField());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const clearValidate: FormInstance[&quot;clearValidate&quot;] = function (</span><br><span class="line">  keys: string[] = []</span><br><span class="line">) &#123;</span><br><span class="line">  each(filterFields(fields, keys), (field) =&gt; field.clearValidate());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function filterFields(fields: FormItemContext[], props: string[]) &#123;</span><br><span class="line">  return size(props)</span><br><span class="line">    ? filter(fields, (field) =&gt; includes(props, field.prop))</span><br><span class="line">    : fields;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">async function doValidateField(fields: FormItemContext[] = []) &#123;</span><br><span class="line">  let validationErrors: ValidateFieldsError = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  for (const field of fields) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      await field.validate(&quot;&quot;);</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">      validationErrors = &#123;</span><br><span class="line">        ...validationErrors,</span><br><span class="line">        ...(e as ValidateFieldsError),</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  if (!size(Object.keys(validationErrors))) return true;</span><br><span class="line">  return Promise.reject(validationErrors);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const formCtx: FormContext = reactive(&#123;</span><br><span class="line">  ...toRefs(props),</span><br><span class="line">  emits,</span><br><span class="line">  addField,</span><br><span class="line">  removeField,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">provide&lt;FormContext&gt;(FORM_CTX_KEY, formCtx);</span><br><span class="line"></span><br><span class="line">defineExpose&lt;FormInstance&gt;(&#123;</span><br><span class="line">  validate,</span><br><span class="line">  validateField,</span><br><span class="line">  resetFields,</span><br><span class="line">  clearValidate,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;form class=&quot;er-form&quot;&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-FormItem-vue"><a href="#├─-FormItem-vue" class="headerlink" title="├─ FormItem.vue"></a>├─ FormItem.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123;</span><br><span class="line">  type Ref,</span><br><span class="line">  computed,</span><br><span class="line">  provide,</span><br><span class="line">  inject,</span><br><span class="line">  onMounted,</span><br><span class="line">  onUnmounted,</span><br><span class="line">  ref,</span><br><span class="line">  nextTick,</span><br><span class="line">  watch,</span><br><span class="line">  reactive,</span><br><span class="line">  watchEffect,</span><br><span class="line">  toRefs,</span><br><span class="line">  useSlots,</span><br><span class="line">&#125; from &quot;vue&quot;;</span><br><span class="line">import Schema, &#123; type RuleItem &#125; from &quot;async-validator&quot;;</span><br><span class="line">import type &#123;</span><br><span class="line">  FormItemContext,</span><br><span class="line">  FormItemProps,</span><br><span class="line">  FormValidateFailuer,</span><br><span class="line">  FormValidateCallback,</span><br><span class="line">  ValidateStatus,</span><br><span class="line">  FormItemInstance,</span><br><span class="line">  FormItemRule,</span><br><span class="line">&#125; from &quot;./types&quot;;</span><br><span class="line">import &#123;</span><br><span class="line">  isNil,</span><br><span class="line">  get,</span><br><span class="line">  size,</span><br><span class="line">  filter,</span><br><span class="line">  some,</span><br><span class="line">  isString,</span><br><span class="line">  isNumber,</span><br><span class="line">  endsWith,</span><br><span class="line">  keys,</span><br><span class="line">  includes,</span><br><span class="line">  map,</span><br><span class="line">  cloneDeep,</span><br><span class="line">  isArray,</span><br><span class="line">&#125; from &quot;lodash-es&quot;;</span><br><span class="line">import &#123; useId &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line">import &#123; FORM_CTX_KEY, FORM_ITEM_CTX_KEY &#125; from &quot;./constants&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123; name: &quot;ErFormItem&quot; &#125;);</span><br><span class="line">const props = withDefaults(defineProps&lt;FormItemProps&gt;(), &#123;</span><br><span class="line">  showMessage: true,</span><br><span class="line">  required: void 0,</span><br><span class="line">&#125;);</span><br><span class="line">const slots = useSlots();</span><br><span class="line">const ctx = inject(FORM_CTX_KEY);</span><br><span class="line"></span><br><span class="line">const labelId = useId().value;</span><br><span class="line"></span><br><span class="line">const validateStatus: Ref&lt;ValidateStatus&gt; = ref(&quot;init&quot;);</span><br><span class="line">const errMsg = ref(&quot;&quot;);</span><br><span class="line"></span><br><span class="line">const inputIds = ref&lt;string[]&gt;([]);</span><br><span class="line"></span><br><span class="line">const getValByProp = (target: Record&lt;string, any&gt; | void) =&gt; &#123;</span><br><span class="line">  if (target &amp;&amp; props.prop &amp;&amp; !isNil(get(target, props.prop))) &#123;</span><br><span class="line">    return get(target, props.prop);</span><br><span class="line">  &#125;</span><br><span class="line">  return null;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const hasLabel = computed(() =&gt; !!(props.label || slots.label));</span><br><span class="line">const labelFor = computed(</span><br><span class="line">  () =&gt; props.for || (inputIds.value.length ? inputIds.value[0] : &quot;&quot;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const currentLabel = computed(</span><br><span class="line">  () =&gt; `$&#123;props.label ?? &quot;&quot;&#125;$&#123;ctx?.labelSuffix ?? &quot;&quot;&#125;`</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const innerVal = computed(() =&gt; &#123;</span><br><span class="line">  const model = ctx?.model;</span><br><span class="line">  return getValByProp(model);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const itemRules = computed(() =&gt; &#123;</span><br><span class="line">  const &#123; required &#125; = props;</span><br><span class="line"></span><br><span class="line">  const rules: FormItemRule[] = [];</span><br><span class="line">  if (props.rules) &#123;</span><br><span class="line">    rules.push(...props.rules);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  const formRules = ctx?.rules;</span><br><span class="line">  if (formRules &amp;&amp; props.prop) &#123;</span><br><span class="line">    const _rules = getValByProp(formRules);</span><br><span class="line">    if (_rules) &#123;</span><br><span class="line">      rules.push(..._rules);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (!isNil(required)) &#123;</span><br><span class="line">    const requiredRules = filter(</span><br><span class="line">      map(rules, (rule, i) =&gt; [rule, i]),</span><br><span class="line">      (item: [FormItemRule, number]) =&gt; includes(keys(item[0]), &quot;required&quot;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    if (size(requiredRules)) &#123;</span><br><span class="line">      for (const item of requiredRules) &#123;</span><br><span class="line">        const [rule, i] = item as [FormItemRule, number];</span><br><span class="line">        if (rule.required === required) continue;</span><br><span class="line">        rules[i] = &#123; ...rule, required &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      rules.push(&#123; required &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return rules;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const validateEnabled = computed(() =&gt; size(itemRules.value) &gt; 0);</span><br><span class="line">const isRequired = computed(</span><br><span class="line">  () =&gt;</span><br><span class="line">    !ctx?.hideRequiredAsterisk &amp;&amp;</span><br><span class="line">    (some(itemRules.value, &quot;required&quot;) || props?.required)</span><br><span class="line">);</span><br><span class="line">const isDisabled = computed(() =&gt; ctx?.disabled || props?.disabled);</span><br><span class="line">const propString = computed(() =&gt; &#123;</span><br><span class="line">  if (!props.prop) return &quot;&quot;;</span><br><span class="line">  return isString(props.prop) ? props.prop : props.prop.join(&quot;.&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const normalizeLabelWidth = computed(() =&gt; &#123;</span><br><span class="line">  const _normalizeStyle = (val: number | string) =&gt; &#123;</span><br><span class="line">    if (isNumber(val)) return `$&#123;val&#125;px`;</span><br><span class="line">    return endsWith(val, &quot;px&quot;) ? val : `$&#123;val&#125;px`;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  if (props.labelWidth) return _normalizeStyle(props.labelWidth);</span><br><span class="line">  if (ctx?.labelWidth) return _normalizeStyle(ctx.labelWidth);</span><br><span class="line">  return &quot;150px&quot;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">let initialVal: any = null;</span><br><span class="line">let isResetting = false;</span><br><span class="line"></span><br><span class="line">function getTriggeredRules(trigger?: string) &#123;</span><br><span class="line">  const rules = itemRules.value;</span><br><span class="line">  if (rules) &#123;</span><br><span class="line">    return filter(rules, (r) =&gt; &#123;</span><br><span class="line">      if (!r.trigger || !trigger) return true;</span><br><span class="line">      if (isArray(r.trigger)) &#123;</span><br><span class="line">        return r.trigger.includes(trigger);</span><br><span class="line">      &#125;</span><br><span class="line">      return r.trigger === trigger;</span><br><span class="line">    &#125;).map((&#123; trigger, ...rule &#125;) =&gt; rule as RuleItem);</span><br><span class="line">  &#125;</span><br><span class="line">  return [];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">async function doValidate(rules: any[]) &#123;</span><br><span class="line">  const modelName = propString.value;</span><br><span class="line">  const validator = new Schema(&#123; [modelName]: rules &#125;);</span><br><span class="line">  return validator</span><br><span class="line">    .validate(&#123; [modelName]: innerVal.value &#125;, &#123; firstFields: true &#125;)</span><br><span class="line">    .then(() =&gt; &#123;</span><br><span class="line">      validateStatus.value = &quot;success&quot;;</span><br><span class="line">      ctx?.emits(&quot;validate&quot;, props, true, &quot;&quot;);</span><br><span class="line">      return true;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch((err: FormValidateFailuer) =&gt; &#123;</span><br><span class="line">      const &#123; errors &#125; = err;</span><br><span class="line">      validateStatus.value = &quot;error&quot;;</span><br><span class="line">      errMsg.value = errors &amp;&amp; size(errors) &gt; 0 ? errors[0].message ?? &quot;&quot; : &quot;&quot;;</span><br><span class="line">      ctx?.emits(&quot;validate&quot;, props, false, errMsg.value);</span><br><span class="line">      return Promise.reject(err);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const validate: FormItemInstance[&quot;validate&quot;] = async function (</span><br><span class="line">  trigger: string,</span><br><span class="line">  callback?: FormValidateCallback</span><br><span class="line">) &#123;</span><br><span class="line">  if (isResetting || !props.prop || isDisabled.value) return false;</span><br><span class="line"></span><br><span class="line">  if (!validateEnabled.value) &#123;</span><br><span class="line">    callback?.(false);</span><br><span class="line">    return false;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  const rules = getTriggeredRules(trigger);</span><br><span class="line">  if (!size(rules)) &#123;</span><br><span class="line">    callback?.(true);</span><br><span class="line">    return true;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  validateStatus.value = &quot;validating&quot;;</span><br><span class="line"></span><br><span class="line">  return doValidate(rules)</span><br><span class="line">    .then(() =&gt; &#123;</span><br><span class="line">      callback?.(true);</span><br><span class="line">      return true;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch((err: FormValidateFailuer) =&gt; &#123;</span><br><span class="line">      const &#123; fields &#125; = err;</span><br><span class="line">      callback?.(false, fields);</span><br><span class="line">      return Promise.reject(fields);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">const resetField: FormItemInstance[&quot;resetField&quot;] = function () &#123;</span><br><span class="line">  const model = ctx?.model;</span><br><span class="line">  if (model &amp;&amp; propString.value &amp;&amp; !isNil(get(model, propString.value))) &#123;</span><br><span class="line">    isResetting = true;</span><br><span class="line">    model[propString.value] = cloneDeep(initialVal);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  nextTick(() =&gt; clearValidate());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const clearValidate: FormItemInstance[&quot;clearValidate&quot;] = function () &#123;</span><br><span class="line">  validateStatus.value = &quot;init&quot;;</span><br><span class="line">  errMsg.value = &quot;&quot;;</span><br><span class="line">  isResetting = false;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const addInputId: FormItemContext[&quot;addInputId&quot;] = function (id) &#123;</span><br><span class="line">  if (!includes(inputIds.value, id)) inputIds.value.push(id);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const removeInputId: FormItemContext[&quot;removeInputId&quot;] = function (id) &#123;</span><br><span class="line">  inputIds.value = filter(inputIds.value, (i) =&gt; i != id);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const formItemCtx: FormItemContext = reactive(&#123;</span><br><span class="line">  ...toRefs(props),</span><br><span class="line">  disabled: isDisabled.value,</span><br><span class="line">  validate,</span><br><span class="line">  resetField,</span><br><span class="line">  clearValidate,</span><br><span class="line">  addInputId,</span><br><span class="line">  removeInputId,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  if (props.prop) &#123;</span><br><span class="line">    ctx?.addField(formItemCtx);</span><br><span class="line">    initialVal = innerVal.value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">onUnmounted(() =&gt; &#123;</span><br><span class="line">  if (props.prop) &#123;</span><br><span class="line">    ctx?.removeField(formItemCtx);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">watchEffect(() =&gt; (formItemCtx.disabled = isDisabled.value));</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  () =&gt; props.error,</span><br><span class="line">  (val) =&gt; &#123;</span><br><span class="line">    errMsg.value = val || &quot;&quot;;</span><br><span class="line">    validateStatus.value = val ? &quot;error&quot; : &quot;init&quot;;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; immediate: true &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">provide&lt;FormItemContext&gt;(FORM_ITEM_CTX_KEY, formItemCtx);</span><br><span class="line"></span><br><span class="line">defineExpose&lt;FormItemInstance&gt;(&#123;</span><br><span class="line">  validateMessage: errMsg,</span><br><span class="line">  validateStatus,</span><br><span class="line">  validate,</span><br><span class="line">  resetField,</span><br><span class="line">  clearValidate,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    class=&quot;er-form-item&quot;</span><br><span class="line">    :class=&quot;&#123;</span><br><span class="line">      &#x27;is-error&#x27;: validateStatus === &#x27;error&#x27;,</span><br><span class="line">      &#x27;is-disabled&#x27;: isDisabled,</span><br><span class="line">      &#x27;is-required&#x27;: isRequired,</span><br><span class="line">      &#x27;asterisk-left&#x27;: ctx?.requiredAsteriskPosition === &#x27;left&#x27;,</span><br><span class="line">      &#x27;asterisk-right&#x27;: ctx?.requiredAsteriskPosition === &#x27;right&#x27;,</span><br><span class="line">    &#125;&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;component</span><br><span class="line">      v-if=&quot;hasLabel&quot;</span><br><span class="line">      class=&quot;er-form-item__label&quot;</span><br><span class="line">      :class=&quot;`position-$&#123;ctx?.labelPosition ?? &#x27;right&#x27;&#125;`&quot;</span><br><span class="line">      :is=&quot;labelFor ? &#x27;label&#x27; : &#x27;div&#x27;&quot;</span><br><span class="line">      :id=&quot;labelId&quot;</span><br><span class="line">      :for=&quot;labelFor&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;slot name=&quot;label&quot; :label=&quot;currentLabel&quot;&gt;</span><br><span class="line">        &#123;&#123; currentLabel &#125;&#125;</span><br><span class="line">      &lt;/slot&gt;</span><br><span class="line">    &lt;/component&gt;</span><br><span class="line">    &lt;div class=&quot;er-form-item__content&quot;&gt;</span><br><span class="line">      &lt;slot :validate=&quot;validate&quot;&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;div class=&quot;er-form-item__error-msg&quot; v-if=&quot;validateStatus === &#x27;error&#x27;&quot;&gt;</span><br><span class="line">        &lt;template v-if=&quot;ctx?.showMessage &amp;&amp; showMessage&quot;&gt;</span><br><span class="line">          &lt;slot name=&quot;error&quot; :error=&quot;errMsg&quot;&gt;&#123;&#123; errMsg &#125;&#125;&lt;/slot&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line"></span><br><span class="line">.er-form-item &#123;</span><br><span class="line">  --er-form-label-width: v-bind(normalizeLabelWidth) !important;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-hooks-ts-1"><a href="#├─-hooks-ts-1" class="headerlink" title="├─ hooks.ts"></a>├─ hooks.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  computed,</span><br><span class="line">  inject,</span><br><span class="line">  unref,</span><br><span class="line">  ref,</span><br><span class="line">  <span class="keyword">type</span> <span class="title class_">MaybeRef</span>,</span><br><span class="line">  <span class="keyword">type</span> <span class="title class_">WatchStopHandle</span>,</span><br><span class="line">  onMounted,</span><br><span class="line">  watch,</span><br><span class="line">  toRef,</span><br><span class="line">  onUnmounted,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">FormItemContext</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">FORM_CTX_KEY</span>, <span class="variable constant_">FORM_ITEM_CTX_KEY</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./constants&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useProp, useId &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/hooks&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useFormItem</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> form = <span class="title function_">inject</span>(<span class="variable constant_">FORM_CTX_KEY</span>, <span class="built_in">void</span> <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> formItem = <span class="title function_">inject</span>(<span class="variable constant_">FORM_ITEM_CTX_KEY</span>, <span class="built_in">void</span> <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> &#123; form, formItem &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useFormDisabled</span>(<span class="params"><span class="attr">fallback</span>?: <span class="title class_">MaybeRef</span>&lt;<span class="built_in">boolean</span> | <span class="built_in">void</span>&gt;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> disabled = useProp&lt;<span class="built_in">boolean</span>&gt;(<span class="string">&quot;disabled&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> form = <span class="title function_">inject</span>(<span class="variable constant_">FORM_CTX_KEY</span>, <span class="built_in">void</span> <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> formItem = <span class="title function_">inject</span>(<span class="variable constant_">FORM_ITEM_CTX_KEY</span>, <span class="built_in">void</span> <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">computed</span>(</span><br><span class="line">    <span class="function">() =&gt;</span></span><br><span class="line">      disabled.<span class="property">value</span> ||</span><br><span class="line">      <span class="title function_">unref</span>(fallback) ||</span><br><span class="line">      form?.<span class="property">disabled</span> ||</span><br><span class="line">      formItem?.<span class="property">disabled</span> ||</span><br><span class="line">      <span class="literal">false</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">UseFormItemInputCommonProps</span> <span class="keyword">extends</span> <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt; &#123;</span><br><span class="line">  <span class="attr">id</span>?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useFormItemInputId</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">props</span>: <span class="title class_">UseFormItemInputCommonProps</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">formItemContext</span>?: <span class="title class_">FormItemContext</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> inputId = ref&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">unwatch</span>: <span class="title class_">WatchStopHandle</span> | <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    unwatch = <span class="title function_">watch</span>(</span><br><span class="line">      <span class="title function_">toRef</span>(<span class="function">() =&gt;</span> props.<span class="property">id</span>),</span><br><span class="line">      <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> newId = id ?? <span class="title function_">useId</span>().<span class="property">value</span>;</span><br><span class="line">        <span class="keyword">if</span> (newId !== inputId.<span class="property">value</span>) &#123;</span><br><span class="line">          inputId.<span class="property">value</span> &amp;&amp; formItemContext?.<span class="title function_">removeInputId</span>(inputId.<span class="property">value</span>);</span><br><span class="line">          formItemContext?.<span class="title function_">addInputId</span>(newId);</span><br><span class="line">          inputId.<span class="property">value</span> = newId;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; <span class="attr">immediate</span>: <span class="literal">true</span> &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    unwatch &amp;&amp; <span class="title function_">unwatch</span>();</span><br><span class="line">    inputId.<span class="property">value</span> &amp;&amp; formItemContext?.<span class="title function_">removeInputId</span>(inputId.<span class="property">value</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    inputId,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="├─-index-ts-6"><a href="#├─-index-ts-6" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Form</span> <span class="keyword">from</span> <span class="string">&quot;./Form.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">FormItem</span> <span class="keyword">from</span> <span class="string">&quot;./FormItem.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErForm</span> = <span class="title function_">withInstall</span>(<span class="title class_">Form</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErFormItem</span> = <span class="title function_">withInstall</span>(<span class="title class_">FormItem</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./hooks&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-4"><a href="#├─-style-css-4" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-form-item</span> &#123;</span><br><span class="line">  <span class="attr">--er-form-label-width</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attr">--er-form-label-font-size</span>: <span class="built_in">var</span>(--er-font-size-base);</span><br><span class="line">  <span class="attr">--er-form-content-font-size</span>: <span class="built_in">var</span>(--er-font-size-base);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-form-item</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">18px</span>;</span><br><span class="line">  &amp;<span class="selector-pseudo">:has</span>(&gt; <span class="selector-class">.position-top</span>)&#123;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.er-form-item__label</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">32px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">32px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="built_in">var</span>(--er-form-label-width);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">display</span>: inline-flex;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-form-label-font-size);    </span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-text-color-regular);</span><br><span class="line">    &amp;<span class="selector-class">.position-right</span> &#123;</span><br><span class="line">      <span class="attribute">padding-left</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">justify-content</span>: flex-end;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.position-left</span> &#123;</span><br><span class="line">      <span class="attribute">padding-right</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">justify-content</span>: flex-start;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.position-top</span> &#123;</span><br><span class="line">      <span class="attribute">padding-bottom</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">justify-content</span>: flex-start;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.er-form-item__content</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">32px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-form-content-font-size);</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.er-form-item__error-msg</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-color-danger);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.is-error</span> &#123;</span><br><span class="line">    :<span class="built_in">deep</span>(.er-input__wrapper)&#123;</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--er-color-danger) inset;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.is-required</span><span class="selector-class">.asterisk-right</span> &gt; <span class="selector-class">.er-form-item__label</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-color-danger);</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">4px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.is-required</span><span class="selector-class">.asterisk-left</span> &gt; <span class="selector-class">.er-form-item__label</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-color-danger);</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">4px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.is-disabled</span> &gt; <span class="selector-class">.er-form-item__label</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-disabled-text-color);</span><br><span class="line">    <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">    &amp;<span class="selector-pseudo">::before</span>,&amp;<span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">      <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.is-disabled</span> &gt; <span class="selector-class">.er-form-item__content</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-disabled-text-color);</span><br><span class="line">    <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-5"><a href="#└─-types-ts-5" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123;</span><br><span class="line">  <span class="title class_">RuleItem</span>,</span><br><span class="line">  <span class="title class_">ValidateError</span>,</span><br><span class="line">  <span class="title class_">ValidateFieldsError</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;async-validator&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormItemRule</span> <span class="keyword">extends</span> <span class="title class_">RuleItem</span> &#123;</span><br><span class="line">  <span class="attr">trigger</span>?: <span class="built_in">string</span> | <span class="built_in">string</span>[];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">FormRules</span> = <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="title class_">FormItemRule</span>[]&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">FormValidateResult</span> = <span class="title class_">Promise</span>&lt;<span class="built_in">boolean</span>&gt;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">FormValidateCallback</span> = <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="attr">isValid</span>: <span class="built_in">boolean</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="attr">invalidFields</span>?: <span class="title class_">ValidateFieldsError</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">ValidateStatus</span> = <span class="string">&quot;success&quot;</span> | <span class="string">&quot;error&quot;</span> | <span class="string">&quot;init&quot;</span> | <span class="string">&quot;validating&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormValidateFailuer</span> &#123;</span><br><span class="line">  <span class="attr">errors</span>?: <span class="title class_">ValidateError</span>[];</span><br><span class="line">  <span class="attr">fields</span>: <span class="title class_">ValidateFieldsError</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormProps</span> &#123;</span><br><span class="line">  <span class="attr">model</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;;</span><br><span class="line">  <span class="attr">rules</span>?: <span class="title class_">FormRules</span>;</span><br><span class="line">  <span class="attr">disabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">labelWidth</span>?: <span class="built_in">number</span> | <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">labelPosition</span>?: <span class="string">&quot;left&quot;</span> | <span class="string">&quot;right&quot;</span> | <span class="string">&quot;top&quot;</span>;</span><br><span class="line">  <span class="attr">labelSuffix</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">showMessage</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">hideRequiredAsterisk</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">requiredAsteriskPosition</span>?: <span class="string">&quot;left&quot;</span> | <span class="string">&quot;right&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormEmits</span> &#123;</span><br><span class="line">  (</span><br><span class="line">    <span class="attr">event</span>: <span class="string">&quot;validate&quot;</span>,</span><br><span class="line">    <span class="attr">prop</span>: <span class="title class_">FormItemProps</span>,</span><br><span class="line">    <span class="attr">isValid</span>: <span class="built_in">boolean</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="built_in">string</span></span><br><span class="line">  ): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormItemProps</span> &#123;</span><br><span class="line">  <span class="attr">prop</span>?: <span class="built_in">string</span> | <span class="built_in">string</span>[];</span><br><span class="line">  <span class="attr">label</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">for</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">labelWidth</span>?: <span class="built_in">number</span> | <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">disabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">required</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">showMessage</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">error</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">rules</span>?: <span class="title class_">FormItemRule</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormInstance</span> &#123;</span><br><span class="line">  <span class="title function_">validate</span>(<span class="attr">callback</span>?: <span class="title class_">FormValidateCallback</span>): <span class="title class_">FormValidateResult</span>;</span><br><span class="line">  <span class="title function_">validateField</span>(</span><br><span class="line">    <span class="attr">keys</span>?: <span class="built_in">string</span>[],</span><br><span class="line">    <span class="attr">callback</span>?: <span class="title class_">FormValidateCallback</span></span><br><span class="line">  ): <span class="title class_">FormValidateResult</span>;</span><br><span class="line">  <span class="title function_">resetFields</span>(<span class="attr">keys</span>?: <span class="built_in">string</span>[]): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">clearValidate</span>(<span class="attr">keys</span>?: <span class="built_in">string</span>[]): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormItemInstance</span> &#123;</span><br><span class="line">  <span class="attr">validateStatus</span>: <span class="title class_">Ref</span>&lt;<span class="title class_">ValidateStatus</span>&gt;;</span><br><span class="line">  <span class="attr">validateMessage</span>: <span class="title class_">Ref</span>&lt;<span class="built_in">string</span>&gt;;</span><br><span class="line">  <span class="title function_">validate</span>(</span><br><span class="line">    <span class="attr">trigger</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">callback</span>?: <span class="title class_">FormValidateCallback</span></span><br><span class="line">  ): <span class="title class_">FormValidateResult</span>;</span><br><span class="line">  <span class="title function_">resetField</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">clearValidate</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormContext</span> <span class="keyword">extends</span> <span class="title class_">FormProps</span> &#123;</span><br><span class="line">  <span class="attr">emits</span>: <span class="title class_">FormEmits</span>;</span><br><span class="line">  <span class="title function_">addField</span>(<span class="attr">field</span>: <span class="title class_">FormItemContext</span>): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">removeField</span>(<span class="attr">field</span>: <span class="title class_">FormItemContext</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">FormItemContext</span> <span class="keyword">extends</span> <span class="title class_">FormItemProps</span> &#123;</span><br><span class="line">  <span class="title function_">validate</span>(</span><br><span class="line">    <span class="attr">trigger</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">callback</span>?: <span class="title class_">FormValidateCallback</span></span><br><span class="line">  ): <span class="title class_">FormValidateResult</span>;</span><br><span class="line">  <span class="title function_">resetField</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">clearValidate</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">addInputId</span>(<span class="attr">id</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">removeInputId</span>(<span class="attr">id</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Icon"><a href="#├─-Icon" class="headerlink" title="├─ Icon"></a>├─ Icon</h3><blockquote>
<p>图标组件</p>
</blockquote>
<h4 id="├─-Icon-vue"><a href="#├─-Icon-vue" class="headerlink" title="├─ Icon.vue"></a>├─ Icon.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; type IconProps &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; FontAwesomeIcon &#125; from &quot;@fortawesome/vue-fontawesome&quot;;</span><br><span class="line">import &#123; omit &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import &#123; computed &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErIcon&quot;,</span><br><span class="line">  inheritAttrs: false,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const props = defineProps&lt;IconProps&gt;();</span><br><span class="line"></span><br><span class="line">const filterProps = computed(() =&gt; omit(props, [&quot;type&quot;, &quot;color&quot;]));</span><br><span class="line">const customStyles = computed(() =&gt; (&#123; color: props.color ?? void 0 &#125;));</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;i</span><br><span class="line">    class=&quot;er-icon&quot;</span><br><span class="line">    :class=&quot;&#123; [`er-icon--$&#123;type&#125;`]: type &#125;&quot;</span><br><span class="line">    :style=&quot;customStyles&quot;</span><br><span class="line">    v-bind=&quot;$attrs&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;font-awesome-icon v-bind=&quot;filterProps&quot; /&gt;</span><br><span class="line">  &lt;/i&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-index-ts-7"><a href="#├─-index-ts-7" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Icon</span> <span class="keyword">from</span> <span class="string">&quot;./Icon.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErIcon</span> = <span class="title function_">withInstall</span>(<span class="title class_">Icon</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-5"><a href="#├─-style-css-5" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-icon</span> &#123;</span><br><span class="line">  <span class="attr">--er-icon-color</span>: inherit;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">fill</span>: currentColor;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--er-icon-color);</span><br><span class="line">  <span class="attribute">font-size</span>: inherit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@each</span> $val in primary, info, success, warning, danger &#123;</span><br><span class="line">  <span class="selector-class">.er-icon--</span>$(val) &#123;</span><br><span class="line">    <span class="attr">--er-icon-color</span>: <span class="built_in">var</span>(--er-color-$(val));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-6"><a href="#└─-types-ts-6" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">IconDefinition</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@fortawesome/fontawesome-svg-core&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IconProps</span> &#123;</span><br><span class="line">  <span class="attr">border</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">fixedWidth</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">flip</span>?: <span class="string">&quot;horizontal&quot;</span> | <span class="string">&quot;vertical&quot;</span> | <span class="string">&quot;both&quot;</span>;</span><br><span class="line">  <span class="attr">icon</span>: <span class="built_in">object</span> | <span class="title class_">Array</span>&lt;<span class="built_in">string</span>&gt; | <span class="built_in">string</span> | <span class="title class_">IconDefinition</span>;</span><br><span class="line">  <span class="attr">mask</span>?: <span class="built_in">object</span> | <span class="title class_">Array</span>&lt;<span class="built_in">string</span>&gt; | <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">listItem</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">pull</span>?: <span class="string">&quot;right&quot;</span> | <span class="string">&quot;left&quot;</span>;</span><br><span class="line">  <span class="attr">pulse</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">rotation</span>?: <span class="number">90</span> | <span class="number">180</span> | <span class="number">270</span> | <span class="string">&quot;90&quot;</span> | <span class="string">&quot;180&quot;</span> | <span class="string">&quot;270&quot;</span>;</span><br><span class="line">  <span class="attr">swapOpacity</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">size</span>?:</span><br><span class="line">    | <span class="string">&quot;2xs&quot;</span></span><br><span class="line">    | <span class="string">&quot;xs&quot;</span></span><br><span class="line">    | <span class="string">&quot;sm&quot;</span></span><br><span class="line">    | <span class="string">&quot;lg&quot;</span></span><br><span class="line">    | <span class="string">&quot;xl&quot;</span></span><br><span class="line">    | <span class="string">&quot;2xl&quot;</span></span><br><span class="line">    | <span class="string">&quot;1x&quot;</span></span><br><span class="line">    | <span class="string">&quot;2x&quot;</span></span><br><span class="line">    | <span class="string">&quot;3x&quot;</span></span><br><span class="line">    | <span class="string">&quot;4x&quot;</span></span><br><span class="line">    | <span class="string">&quot;5x&quot;</span></span><br><span class="line">    | <span class="string">&quot;6x&quot;</span></span><br><span class="line">    | <span class="string">&quot;7x&quot;</span></span><br><span class="line">    | <span class="string">&quot;8x&quot;</span></span><br><span class="line">    | <span class="string">&quot;9x&quot;</span></span><br><span class="line">    | <span class="string">&quot;10x&quot;</span>;</span><br><span class="line">  <span class="attr">spin</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">transform</span>?: <span class="built_in">object</span> | <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">symbol</span>?: <span class="built_in">boolean</span> | <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">title</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">inverse</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">bounce</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">shake</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">beat</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">fade</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">beatFade</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">spinPulse</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">spinReverse</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">type</span>?: <span class="string">&quot;primary&quot;</span> | <span class="string">&quot;success&quot;</span> | <span class="string">&quot;warning&quot;</span> | <span class="string">&quot;danger&quot;</span> | <span class="string">&quot;info&quot;</span>;</span><br><span class="line">  <span class="attr">color</span>?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Input"><a href="#├─-Input" class="headerlink" title="├─ Input"></a>├─ Input</h3><blockquote>
<p>输入框组件, 接收用户输入</p>
</blockquote>
<h4 id="–API–-6"><a href="#–API–-6" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-index-ts-8"><a href="#├─-index-ts-8" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Input</span> <span class="keyword">from</span> <span class="string">&quot;./Input.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErInput</span> = <span class="title function_">withInstall</span>(<span class="title class_">Input</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>



<h4 id="├─-Input-test-tsx"><a href="#├─-Input-test-tsx" class="headerlink" title="├─ Input.test.tsx"></a>├─ Input.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, expect, test &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&quot;@vue/test-utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Input</span> <span class="keyword">from</span> <span class="string">&quot;./Input.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Input.vue&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;render&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Input</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">        <span class="attr">size</span>: <span class="string">&quot;small&quot;</span>,</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">prepend</span>: <span class="string">&quot;prepend&quot;</span>,</span><br><span class="line">        <span class="attr">prefix</span>: <span class="string">&quot;prefix&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 针对动态 class 的测试</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;er-input&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;er-input--small&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;er-input--text&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;is-prefix&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&quot;is-prepend&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 正确的标签和节点</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;input&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">get</span>(<span class="string">&quot;input&quot;</span>).<span class="title function_">attributes</span>(<span class="string">&quot;type&quot;</span>)).<span class="title function_">toBe</span>(<span class="string">&quot;text&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 针对 slots 的测试</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-input__prepend&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">get</span>(<span class="string">&quot;.er-input__prepend&quot;</span>).<span class="title function_">text</span>()).<span class="title function_">toBe</span>(<span class="string">&quot;prepend&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-input__prefix&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">get</span>(<span class="string">&quot;.er-input__prefix&quot;</span>).<span class="title function_">text</span>()).<span class="title function_">toBe</span>(<span class="string">&quot;prefix&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 针对 v-if 的测试</span></span><br><span class="line">    <span class="keyword">const</span> wrapper2 = <span class="title function_">mount</span>(<span class="title class_">Input</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;textarea&quot;</span>,</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper2.<span class="title function_">find</span>(<span class="string">&quot;textarea&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;v-model&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">wrapper</span>: <span class="built_in">any</span> = <span class="title function_">mount</span>(<span class="title class_">Input</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">        <span class="string">&quot;onUpdate:modelValue&quot;</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> wrapper.<span class="title function_">setProps</span>(&#123; <span class="attr">modelValue</span>: e &#125;),</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">const</span> input = wrapper.<span class="title function_">get</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始值</span></span><br><span class="line">    <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">value</span>).<span class="title function_">toBe</span>(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新值</span></span><br><span class="line">    <span class="comment">// setValue 会触发 input 和 change 事件</span></span><br><span class="line">    <span class="keyword">await</span> input.<span class="title function_">setValue</span>(<span class="string">&quot;test2&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">props</span>(<span class="string">&quot;modelValue&quot;</span>)).<span class="title function_">toBe</span>(<span class="string">&quot;test2&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">value</span>).<span class="title function_">toBe</span>(<span class="string">&quot;test2&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&quot;change&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> inputEvent = wrapper.<span class="title function_">emitted</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> changeEvent = wrapper.<span class="title function_">emitted</span>(<span class="string">&quot;change&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(inputEvent![<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="string">&quot;test2&quot;</span>]);</span><br><span class="line">    <span class="title function_">expect</span>(changeEvent![<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="string">&quot;test2&quot;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// v-model 异步更新</span></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">setProps</span>(&#123; <span class="attr">modelValue</span>: <span class="string">&quot;test3&quot;</span> &#125;);</span><br><span class="line">    <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">value</span>).<span class="title function_">toBe</span>(<span class="string">&quot;test3&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;clearable&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Input</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">        <span class="attr">clearable</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">global</span>: &#123;</span><br><span class="line">        <span class="attr">stubs</span>: [<span class="string">&quot;Icon&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 不应该出现 Icon 区域</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-input__clear&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> input = wrapper.<span class="title function_">get</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> input.<span class="title function_">trigger</span>(<span class="string">&quot;focus&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&quot;focus&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 出现 Icon 区域</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-input__clear&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点击 Icon 区域，触发 clear 事件</span></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">get</span>(<span class="string">&quot;.er-input__clear&quot;</span>).<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&quot;clear&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&quot;change&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> inputEvent = wrapper.<span class="title function_">emitted</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> changeEvent = wrapper.<span class="title function_">emitted</span>(<span class="string">&quot;change&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(inputEvent![<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="string">&quot;&quot;</span>]);</span><br><span class="line">    <span class="title function_">expect</span>(changeEvent![<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="string">&quot;&quot;</span>]);</span><br><span class="line">    <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">value</span>).<span class="title function_">toBe</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> input.<span class="title function_">trigger</span>(<span class="string">&quot;blur&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="title function_">toHaveProperty</span>(<span class="string">&quot;blur&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;toggle password&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Input</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;password&quot;</span>,</span><br><span class="line">        <span class="attr">showPassword</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">global</span>: &#123;</span><br><span class="line">        <span class="attr">stubs</span>: [<span class="string">&quot;Icon&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 不应该出现 Icon 区域</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-input__password&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">    <span class="keyword">const</span> input = wrapper.<span class="title function_">get</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">type</span>).<span class="title function_">toBe</span>(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> input.<span class="title function_">setValue</span>(<span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> eyeIcon = wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-input__password&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(eyeIcon.<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(eyeIcon.<span class="title function_">attributes</span>(<span class="string">&quot;icon&quot;</span>)).<span class="title function_">toBe</span>(<span class="string">&quot;eye-slash&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点击 切换</span></span><br><span class="line">    <span class="keyword">await</span> eyeIcon.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(input.<span class="property">element</span>.<span class="property">type</span>).<span class="title function_">toBe</span>(<span class="string">&quot;text&quot;</span>);</span><br><span class="line">    <span class="comment">// 缓存 Icon</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-input__password&quot;</span>).<span class="title function_">attributes</span>(<span class="string">&quot;icon&quot;</span>)).<span class="title function_">toBe</span>(<span class="string">&quot;eye&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h4 id="├─-Input-vue"><a href="#├─-Input-vue" class="headerlink" title="├─ Input.vue"></a>├─ Input.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; computed, ref, watch, useAttrs, shallowRef, nextTick &#125; from &quot;vue&quot;;</span><br><span class="line">import type &#123; InputProps, InputEmits, InputInstance &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; useFormItem, useFormDisabled, useFormItemInputId &#125; from &quot;../Form&quot;;</span><br><span class="line">import &#123; debugWarn &#125; from &quot;@eric-ui/utils&quot;;</span><br><span class="line">import &#123; useFocusController &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line">import &#123; each, noop &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import Icon from &quot;../Icon/Icon.vue&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErInput&quot;,</span><br><span class="line">  inheritAttrs: false,</span><br><span class="line">&#125;);</span><br><span class="line">const props = withDefaults(defineProps&lt;InputProps&gt;(), &#123;</span><br><span class="line">  type: &quot;text&quot;,</span><br><span class="line">  autocomplete: &quot;off&quot;,</span><br><span class="line">&#125;);</span><br><span class="line">const emits = defineEmits&lt;InputEmits&gt;();</span><br><span class="line"></span><br><span class="line">const innerValue = ref(props.modelValue);</span><br><span class="line">const passwordVisible = ref(false);</span><br><span class="line"></span><br><span class="line">const inputRef = shallowRef&lt;HTMLInputElement&gt;();</span><br><span class="line">const textareaRef = shallowRef&lt;HTMLTextAreaElement&gt;();</span><br><span class="line"></span><br><span class="line">const showClear = computed(</span><br><span class="line">  () =&gt;</span><br><span class="line">    props.clearable &amp;&amp;</span><br><span class="line">    !!innerValue.value &amp;&amp;</span><br><span class="line">    !isDisabled.value &amp;&amp;</span><br><span class="line">    isFocused.value</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const showPasswordArea = computed(</span><br><span class="line">  () =&gt;</span><br><span class="line">    props.type === &quot;password&quot; &amp;&amp;</span><br><span class="line">    props.showPassword &amp;&amp;</span><br><span class="line">    !isDisabled.value &amp;&amp;</span><br><span class="line">    !!innerValue.value</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const _ref = computed(() =&gt; inputRef.value || textareaRef.value);</span><br><span class="line"></span><br><span class="line">const attrs = useAttrs();</span><br><span class="line">const isDisabled = useFormDisabled();</span><br><span class="line">const &#123; formItem &#125; = useFormItem();</span><br><span class="line">const &#123; inputId &#125; = useFormItemInputId(props, formItem);</span><br><span class="line">const &#123; wrapperRef, isFocused, handleFocus, handleBlur &#125; = useFocusController(</span><br><span class="line">  _ref,</span><br><span class="line">  &#123;</span><br><span class="line">    afterBlur() &#123;</span><br><span class="line">      formItem?.validate(&quot;blur&quot;).catch((err) =&gt; debugWarn(err));</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const clear: InputInstance[&quot;clear&quot;] = function () &#123;</span><br><span class="line">  innerValue.value = &quot;&quot;;</span><br><span class="line">  each([&quot;update:modelValue&quot;, &quot;input&quot;, &quot;change&quot;], (e) =&gt; emits(e as any, &quot;&quot;));</span><br><span class="line">  emits(&quot;clear&quot;);</span><br><span class="line">  formItem?.clearValidate();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const focus: InputInstance[&quot;focus&quot;] = async function () &#123;</span><br><span class="line">  await nextTick();</span><br><span class="line">  _ref.value?.focus();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const blur: InputInstance[&quot;blur&quot;] = function () &#123;</span><br><span class="line">  _ref.value?.blur();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const select: InputInstance[&quot;select&quot;] = function () &#123;</span><br><span class="line">  _ref.value?.select();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function handleInput() &#123;</span><br><span class="line">  emits(&quot;update:modelValue&quot;, innerValue.value);</span><br><span class="line">  emits(&quot;input&quot;, innerValue.value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleChange() &#123;</span><br><span class="line">  emits(&quot;change&quot;, innerValue.value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function togglePasswordVisible() &#123;</span><br><span class="line">  passwordVisible.value = !passwordVisible.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  () =&gt; props.modelValue,</span><br><span class="line">  (newValue) =&gt; &#123;</span><br><span class="line">    innerValue.value = newValue;</span><br><span class="line">    formItem?.validate(&quot;change&quot;).catch((err) =&gt; debugWarn(err));</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">defineExpose&lt;InputInstance&gt;(&#123;</span><br><span class="line">  ref: _ref,</span><br><span class="line">  focus,</span><br><span class="line">  blur,</span><br><span class="line">  select,</span><br><span class="line">  clear,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    class=&quot;er-input&quot;</span><br><span class="line">    :class=&quot;&#123;</span><br><span class="line">      [`er-input--$&#123;type&#125;`]: type,</span><br><span class="line">      [`er-input--$&#123;size&#125;`]: size,</span><br><span class="line">      &#x27;is-disabled&#x27;: isDisabled,</span><br><span class="line">      &#x27;is-prepend&#x27;: $slots.prepend,</span><br><span class="line">      &#x27;is-append&#x27;: $slots.append,</span><br><span class="line">      &#x27;is-prefix&#x27;: $slots.prefix,</span><br><span class="line">      &#x27;is-suffix&#x27;: $slots.suffix,</span><br><span class="line">      &#x27;is-focus&#x27;: isFocused,</span><br><span class="line">    &#125;&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;!-- input --&gt;</span><br><span class="line">    &lt;template v-if=&quot;type !== &#x27;textarea&#x27;&quot;&gt;</span><br><span class="line">      &lt;!-- prepend slot --&gt;</span><br><span class="line">      &lt;div v-if=&quot;$slots.prepend&quot; class=&quot;er-input__prepend&quot;&gt;</span><br><span class="line">        &lt;slot name=&quot;prepend&quot;&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;er-input__wrapper&quot; ref=&quot;wrapperRef&quot;&gt;</span><br><span class="line">        &lt;!-- prefix slot --&gt;</span><br><span class="line">        &lt;span v-if=&quot;$slots.prefix&quot; class=&quot;er-input__prefix&quot;&gt;</span><br><span class="line">          &lt;slot name=&quot;prefix&quot;&gt;&lt;/slot&gt;</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          class=&quot;er-input__inner&quot;</span><br><span class="line">          ref=&quot;inputRef&quot;</span><br><span class="line">          :id=&quot;inputId&quot;</span><br><span class="line">          :type=&quot;showPassword ? (passwordVisible ? &#x27;text&#x27; : &#x27;password&#x27;) : type&quot;</span><br><span class="line">          :disabled=&quot;isDisabled&quot;</span><br><span class="line">          :readonly=&quot;readonly&quot;</span><br><span class="line">          :autocomplete=&quot;autocomplete&quot;</span><br><span class="line">          :placeholder=&quot;placeholder&quot;</span><br><span class="line">          :autofocus=&quot;autofocus&quot;</span><br><span class="line">          :form=&quot;form&quot;</span><br><span class="line">          v-model=&quot;innerValue&quot;</span><br><span class="line">          v-bind=&quot;attrs&quot;</span><br><span class="line">          @input=&quot;handleInput&quot;</span><br><span class="line">          @change=&quot;handleChange&quot;</span><br><span class="line">          @focus=&quot;handleFocus&quot;</span><br><span class="line">          @blur=&quot;handleBlur&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;!-- suffix slot --&gt;</span><br><span class="line">        &lt;span</span><br><span class="line">          v-if=&quot;$slots.suffix || showClear || showPasswordArea&quot;</span><br><span class="line">          class=&quot;er-input__suffix&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;slot name=&quot;suffix&quot;&gt;&lt;/slot&gt;</span><br><span class="line">          &lt;Icon</span><br><span class="line">            icon=&quot;circle-xmark&quot;</span><br><span class="line">            v-if=&quot;showClear&quot;</span><br><span class="line">            class=&quot;er-input__clear&quot;</span><br><span class="line">            @click=&quot;clear&quot;</span><br><span class="line">            @mousedown.prevent=&quot;noop&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">          &lt;Icon</span><br><span class="line">            icon=&quot;eye&quot;</span><br><span class="line">            v-if=&quot;showPasswordArea &amp;&amp; passwordVisible&quot;</span><br><span class="line">            class=&quot;er-input__password&quot;</span><br><span class="line">            @click=&quot;togglePasswordVisible&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">          &lt;Icon</span><br><span class="line">            icon=&quot;eye-slash&quot;</span><br><span class="line">            v-if=&quot;showPasswordArea &amp;&amp; !passwordVisible&quot;</span><br><span class="line">            class=&quot;er-input__password&quot;</span><br><span class="line">            @click=&quot;togglePasswordVisible&quot;</span><br><span class="line">          /&gt;</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- append slot --&gt;</span><br><span class="line">      &lt;div v-if=&quot;$slots.append&quot; class=&quot;er-input__append&quot;&gt;</span><br><span class="line">        &lt;slot name=&quot;append&quot;&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- textarea --&gt;</span><br><span class="line">    &lt;template v-else&gt;</span><br><span class="line">      &lt;textarea</span><br><span class="line">        class=&quot;er-textarea__wrapper&quot;</span><br><span class="line">        ref=&quot;textareaRef&quot;</span><br><span class="line">        :id=&quot;inputId&quot;</span><br><span class="line">        :disabled=&quot;isDisabled&quot;</span><br><span class="line">        :readonly=&quot;readonly&quot;</span><br><span class="line">        :autocomplete=&quot;autocomplete&quot;</span><br><span class="line">        :placeholder=&quot;placeholder&quot;</span><br><span class="line">        :autofocus=&quot;autofocus&quot;</span><br><span class="line">        :form=&quot;form&quot;</span><br><span class="line">        v-model=&quot;innerValue&quot;</span><br><span class="line">        v-bind=&quot;attrs&quot;</span><br><span class="line">        @input=&quot;handleInput&quot;</span><br><span class="line">        @change=&quot;handleChange&quot;</span><br><span class="line">        @focus=&quot;handleFocus&quot;</span><br><span class="line">        @blur=&quot;handleBlur&quot;</span><br><span class="line">      &gt;&lt;/textarea&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>



<h4 id="├─-style-css-6"><a href="#├─-style-css-6" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-input</span> &#123;</span><br><span class="line">  <span class="attr">--er-input-text-color</span>: <span class="built_in">var</span>(--er-text-color-regular);</span><br><span class="line">  <span class="attr">--er-input-border</span>: <span class="built_in">var</span>(--er-border);</span><br><span class="line">  <span class="attr">--er-input-hover-border</span>: <span class="built_in">var</span>(--er-border-color-hover);</span><br><span class="line">  <span class="attr">--er-input-focus-border</span>: <span class="built_in">var</span>(--er-color-primary);</span><br><span class="line">  <span class="attr">--er-input-transparent-border</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> transparent inset;</span><br><span class="line">  <span class="attr">--er-input-border-color</span>: <span class="built_in">var</span>(--er-border-color);</span><br><span class="line">  <span class="attr">--er-input-border-radius</span>: <span class="built_in">var</span>(--er-border-radius-base);</span><br><span class="line">  <span class="attr">--er-input-bg-color</span>: <span class="built_in">var</span>(--er-fill-color-blank);</span><br><span class="line">  <span class="attr">--er-input-icon-color</span>: <span class="built_in">var</span>(--er-text-color-placeholder);</span><br><span class="line">  <span class="attr">--er-input-placeholder-color</span>: <span class="built_in">var</span>(--er-text-color-placeholder);</span><br><span class="line">  <span class="attr">--er-input-hover-border-color</span>: <span class="built_in">var</span>(--er-border-color-hover);</span><br><span class="line">  <span class="attr">--er-input-clear-hover-color</span>: <span class="built_in">var</span>(--er-text-color-secondary);</span><br><span class="line">  <span class="attr">--er-input-focus-border-color</span>: <span class="built_in">var</span>(--er-color-primary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-input</span> &#123;</span><br><span class="line">  <span class="attr">--er-input-height</span>: <span class="built_in">var</span>(--er-component-size);</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-font-size-base);</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="built_in">var</span>(--er-input-height);</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  &amp;<span class="selector-class">.is-disabled</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">    <span class="selector-class">.er-input__wrapper</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-disabled-bg-color);</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--er-disabled-border-color) inset;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.er-input__inner</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-disabled-text-color);</span><br><span class="line">      -webkit-<span class="selector-tag">text</span>-<span class="attribute">fill</span>-<span class="attribute">color</span>: <span class="built_in">var</span>(--er-disabled-text-color);</span><br><span class="line">      <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.er-textarea__inner</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-disabled-bg-color);</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--er-disabled-border-color) inset;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-disabled-text-color);</span><br><span class="line">      -webkit-<span class="selector-tag">text</span>-<span class="attribute">fill</span>-<span class="attribute">color</span>: <span class="built_in">var</span>(--er-disabled-text-color);</span><br><span class="line">      <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-prepend</span> &#123;</span><br><span class="line">    &gt;<span class="selector-class">.er-input__wrapper</span> &#123;</span><br><span class="line">      <span class="attribute">border-top-left-radius</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">border-bottom-left-radius</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-append</span> &#123;</span><br><span class="line">    &gt;<span class="selector-class">.er-input__wrapper</span> &#123;</span><br><span class="line">      <span class="attribute">border-top-right-radius</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">border-bottom-right-radius</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-focus</span> <span class="selector-class">.er-input__wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--er-input-focus-border-color) inset<span class="meta">!important</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-input--large</span> &#123;</span><br><span class="line">  <span class="attr">--er-input-height</span>: <span class="built_in">var</span>(--er-component-size-large);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="selector-class">.er-input__wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">1px</span> <span class="number">15px</span>;</span><br><span class="line">    <span class="selector-class">.er-input__inner</span> &#123;</span><br><span class="line">      <span class="attr">--er-input-inner-height</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--er-input-height, <span class="number">40px</span>) - <span class="number">2px</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-input--small</span> &#123;</span><br><span class="line">  <span class="attr">--er-input-height</span>: <span class="built_in">var</span>(--er-component-size-small);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="selector-class">.er-input__wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">1px</span> <span class="number">7px</span>;</span><br><span class="line">    <span class="selector-class">.er-input__inner</span> &#123;</span><br><span class="line">      <span class="attr">--er-input-inner-height</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--er-input-height, <span class="number">24px</span>) - <span class="number">2px</span>);</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-input__prefix</span>, <span class="selector-class">.er-input__suffix</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">  <span class="attribute">flex-shrink</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">flex-wrap</span>: nowrap;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--er-input-icon-color, <span class="built_in">var</span>(--er-text-color-placeholder));</span><br><span class="line">  <span class="attribute">transition</span>: all <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-input__prefix</span> &#123;</span><br><span class="line">  &gt;<span class="selector-pseudo">:first-child</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">0px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  &gt;<span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">8px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-input__suffix</span> &#123;</span><br><span class="line">  &gt;<span class="selector-pseudo">:first-child</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">8px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  &gt;<span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">0px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-input__prepend</span>, <span class="selector-class">.er-input__append</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-fill-color-light);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--er-color-info);</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--er-input-border-radius);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-input__prepend</span> &#123;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-top-right-radius</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-bottom-right-radius</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">1px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="built_in">var</span>(--er-input-border-color) inset,<span class="number">0</span> <span class="number">1px</span> <span class="number">0</span> <span class="number">0</span> <span class="built_in">var</span>(--er-input-border-color) inset,<span class="number">0</span> -<span class="number">1px</span> <span class="number">0</span> <span class="number">0</span> <span class="built_in">var</span>(--er-input-border-color) inset;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-input__append</span> &#123;</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-top-left-radius</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-bottom-left-radius</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">0</span> <span class="number">0</span> <span class="built_in">var</span>(--er-input-border-color) inset,<span class="number">0</span> -<span class="number">1px</span> <span class="number">0</span> <span class="number">0</span> <span class="built_in">var</span>(--er-input-border-color) inset,-<span class="number">1px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="built_in">var</span>(--er-input-border-color) inset;</span><br><span class="line">  &amp; &gt;<span class="selector-class">.er-input__wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">border-top-left-radius</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-bottom-left-radius</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-input--textarea</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">vertical-align</span>: bottom;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-font-size-base);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-textarea__wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">resize</span>: vertical;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">11px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: inherit;</span><br><span class="line">  <span class="attribute">font-family</span>: inherit;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--er-input-text-color, <span class="built_in">var</span>(--er-text-color-regular));</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-input-bg-color, <span class="built_in">var</span>(--er-fill-color-blank));</span><br><span class="line">  <span class="attribute">background-image</span>: none;</span><br><span class="line">  -webkit-<span class="attribute">appearance</span>: none;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--er-input-border-color, <span class="built_in">var</span>(--er-border-color)) inset;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--er-input-border-radius, <span class="built_in">var</span>(--er-border-radius-base));</span><br><span class="line">  <span class="attribute">transition</span>: <span class="built_in">var</span>(--er-transition-box-shadow);</span><br><span class="line">  <span class="attribute">border</span>: none;</span><br><span class="line">  &amp;<span class="selector-pseudo">:focus</span> &#123;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--er-input-focus-border-color) inset;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-pseudo">::placeholder</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-input-placeholder-color);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-input__wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1px</span> <span class="number">11px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-input-bg-color, <span class="built_in">var</span>(--er-fill-color-blank));</span><br><span class="line">  <span class="attribute">background-image</span>: none;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--er-input-border-radius, <span class="built_in">var</span>(--er-border-radius-base));</span><br><span class="line">  <span class="attribute">transition</span>: <span class="built_in">var</span>(--er-transition-box-shadow);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--er-input-border-color, <span class="built_in">var</span>(--er-border-color)) inset;</span><br><span class="line">  &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--er-input-hover-border-color) inset;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-focus</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">var</span>(--er-input-focus-border-color) inset;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-input__inner</span> &#123;</span><br><span class="line">    <span class="attr">--er-input-inner-height</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--er-input-height, <span class="number">32px</span>) - <span class="number">2px</span>);</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">    -webkit-<span class="attribute">appearance</span>: none;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-input-text-color, <span class="built_in">var</span>(--er-text-color-regular));</span><br><span class="line">    <span class="attribute">font-size</span>: inherit;</span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">var</span>(--er-input-inner-height);</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="built_in">var</span>(--er-input-inner-height);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">    <span class="attribute">border</span>: none;</span><br><span class="line">    <span class="attribute">background</span>: none;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    &amp;<span class="selector-pseudo">::placeholder</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-input-placeholder-color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="selector-class">.er-icon</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: inherit;</span><br><span class="line">    <span class="attribute">line-height</span>: inherit;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">8px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-input__clear</span>, <span class="selector-class">.er-input__password</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-input-icon-color);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">     <span class="attribute">color</span>: <span class="built_in">var</span>(--er-input-clear-hover-color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="└─-types-ts-7"><a href="#└─-types-ts-7" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">InputProps</span> &#123;</span><br><span class="line">  <span class="attr">id</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">modelValue</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">type</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">size</span>?: <span class="string">&quot;large&quot;</span> | <span class="string">&quot;small&quot;</span>;</span><br><span class="line">  <span class="attr">disabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">clearable</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">showPassword</span>?: <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">placeholder</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">readonly</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">autocomplete</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">autofocus</span>?: <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">form</span>?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">InputEmits</span> &#123;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;update:modelValue&quot;</span>, <span class="attr">value</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;input&quot;</span>, <span class="attr">value</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">  <span class="comment">// 修改值且 失去焦点 才触发&#x27;change&#x27;</span></span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;change&quot;</span>, <span class="attr">value</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;focus&quot;</span>, <span class="attr">value</span>: <span class="title class_">FocusEvent</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;blur&quot;</span>, <span class="attr">value</span>: <span class="title class_">FocusEvent</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;clear&quot;</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">InputInstance</span> &#123;</span><br><span class="line">  <span class="attr">ref</span>: <span class="title class_">Ref</span>&lt;<span class="title class_">HTMLInputElement</span> | <span class="title class_">HTMLTextAreaElement</span> | <span class="built_in">void</span>&gt;;</span><br><span class="line">  <span class="title function_">focus</span>(): <span class="title class_">Promise</span>&lt;<span class="built_in">void</span>&gt;;</span><br><span class="line">  <span class="title function_">blur</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">select</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">clear</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Loading"><a href="#├─-Loading" class="headerlink" title="├─ Loading"></a>├─ Loading</h3><blockquote>
<p>显示加载状态</p>
</blockquote>
<h4 id="–API–-7"><a href="#–API–-7" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-directive-ts"><a href="#├─-directive-ts" class="headerlink" title="├─ directive.ts"></a>├─ directive.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">type</span> <span class="title class_">Directive</span>, <span class="keyword">type</span> <span class="title class_">DirectiveBinding</span>, <span class="keyword">type</span> <span class="title class_">MaybeRef</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">LoadingOptions</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">type</span> <span class="title class_">LoadingInstance</span>, <span class="title class_">Loading</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./service&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">INSTANCE_KEY</span> = <span class="title class_">Symbol</span>(<span class="string">&quot;loading&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ElementLoading</span> <span class="keyword">extends</span> <span class="title class_">HTMLElement</span> &#123;</span><br><span class="line">  [<span class="variable constant_">INSTANCE_KEY</span>]?: &#123;</span><br><span class="line">    <span class="attr">instance</span>: <span class="title class_">LoadingInstance</span>;</span><br><span class="line">    <span class="attr">options</span>: <span class="title class_">LoadingOptions</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createInstance</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">el</span>: <span class="title class_">ElementLoading</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">binding</span>: <span class="title class_">DirectiveBinding</span>&lt;<span class="built_in">boolean</span>&gt;</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> getProp = &lt;K <span class="keyword">extends</span> keyof <span class="title class_">LoadingOptions</span>&gt;<span class="function">(<span class="params"><span class="attr">name</span>: K</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> el.<span class="title function_">getAttribute</span>(<span class="string">`er-loading-<span class="subst">$&#123;name&#125;</span>`</span>) <span class="keyword">as</span> <span class="title class_">MaybeRef</span>&lt;<span class="built_in">string</span>&gt;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> getModifier = &lt;K <span class="keyword">extends</span> keyof <span class="title class_">LoadingOptions</span>&gt;<span class="function">(<span class="params"><span class="attr">name</span>: K</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> binding.<span class="property">modifiers</span>[name];</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> fullscreen = <span class="title function_">getModifier</span>(<span class="string">&quot;fullscreen&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="attr">options</span>: <span class="title class_">LoadingOptions</span> = &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="title function_">getProp</span>(<span class="string">&quot;text&quot;</span>),</span><br><span class="line">    <span class="attr">spinner</span>: <span class="title function_">getProp</span>(<span class="string">&quot;spinner&quot;</span>),</span><br><span class="line">    <span class="attr">background</span>: <span class="title function_">getProp</span>(<span class="string">&quot;background&quot;</span>),</span><br><span class="line">    <span class="attr">target</span>: fullscreen ? <span class="built_in">void</span> <span class="number">0</span> : el,</span><br><span class="line">    <span class="attr">body</span>: <span class="title function_">getModifier</span>(<span class="string">&quot;body&quot;</span>),</span><br><span class="line">    <span class="attr">lock</span>: <span class="title function_">getModifier</span>(<span class="string">&quot;lock&quot;</span>),</span><br><span class="line">    fullscreen,</span><br><span class="line">  &#125;;</span><br><span class="line">  el[<span class="variable constant_">INSTANCE_KEY</span>] = &#123;</span><br><span class="line">    options,</span><br><span class="line">    <span class="attr">instance</span>: <span class="title class_">Loading</span>(options),</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">vLoading</span>: <span class="title class_">Directive</span>&lt;<span class="title class_">ElementLoading</span>, <span class="built_in">boolean</span>&gt; = &#123;</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (binding.<span class="property">value</span>) <span class="title function_">createInstance</span>(el, binding);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">updated</span>(<span class="params">el, binding</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (binding.<span class="property">oldValue</span> === binding.<span class="property">value</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (binding.<span class="property">value</span> &amp;&amp; !binding.<span class="property">oldValue</span>) &#123;</span><br><span class="line">      <span class="title function_">createInstance</span>(el, binding);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    el[<span class="variable constant_">INSTANCE_KEY</span>]?.<span class="property">instance</span>?.<span class="title function_">close</span>();</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="title function_">unmounted</span>(<span class="params">el</span>) &#123;</span><br><span class="line">    el[<span class="variable constant_">INSTANCE_KEY</span>]?.<span class="property">instance</span>.<span class="title function_">close</span>();</span><br><span class="line">    el[<span class="variable constant_">INSTANCE_KEY</span>] = <span class="built_in">void</span> <span class="number">0</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="├─-index-ts-9"><a href="#├─-index-ts-9" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; vLoading &#125; <span class="keyword">from</span> <span class="string">&quot;./directive&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Loading</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./service&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">App</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErLoading</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>:<span class="string">&#x27;ErLoading&#x27;</span>,</span><br><span class="line">  <span class="title function_">install</span>(<span class="params"><span class="attr">app</span>: <span class="title class_">App</span></span>) &#123;</span><br><span class="line">    app.<span class="title function_">directive</span>(<span class="string">&quot;loading&quot;</span>, vLoading);</span><br><span class="line">    app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$loading</span> = <span class="title class_">Loading</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">directive</span>: vLoading,</span><br><span class="line">  <span class="attr">service</span>: <span class="title class_">Loading</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ErLoading</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  vLoading,</span><br><span class="line">  vLoading <span class="keyword">as</span> <span class="title class_">ErLoadingDirective</span>,</span><br><span class="line">  <span class="title class_">Loading</span> <span class="keyword">as</span> <span class="title class_">ErLoadingService</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-Loading-test-tsx"><a href="#├─-Loading-test-tsx" class="headerlink" title="├─ Loading.test.tsx"></a>├─ Loading.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, it, expect &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; nextTick &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Loading</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./service&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">rAF</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">requestAnimationFrame</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">requestAnimationFrame</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="title function_">res</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">nextTick</span>();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Loading&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should creat Loading instance&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> instance = <span class="title class_">Loading</span>();</span><br><span class="line">    <span class="title function_">expect</span>(instance).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should render mask&#x27;</span>,<span class="title function_">async</span>()=&gt;&#123;</span><br><span class="line">    <span class="title class_">Loading</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.er-loading__mask&#x27;</span>)).<span class="title function_">toBeTruthy</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should close Loading and remove it from DOM&#x27;</span>,<span class="title function_">async</span>()=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> instance = <span class="title class_">Loading</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.er-loading&#x27;</span>)).<span class="title function_">toBeTruthy</span>()</span><br><span class="line">    instance.<span class="title function_">close</span>()</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.er-loading&#x27;</span>)).<span class="title function_">toBeFalsy</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="├─-Loading-vue"><a href="#├─-Loading-vue" class="headerlink" title="├─ Loading.vue"></a>├─ Loading.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; LoadingOptions &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; computed, type Ref &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; isString &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import ErIcon from &quot;../Icon/Icon.vue&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErLoading&quot;,</span><br><span class="line">  inheritAttrs: false,</span><br><span class="line">&#125;);</span><br><span class="line">const props = defineProps&lt;LoadingOptions&gt;();</span><br><span class="line"></span><br><span class="line">const iconName = computed(() =&gt; &#123;</span><br><span class="line">  if (isString(props.spinner)) &#123;</span><br><span class="line">    return props.spinner;</span><br><span class="line">  &#125;</span><br><span class="line">  return &quot;spinner&quot;; // &#x27;circle-notch&#x27; 也很好看</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;transition name=&quot;fade-in-linear&quot; @after-leave=&quot;onAfterLeave&quot;&gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      v-show=&quot;(props.visible as Ref).value&quot;</span><br><span class="line">      class=&quot;er-loading er-loading__mask&quot;</span><br><span class="line">      :class=&quot;&#123; &#x27;is-fullscreen&#x27;: fullscreen &#125;&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;div class=&quot;er-loading__spinner&quot;&gt;</span><br><span class="line">        &lt;er-icon v-if=&quot;props.spinner !== false&quot; :icon=&quot;iconName&quot; spin /&gt;</span><br><span class="line">        &lt;p v-if=&quot;text&quot; class=&quot;er-loading-text&quot;&gt;&#123;&#123; text &#125;&#125;&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/transition&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">.er-loading &#123;</span><br><span class="line">  --er-loading-bg-color: v-bind(background) !important;</span><br><span class="line">  --er-loading-z-index: v-bind(zIndex) !important;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-service-ts"><a href="#├─-service-ts" class="headerlink" title="├─ service.ts"></a>├─ service.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">LoadingOptions</span>, <span class="title class_">LoadingOptionsResolved</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, createApp, reactive, nextTick &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useZIndex &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/hooks&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">LoadingComp</span> <span class="keyword">from</span> <span class="string">&quot;./Loading.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; delay, isNil, isString &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">RELATIVE_CLASS</span> = <span class="string">&quot;er-loading-parent--relative&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">HIDDEN_CLASS</span> = <span class="string">&quot;er-loading-parent--hiden&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">LOADING_NUMB_KEY</span> = <span class="string">&quot;er-loading-numb&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">instanceMap</span>: <span class="title class_">Map</span>&lt;<span class="title class_">HTMLElement</span>, <span class="title class_">LoadingInstance</span>&gt; = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"><span class="keyword">const</span> &#123; nextZIndex &#125; = <span class="title function_">useZIndex</span>(<span class="number">30000</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createLoadingComponent</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">LoadingOptionsResolved</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> visible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> afterLeaveFlag = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleAfterLeave</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (!afterLeaveFlag.<span class="property">value</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="title function_">destroy</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> data = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    ...options,</span><br><span class="line">    <span class="attr">onAfterLeave</span>: handleAfterLeave,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">setText</span> = (<span class="params"><span class="attr">text</span>: <span class="built_in">string</span></span>) =&gt; (data.<span class="property">text</span> = text);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">destroy</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> target = data.<span class="property">parent</span>;</span><br><span class="line">    <span class="title function_">subtLoadingNumb</span>(target);</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">getLoadingNumb</span>(target)) <span class="keyword">return</span>;</span><br><span class="line">    <span class="title function_">delay</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">removeRelativeClass</span>(target);</span><br><span class="line">      <span class="title function_">removeHiddenClass</span>(target);</span><br><span class="line">    &#125;, <span class="number">1</span>);</span><br><span class="line">    instanceMap.<span class="title function_">delete</span>(target ?? <span class="variable language_">document</span>.<span class="property">body</span>);</span><br><span class="line">    vm.<span class="property">$el</span>?.<span class="property">parentNode</span>?.<span class="title function_">removeChild</span>(vm.<span class="property">$el</span>);</span><br><span class="line">    app.<span class="title function_">unmount</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> <span class="attr">afterLeaveTimer</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">close</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (options.<span class="property">beforeClose</span> &amp;&amp; !options.<span class="title function_">beforeClose</span>()) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    afterLeaveFlag.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(afterLeaveTimer);</span><br><span class="line">    afterLeaveTimer = <span class="title function_">delay</span>(handleAfterLeave, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">    visible.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    options.<span class="property">closed</span>?.();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">LoadingComp</span>, &#123;</span><br><span class="line">    ...data,</span><br><span class="line">    <span class="attr">zIndex</span>: data.<span class="property">fullscreen</span> ? <span class="title function_">nextZIndex</span>() : <span class="built_in">void</span> <span class="number">0</span>,</span><br><span class="line">    visible,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> vm = app.<span class="title function_">mount</span>(<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">$el</span>(): <span class="title class_">HTMLElement</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> vm.<span class="property">$el</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    vm,</span><br><span class="line">    close,</span><br><span class="line">    visible,</span><br><span class="line">    setText,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">resolveOptions</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">LoadingOptions</span></span>): <span class="title class_">LoadingOptionsResolved</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">target</span>: <span class="title class_">HTMLElement</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isString</span>(options.<span class="property">target</span>)) &#123;</span><br><span class="line">    target = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(options.<span class="property">target</span>) ?? <span class="variable language_">document</span>.<span class="property">body</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    target = options.<span class="property">target</span> || <span class="variable language_">document</span>.<span class="property">body</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">parent</span>: target === <span class="variable language_">document</span>.<span class="property">body</span> || options.<span class="property">body</span> ? <span class="variable language_">document</span>.<span class="property">body</span> : target,</span><br><span class="line">    <span class="attr">background</span>: options.<span class="property">background</span> ?? <span class="string">&quot;rgba(0, 0, 0, 0.5)&quot;</span>,</span><br><span class="line">    <span class="attr">spinner</span>: options.<span class="property">spinner</span>,</span><br><span class="line">    <span class="attr">text</span>: options.<span class="property">text</span>,</span><br><span class="line">    <span class="attr">fullscreen</span>: target === <span class="variable language_">document</span>.<span class="property">body</span> &amp;&amp; (options.<span class="property">fullscreen</span> ?? <span class="literal">true</span>),</span><br><span class="line">    <span class="attr">lock</span>: options.<span class="property">lock</span> ?? <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">visible</span>: options.<span class="property">visible</span> ?? <span class="literal">true</span>,</span><br><span class="line">    target,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addRelativeClass</span>(<span class="params"><span class="attr">target</span>: <span class="title class_">HTMLElement</span> = <span class="variable language_">document</span>.body</span>) &#123;</span><br><span class="line">  target.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="variable constant_">RELATIVE_CLASS</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">removeRelativeClass</span>(<span class="params"><span class="attr">target</span>: <span class="title class_">HTMLElement</span> = <span class="variable language_">document</span>.body</span>) &#123;</span><br><span class="line">  target.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="variable constant_">RELATIVE_CLASS</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addHiddenClass</span>(<span class="params"><span class="attr">target</span>: <span class="title class_">HTMLElement</span> = <span class="variable language_">document</span>.body</span>) &#123;</span><br><span class="line">  target.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="variable constant_">HIDDEN_CLASS</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">removeHiddenClass</span>(<span class="params"><span class="attr">target</span>: <span class="title class_">HTMLElement</span> = <span class="variable language_">document</span>.body</span>) &#123;</span><br><span class="line">  target.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="variable constant_">HIDDEN_CLASS</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getLoadingNumb</span>(<span class="params"><span class="attr">target</span>: <span class="title class_">HTMLElement</span> = <span class="variable language_">document</span>.body</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> target.<span class="title function_">getAttribute</span>(<span class="variable constant_">LOADING_NUMB_KEY</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">removeLoadingNumb</span>(<span class="params"><span class="attr">target</span>: <span class="title class_">HTMLElement</span> = <span class="variable language_">document</span>.body</span>) &#123;</span><br><span class="line">  target.<span class="title function_">removeAttribute</span>(<span class="variable constant_">LOADING_NUMB_KEY</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addLoadingNumb</span>(<span class="params"><span class="attr">target</span>: <span class="title class_">HTMLElement</span> = <span class="variable language_">document</span>.body</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> numb = <span class="title function_">getLoadingNumb</span>(target) ?? <span class="string">&quot;0&quot;</span>;</span><br><span class="line">  target.<span class="title function_">setAttribute</span>(<span class="variable constant_">LOADING_NUMB_KEY</span>, <span class="string">`<span class="subst">$&#123;<span class="built_in">Number</span>.<span class="built_in">parseInt</span>(numb) + <span class="number">1</span>&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">subtLoadingNumb</span>(<span class="params"><span class="attr">target</span>: <span class="title class_">HTMLElement</span> = <span class="variable language_">document</span>.body</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> numb = <span class="title function_">getLoadingNumb</span>(target);</span><br><span class="line">  <span class="keyword">if</span> (numb) &#123;</span><br><span class="line">    <span class="keyword">const</span> newNumb = <span class="title class_">Number</span>.<span class="built_in">parseInt</span>(numb) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (newNumb === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="title function_">removeLoadingNumb</span>(target);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      target.<span class="title function_">setAttribute</span>(<span class="variable constant_">LOADING_NUMB_KEY</span>, <span class="string">`<span class="subst">$&#123;newNumb&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addClass</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">options</span>: <span class="title class_">LoadingOptions</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">parent</span>: <span class="title class_">HTMLElement</span> = <span class="variable language_">document</span>.body</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (options.<span class="property">lock</span>) &#123;</span><br><span class="line">    <span class="title function_">addHiddenClass</span>(parent);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">removeHiddenClass</span>(parent);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addRelativeClass</span>(parent);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">fullscreenInstance</span>: <span class="title class_">LoadingInstance</span> | <span class="literal">null</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">LoadingInstance</span> = <span class="title class_">ReturnType</span>&lt;<span class="keyword">typeof</span> createLoadingComponent&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">Loading</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">LoadingOptions</span> = &#123;&#125;</span>): <span class="title class_">LoadingInstance</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> resolved = <span class="title function_">resolveOptions</span>(options);</span><br><span class="line">  <span class="keyword">const</span> target = resolved.<span class="property">parent</span> ?? <span class="variable language_">document</span>.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (resolved.<span class="property">fullscreen</span> &amp;&amp; !<span class="title function_">isNil</span>(fullscreenInstance)) &#123;</span><br><span class="line">    <span class="keyword">return</span> fullscreenInstance;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addLoadingNumb</span>(resolved?.<span class="property">parent</span>);</span><br><span class="line">  <span class="keyword">if</span> (instanceMap.<span class="title function_">has</span>(target)) &#123;</span><br><span class="line">    <span class="keyword">return</span> instanceMap.<span class="title function_">get</span>(target)!;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> instance = <span class="title function_">createLoadingComponent</span>(&#123;</span><br><span class="line">    ...resolved,</span><br><span class="line">    <span class="attr">closed</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      resolved.<span class="property">closed</span>?.();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (resolved.<span class="property">fullscreen</span>) &#123;</span><br><span class="line">        fullscreenInstance = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addClass</span>(options, resolved?.<span class="property">parent</span>);</span><br><span class="line"></span><br><span class="line">  resolved.<span class="property">parent</span>?.<span class="title function_">appendChild</span>(instance.<span class="property">$el</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> (instance.<span class="property">visible</span>.<span class="property">value</span> = !!resolved.<span class="property">visible</span>));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (resolved.<span class="property">fullscreen</span>) &#123;</span><br><span class="line">    fullscreenInstance = instance;</span><br><span class="line">  &#125;</span><br><span class="line">  instanceMap.<span class="title function_">set</span>(target, instance);</span><br><span class="line">  <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-7"><a href="#├─-style-css-7" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-loading</span> &#123;</span><br><span class="line">  <span class="attr">--er-loading-icon-color</span>: <span class="built_in">var</span>(--er-color-primary);</span><br><span class="line">  <span class="attr">--er-loading-mask-margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--er-loading-mask-size</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attr">--er-loading-icon-size</span>: <span class="number">42px</span>;</span><br><span class="line">  <span class="attr">--er-loading-font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attr">--er-loading-z-index</span>: <span class="number">20000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-loading</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">  &amp;<span class="selector-class">.er-loading__mask</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="built_in">var</span>(--er-loading-mask-margin);</span><br><span class="line">    <span class="attribute">top</span>: <span class="built_in">var</span>(--er-loading-mask-margin);</span><br><span class="line">    <span class="attribute">right</span>: <span class="built_in">var</span>(--er-loading-mask-margin);</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="built_in">var</span>(--er-loading-mask-margin);</span><br><span class="line">    <span class="attribute">left</span>: <span class="built_in">var</span>(--er-loading-mask-margin);</span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">var</span>(--er-loading-mask-size);</span><br><span class="line">    <span class="attribute">width</span>: <span class="built_in">var</span>(--er-loading-mask-size);</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="built_in">var</span>(--er-loading-z-index);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--er-loading-bg-color);</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    &amp;<span class="selector-class">.is-fullscreen</span> &#123;</span><br><span class="line">      <span class="attribute">position</span>: fixed;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-loading__spinner</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-loading-icon-color);</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="selector-class">.er-loading-text</span> &#123;</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">3px</span> <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-loading-font-size);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">i</span> &#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-loading-icon-size);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.fade-in-linear-enter-from</span>,</span><br><span class="line"><span class="selector-class">.fade-in-linear-leave-to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-loading-parent--relative</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-loading-parent--hiden</span> &#123;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-8"><a href="#└─-types-ts-8" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">MaybeRef</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">LoadingOptionsResolved</span> &#123;</span><br><span class="line">  <span class="attr">parent</span>?: <span class="title class_">HTMLElement</span>;</span><br><span class="line">  <span class="attr">target</span>?: <span class="title class_">HTMLElement</span>;</span><br><span class="line">  <span class="attr">visible</span>?: <span class="title class_">MaybeRef</span>&lt;<span class="built_in">boolean</span>&gt;;</span><br><span class="line">  <span class="attr">background</span>?: <span class="title class_">MaybeRef</span>&lt;<span class="built_in">string</span>&gt;;</span><br><span class="line">  <span class="attr">spinner</span>?: <span class="title class_">MaybeRef</span>&lt;<span class="built_in">boolean</span> | <span class="built_in">string</span>&gt;;</span><br><span class="line">  <span class="attr">text</span>?: <span class="title class_">MaybeRef</span>&lt;<span class="built_in">string</span>&gt;;</span><br><span class="line">  <span class="attr">fullscreen</span>?: <span class="title class_">MaybeRef</span>&lt;<span class="built_in">boolean</span>&gt;;</span><br><span class="line">  <span class="attr">lock</span>?: <span class="title class_">MaybeRef</span>&lt;<span class="built_in">boolean</span>&gt;;</span><br><span class="line">  beforeClose?(): <span class="built_in">boolean</span>;</span><br><span class="line">  closed?(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">LoadingOptions</span> = <span class="title class_">Partial</span>&lt;</span><br><span class="line">  <span class="title class_">Omit</span>&lt;<span class="title class_">LoadingOptionsResolved</span>, <span class="string">&quot;parent&quot;</span> | <span class="string">&quot;target&quot;</span>&gt; &amp; &#123;</span><br><span class="line">    <span class="attr">target</span>: <span class="title class_">HTMLElement</span> | <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">body</span>: <span class="built_in">boolean</span>;</span><br><span class="line">    <span class="attr">zIndex</span>?: <span class="built_in">number</span>;</span><br><span class="line">    <span class="title function_">onAfterLeave</span>(): <span class="built_in">void</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&gt;;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Message"><a href="#├─-Message" class="headerlink" title="├─ Message"></a>├─ Message</h3><blockquote>
<p>顶部消息弹出框</p>
</blockquote>
<h4 id="–API–-8"><a href="#–API–-8" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-index-ts-10"><a href="#├─-index-ts-10" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Message</span> <span class="keyword">from</span> <span class="string">&quot;./methods&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstallFunction &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErMessage</span> = <span class="title function_">withInstallFunction</span>(<span class="title class_">Message</span>, <span class="string">&quot;$message&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-Message-test-tsx"><a href="#├─-Message-test-tsx" class="headerlink" title="├─ Message.test.tsx"></a>├─ Message.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, test, expect &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; nextTick &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; message, closeAll &#125; <span class="keyword">from</span> <span class="string">&quot;./methods&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">rAF</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">requestAnimationFrame</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">requestAnimationFrame</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="title function_">res</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">nextTick</span>();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getTopValue</span>(<span class="params"><span class="attr">element</span>: <span class="title class_">Element</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> styles = <span class="variable language_">window</span>.<span class="title function_">getComputedStyle</span>(element);</span><br><span class="line">  <span class="keyword">const</span> topValue = styles.<span class="title function_">getPropertyValue</span>(<span class="string">&quot;top&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Number</span>.<span class="built_in">parseFloat</span>(topValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;createMessage&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;调用方法应该创建对应的 Message 组件&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> handler = <span class="title function_">message</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;hello msg&quot;</span>, <span class="attr">duration</span>: <span class="number">0</span> &#125;);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.er-message&quot;</span>)).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    handler.<span class="title function_">close</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.er-message&quot;</span>)).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;多次调用应该创建多个实例&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="title function_">message</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;hello msg&quot;</span>, <span class="attr">duration</span>: <span class="number">0</span> &#125;);</span><br><span class="line">    <span class="title function_">message</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;hello msg2&quot;</span>, <span class="attr">duration</span>: <span class="number">0</span> &#125;);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.er-message&quot;</span>).<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="title function_">closeAll</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.er-message&quot;</span>).<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;创建多个实例应该设置正确的 offset&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="title function_">message</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;hello msg&quot;</span>, <span class="attr">duration</span>: <span class="number">0</span>, <span class="attr">offset</span>: <span class="number">100</span> &#125;);</span><br><span class="line">    <span class="title function_">message</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;hello msg2&quot;</span>, <span class="attr">duration</span>: <span class="number">0</span>, <span class="attr">offset</span>: <span class="number">50</span> &#125;);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="keyword">const</span> elements = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.er-message&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(elements.<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="comment">// https://github.com/jsdom/jsdom/issues/1590</span></span><br><span class="line">    <span class="comment">// jsdom 中获取height的数值都为 0</span></span><br><span class="line">    <span class="title function_">expect</span>(<span class="title function_">getTopValue</span>(elements[<span class="number">0</span>])).<span class="title function_">toBe</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title function_">getTopValue</span>(elements[<span class="number">1</span>])).<span class="title function_">toBe</span>(<span class="number">150</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="├─-Message-vue"><a href="#├─-Message-vue" class="headerlink" title="├─ Message.vue"></a>├─ Message.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; MessageProps &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; computed, onMounted, ref, watch &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; getLastBottomOffset &#125; from &quot;./methods&quot;;</span><br><span class="line">import &#123; delay, bind &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import &#123; useEventListener, useOffset &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line">import &#123; RenderVnode, typeIconMap &#125; from &quot;@eric-ui/utils&quot;;</span><br><span class="line">import ErIcon from &quot;../Icon/Icon.vue&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErMessage&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const props = withDefaults(defineProps&lt;MessageProps&gt;(), &#123;</span><br><span class="line">  type: &quot;info&quot;,</span><br><span class="line">  duration: 3000,</span><br><span class="line">  offset: 10,</span><br><span class="line">  transitionName: &quot;fade-up&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const visible = ref(false);</span><br><span class="line">const messageRef = ref&lt;HTMLDivElement&gt;();</span><br><span class="line"></span><br><span class="line">const iconName = computed(() =&gt; typeIconMap.get(props.type) ?? &quot;circle-info&quot;);</span><br><span class="line"></span><br><span class="line">// div 的高度</span><br><span class="line">const boxHeight = ref(0);</span><br><span class="line"></span><br><span class="line">const &#123; topOffset, bottomOffset &#125; = useOffset(&#123;</span><br><span class="line">  getLastBottomOffset: bind(getLastBottomOffset, props),</span><br><span class="line">  offset: props.offset,</span><br><span class="line">  boxHeight,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const cssStyle = computed(() =&gt; (&#123;</span><br><span class="line">  top: topOffset.value + &quot;px&quot;,</span><br><span class="line">  zIndex: props.zIndex,</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">let timer: number;</span><br><span class="line">function startTimmer() &#123;</span><br><span class="line">  if (props.duration === 0) return;</span><br><span class="line">  timer = delay(close, props.duration);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function clearTimer() &#123;</span><br><span class="line">  clearTimeout(timer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function close() &#123;</span><br><span class="line">  visible.value = false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  visible.value = true;</span><br><span class="line">  startTimmer();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">useEventListener(document, &quot;keydown&quot;, (e: Event) =&gt; &#123;</span><br><span class="line">  const &#123; code &#125; = e as KeyboardEvent;</span><br><span class="line">  if (code === &quot;Escape&quot;) &#123;</span><br><span class="line">    close();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">watch(visible, (val) =&gt; &#123;</span><br><span class="line">  if (!val) boxHeight.value = -props.offset; // 退出动画更流畅</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">defineExpose(&#123;</span><br><span class="line">  bottomOffset,</span><br><span class="line">  close,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;Transition</span><br><span class="line">    :name=&quot;transitionName&quot;</span><br><span class="line">    @enter=&quot;boxHeight = messageRef!.getBoundingClientRect().height&quot;</span><br><span class="line">    @after-leave=&quot;!visible &amp;&amp; onDestory()&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      ref=&quot;messageRef&quot;</span><br><span class="line">      class=&quot;er-message&quot;</span><br><span class="line">      :class=&quot;&#123;</span><br><span class="line">        [`er-message--$&#123;type&#125;`]: type,</span><br><span class="line">        &#x27;is-close&#x27;: showClose,</span><br><span class="line">        &#x27;text-center&#x27;: center,</span><br><span class="line">      &#125;&quot;</span><br><span class="line">      :style=&quot;cssStyle&quot;</span><br><span class="line">      v-show=&quot;visible&quot;</span><br><span class="line">      role=&quot;alert&quot;</span><br><span class="line">      @mouseenter=&quot;clearTimer&quot;</span><br><span class="line">      @mouseleave=&quot;startTimmer&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;er-icon class=&quot;er-message__icon&quot; :icon=&quot;iconName&quot; /&gt;</span><br><span class="line">      &lt;div class=&quot;er-message__content&quot;&gt;</span><br><span class="line">        &lt;slot&gt;</span><br><span class="line">          &lt;render-vnode v-if=&quot;message&quot; :vNode=&quot;message&quot; /&gt;</span><br><span class="line">        &lt;/slot&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;er-message__close&quot; v-if=&quot;showClose&quot;&gt;</span><br><span class="line">        &lt;er-icon icon=&quot;xmark&quot; @click.stop=&quot;close&quot; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/Transition&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-methods-ts"><a href="#├─-methods-ts" class="headerlink" title="├─ methods.ts"></a>├─ methods.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123;</span><br><span class="line">  <span class="title class_">CreateMessageProps</span>,</span><br><span class="line">  <span class="title class_">MessageInstance</span>,</span><br><span class="line">  <span class="title class_">MessageFn</span>,</span><br><span class="line">  <span class="title class_">Message</span>,</span><br><span class="line">  <span class="title class_">MessageParams</span>,</span><br><span class="line">  <span class="title class_">MessageHandler</span>,</span><br><span class="line">  <span class="title class_">MessageProps</span>,</span><br><span class="line">  messageType,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; messageTypes &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render, h, shallowReactive, isVNode &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; findIndex, get, each, set, isString &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useZIndex, useId &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/hooks&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MessageConstructor</span> <span class="keyword">from</span> <span class="string">&quot;./Message.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">instances</span>: <span class="title class_">MessageInstance</span>[] = <span class="title function_">shallowReactive</span>([]);</span><br><span class="line"><span class="keyword">const</span> &#123; nextZIndex &#125; = <span class="title function_">useZIndex</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> messageDefaults = &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&quot;info&quot;</span>,</span><br><span class="line">  <span class="attr">duration</span>: <span class="number">3000</span>,</span><br><span class="line">  <span class="attr">offset</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="attr">transitionName</span>: <span class="string">&quot;fade-up&quot;</span>,</span><br><span class="line">&#125; <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">normalizeOptions</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">MessageParams</span></span>): <span class="title class_">CreateMessageProps</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> result =</span><br><span class="line">    !options || <span class="title function_">isVNode</span>(options) || <span class="title function_">isString</span>(options)</span><br><span class="line">      ? &#123;</span><br><span class="line">          <span class="attr">message</span>: options,</span><br><span class="line">        &#125;</span><br><span class="line">      : options;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; ...messageDefaults, ...result &#125; <span class="keyword">as</span> <span class="title class_">CreateMessageProps</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMessage</span>(<span class="params"><span class="attr">props</span>: <span class="title class_">CreateMessageProps</span></span>): <span class="title class_">MessageInstance</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> id = <span class="title function_">useId</span>().<span class="property">value</span>;</span><br><span class="line">  <span class="keyword">const</span> container = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">destory</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> idx = <span class="title function_">findIndex</span>(instances, &#123; id &#125;);</span><br><span class="line">    <span class="keyword">if</span> (idx === -<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    instances.<span class="title function_">splice</span>(idx, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="literal">null</span>, container);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> _props = &#123;</span><br><span class="line">    ...props,</span><br><span class="line">    id,</span><br><span class="line">    <span class="attr">zIndex</span>: <span class="title function_">nextZIndex</span>(),</span><br><span class="line">    <span class="attr">onDestory</span>: destory,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> vnode = <span class="title function_">h</span>(<span class="title class_">MessageConstructor</span>, _props);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(vnode, container);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(container.<span class="property">firstElementChild</span>!);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> vm = vnode.<span class="property">component</span>!;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">handler</span>: <span class="title class_">MessageHandler</span> = &#123;</span><br><span class="line">    <span class="attr">close</span>: <span class="function">() =&gt;</span> vm.<span class="property">exposed</span>!.<span class="title function_">close</span>(),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">instance</span>: <span class="title class_">MessageInstance</span> = &#123;</span><br><span class="line">    <span class="attr">props</span>: _props,</span><br><span class="line">    id,</span><br><span class="line">    vm,</span><br><span class="line">    vnode,</span><br><span class="line">    handler,</span><br><span class="line">  &#125;;</span><br><span class="line">  instances.<span class="title function_">push</span>(instance);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">message</span>: <span class="title class_">MessageFn</span> &amp; <span class="title class_">Partial</span>&lt;<span class="title class_">Message</span>&gt; = <span class="keyword">function</span> (<span class="params">options = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> normalized = <span class="title function_">normalizeOptions</span>(options);</span><br><span class="line">  <span class="keyword">const</span> instance = <span class="title function_">createMessage</span>(normalized);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> instance.<span class="property">handler</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getLastBottomOffset</span>(<span class="params"><span class="attr">this</span>: <span class="title class_">MessageProps</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> idx = <span class="title function_">findIndex</span>(instances, &#123; <span class="attr">id</span>: <span class="variable language_">this</span>.<span class="property">id</span> &#125;);</span><br><span class="line">  <span class="keyword">if</span> (idx &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">get</span>(instances, [idx - <span class="number">1</span>, <span class="string">&quot;vm&quot;</span>, <span class="string">&quot;exposed&quot;</span>, <span class="string">&quot;bottomOffset&quot;</span>, <span class="string">&quot;value&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">closeAll</span>(<span class="params"><span class="attr">type</span>?: messageType</span>) &#123;</span><br><span class="line">  <span class="title function_">each</span>(instances, <span class="function">(<span class="params">instance</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">type</span>) &#123;</span><br><span class="line">      instance.<span class="property">props</span>.<span class="property">type</span> === <span class="keyword">type</span> &amp;&amp; instance.<span class="property">handler</span>.<span class="title function_">close</span>();</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    instance.<span class="property">handler</span>.<span class="title function_">close</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">each</span>(messageTypes, <span class="function">(<span class="params"><span class="keyword">type</span></span>) =&gt;</span></span><br><span class="line">  <span class="title function_">set</span>(message, <span class="keyword">type</span>, <span class="function">(<span class="params"><span class="attr">options</span>: <span class="title class_">MessageParams</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> normalized = <span class="title function_">normalizeOptions</span>(options);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">message</span>(&#123; ...normalized, <span class="keyword">type</span> &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">message.<span class="property">closeAll</span> = closeAll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> message <span class="keyword">as</span> <span class="title class_">Message</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-8"><a href="#├─-style-css-8" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-message</span> &#123;</span><br><span class="line">  <span class="attr">--er-message-bg-color</span>: <span class="built_in">var</span>(--er-color-info-light-<span class="number">9</span>);</span><br><span class="line">  <span class="attr">--er-message-border-color</span>: <span class="built_in">var</span>(--er-border-color-lighter);</span><br><span class="line">  <span class="attr">--er-message-padding</span>: <span class="number">15px</span> <span class="number">19px</span>;</span><br><span class="line">  <span class="attr">--er-message-close-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attr">--er-message-close-icon-color</span>: <span class="built_in">var</span>(--er-text-color-placeholder);</span><br><span class="line">  <span class="attr">--er-message-close-hover-color</span>: <span class="built_in">var</span>(--er-text-color-secondary);</span><br><span class="line">  <span class="attr">--er-message-icon-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attr">--er-message-icon-margin</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-message</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: fit-content;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">32px</span>);</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--er-border-radius-base);</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="built_in">var</span>(--er-border-width);</span><br><span class="line">  <span class="attribute">border-style</span>: <span class="built_in">var</span>(--er-border-style);</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="built_in">var</span>(--er-message-border-color);</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">50%</span>);</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-message-bg-color);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="built_in">var</span>(--er-message-padding);</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">transition</span>: top <span class="built_in">var</span>(--er-transition-duration), opacity <span class="built_in">var</span>(--er-transition-duration),</span><br><span class="line">    transform <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">  <span class="selector-class">.er-message__icon</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-message-text-color);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-message-icon-size);</span><br><span class="line">    <span class="attribute">width</span>: <span class="built_in">var</span>(--er-message-icon-size);</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="built_in">var</span>(--er-message-icon-margin);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-message__content</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-message-text-color);</span><br><span class="line">    <span class="attribute">overflow-wrap</span>: break-word;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-close</span> <span class="selector-class">.er-message__content</span> &#123;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.text-center</span> &#123;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-message__close</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-message__close</span> <span class="selector-class">.er-icon</span> &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@each</span> $val in info, success, warning, danger &#123;</span><br><span class="line">  <span class="selector-class">.er-message--</span>$(val) &#123;</span><br><span class="line">    <span class="attr">--er-message-bg-color</span>: <span class="built_in">var</span>(--er-color-$(val)-light-<span class="number">9</span>);</span><br><span class="line">    <span class="attr">--er-message-border-color</span>: <span class="built_in">var</span>(--er-color-$(val)-light-<span class="number">8</span>);</span><br><span class="line">    <span class="attr">--er-message-text-color</span>: <span class="built_in">var</span>(--er-color-$(val));</span><br><span class="line">    <span class="selector-class">.er-message__close</span> &#123;</span><br><span class="line">      <span class="attr">--er-icon-color</span>: <span class="built_in">var</span>(--er-color-$(val));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-message--error</span> &#123;</span><br><span class="line">  <span class="attr">--er-message-bg-color</span>: <span class="built_in">var</span>(--er-color-danger-light-<span class="number">9</span>);</span><br><span class="line">  <span class="attr">--er-message-border-color</span>: <span class="built_in">var</span>(--er-color-danger-light-<span class="number">8</span>);</span><br><span class="line">  <span class="attr">--er-message-text-color</span>: <span class="built_in">var</span>(--er-color-danger);</span><br><span class="line">  <span class="selector-class">.er-message__close</span> &#123;</span><br><span class="line">    <span class="attr">--er-icon-color</span>: <span class="built_in">var</span>(--er-color-danger);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-message</span><span class="selector-class">.fade-up-enter-from</span>,</span><br><span class="line"><span class="selector-class">.er-message</span><span class="selector-class">.fade-up-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">100%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-9"><a href="#└─-types-ts-9" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">VNode</span>, <span class="title class_">ComponentInternalInstance</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> messageTypes = [</span><br><span class="line">  <span class="string">&quot;info&quot;</span>,</span><br><span class="line">  <span class="string">&quot;success&quot;</span>,</span><br><span class="line">  <span class="string">&quot;warning&quot;</span>,</span><br><span class="line">  <span class="string">&quot;danger&quot;</span>,</span><br><span class="line">  <span class="string">&quot;error&quot;</span>,</span><br><span class="line">] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> messageType = (<span class="keyword">typeof</span> messageTypes)[<span class="built_in">number</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">MessageHandler</span> &#123;</span><br><span class="line">  <span class="title function_">close</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageFn</span> = &#123;</span><br><span class="line">  (<span class="attr">props</span>: <span class="title class_">MessageParams</span>): <span class="title class_">MessageHandler</span>;</span><br><span class="line">  <span class="title function_">closeAll</span>(<span class="attr">type</span>?: messageType): <span class="built_in">void</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageTypeFn</span> = <span class="function">(<span class="params"><span class="attr">props</span>: <span class="title class_">MessageParams</span></span>) =&gt;</span> <span class="title class_">MessageHandler</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Message</span> <span class="keyword">extends</span> <span class="title class_">MessageFn</span> &#123;</span><br><span class="line">  <span class="attr">success</span>: <span class="title class_">MessageTypeFn</span>;</span><br><span class="line">  <span class="attr">warning</span>: <span class="title class_">MessageTypeFn</span>;</span><br><span class="line">  <span class="attr">info</span>: <span class="title class_">MessageTypeFn</span>;</span><br><span class="line">  <span class="attr">danger</span>: <span class="title class_">MessageTypeFn</span>;</span><br><span class="line">  <span class="attr">error</span>: <span class="title class_">MessageTypeFn</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">MessageProps</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">message</span>?: <span class="built_in">string</span> | <span class="title class_">VNode</span> | (<span class="function">() =&gt;</span> <span class="title class_">VNode</span>);</span><br><span class="line">  <span class="attr">duration</span>?: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">showClose</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">center</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">type</span>?: messageType;</span><br><span class="line">  <span class="attr">offset</span>?: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">zIndex</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">transitionName</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="title function_">onDestory</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageOptions</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">Omit</span>&lt;<span class="title class_">MessageProps</span>, <span class="string">&quot;id&quot;</span>&gt;&gt;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageParams</span> = <span class="built_in">string</span> | <span class="title class_">VNode</span> | <span class="title class_">MessageOptions</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">MessageInstance</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">vnode</span>: <span class="title class_">VNode</span>;</span><br><span class="line">  <span class="attr">props</span>: <span class="title class_">MessageProps</span>;</span><br><span class="line">  <span class="attr">vm</span>: <span class="title class_">ComponentInternalInstance</span>;</span><br><span class="line">  <span class="attr">handler</span>: <span class="title class_">MessageHandler</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CreateMessageProps</span> = <span class="title class_">Omit</span>&lt;</span><br><span class="line">  <span class="title class_">MessageProps</span>,</span><br><span class="line">  <span class="string">&quot;onDestory&quot;</span> | <span class="string">&quot;id&quot;</span> | <span class="string">&quot;zIndex&quot;</span></span><br><span class="line">&gt;;</span><br></pre></td></tr></table></figure>



<h3 id="├─-MessageBox"><a href="#├─-MessageBox" class="headerlink" title="├─ MessageBox"></a>├─ MessageBox</h3><blockquote>
<p>中心弹出框</p>
</blockquote>
<h4 id="–API–-9"><a href="#–API–-9" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-index-ts-11"><a href="#├─-index-ts-11" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">MessageBox</span> <span class="keyword">from</span> <span class="string">&quot;./methods&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; set &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">App</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErMessageBox</span> = <span class="title class_">MessageBox</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">set</span>(<span class="title class_">ErMessageBox</span>, <span class="string">&quot;install&quot;</span>, <span class="function">(<span class="params"><span class="attr">app</span>: <span class="title class_">App</span></span>) =&gt;</span> &#123;</span><br><span class="line">  app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$msgbox</span> = <span class="title class_">MessageBox</span>;</span><br><span class="line">  app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$messageBox</span> = <span class="title class_">MessageBox</span>;</span><br><span class="line">  app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$alert</span> = <span class="title class_">MessageBox</span>.<span class="property">alert</span>;</span><br><span class="line">  app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$confirm</span> = <span class="title class_">MessageBox</span>.<span class="property">confirm</span>;</span><br><span class="line">  app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$prompt</span> = <span class="title class_">MessageBox</span>.<span class="property">prompt</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ErMessageBox</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-MessageBox-test-tsx"><a href="#├─-MessageBox-test-tsx" class="headerlink" title="├─ MessageBox.test.tsx"></a>├─ MessageBox.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, it, expect, vi &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; nextTick &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">MessageBoxType</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MessageBox</span> <span class="keyword">from</span> <span class="string">&quot;./methods&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">rAF</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">requestAnimationFrame</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">requestAnimationFrame</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="title function_">res</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">nextTick</span>();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;MessageBox Component&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;renders correctly&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&quot;Test Title&quot;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;Test Message&quot;</span>,</span><br><span class="line">      <span class="attr">showClose</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">closeOnClickModal</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">confirmButtonText</span>: <span class="string">&quot;Confirm&quot;</span>,</span><br><span class="line">      <span class="attr">cancelButtonText</span>: <span class="string">&quot;Cancel&quot;</span>,</span><br><span class="line">      <span class="attr">showConfirmButton</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">MessageBox</span>(props);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="keyword">const</span> header = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.er-message-box__header&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> title = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.er-message-box__title&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> message = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.er-message-box__message&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(title).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(header).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(message).<span class="title function_">toBeTruthy</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title class_">MessageBox</span>.<span class="title function_">close</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;closes on close button click&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&quot;Test Title&quot;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;Test Message&quot;</span>,</span><br><span class="line">      <span class="attr">showClose</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> doAction = vi.<span class="title function_">fn</span>();</span><br><span class="line">    <span class="title class_">MessageBox</span>(props).<span class="title function_">catch</span>(<span class="function">(<span class="params">action</span>) =&gt;</span> <span class="title function_">doAction</span>(action));</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> closeBtn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(</span><br><span class="line">      <span class="string">&quot;.er-message-box__header-btn&quot;</span></span><br><span class="line">    ) <span class="keyword">as</span> <span class="title class_">HTMLButtonElement</span>;</span><br><span class="line">    closeBtn.<span class="title function_">click</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(doAction).<span class="title function_">toHaveBeenCalledWith</span>(<span class="string">&quot;close&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;triggers confirm action on confirm button click&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&quot;Test Title&quot;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;Test Message&quot;</span>,</span><br><span class="line">      <span class="attr">showConfirmButton</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">showCancelButton</span>: <span class="literal">false</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> doAction = vi.<span class="title function_">fn</span>();</span><br><span class="line">    <span class="title class_">MessageBox</span>(props)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">(<span class="params">action</span>) =&gt;</span> <span class="title function_">doAction</span>(action))</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> confirmBtn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(</span><br><span class="line">      <span class="string">&quot;.er-message-box__footer-btn&quot;</span></span><br><span class="line">    ) <span class="keyword">as</span> <span class="title class_">HTMLButtonElement</span>;</span><br><span class="line">    confirmBtn.<span class="title function_">click</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(doAction).<span class="title function_">toBeCalledWith</span>(<span class="string">&#x27;confirm&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;triggers cancel action on cancel button click&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&quot;Test Title&quot;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;Test Message&quot;</span>,</span><br><span class="line">      <span class="attr">showConfirmButton</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">showCancelButton</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> doAction = vi.<span class="title function_">fn</span>();</span><br><span class="line">    <span class="title class_">MessageBox</span>(props).<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> <span class="title function_">doAction</span>(err));</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> cancelBtn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(</span><br><span class="line">      <span class="string">&quot;.er-message-box__cancel-btn&quot;</span></span><br><span class="line">    ) <span class="keyword">as</span> <span class="title class_">HTMLButtonElement</span>;</span><br><span class="line">    cancelBtn.<span class="title function_">click</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(doAction).<span class="title function_">toHaveBeenCalledWith</span>(<span class="string">&quot;cancel&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;handles input in prompt mode&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> props = &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&quot;Test Title&quot;</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&quot;Test Message&quot;</span>,</span><br><span class="line">      <span class="attr">boxType</span>: <span class="string">&quot;prompt&quot;</span> <span class="keyword">as</span> <span class="title class_">MessageBoxType</span>,</span><br><span class="line">      <span class="attr">showInput</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> doAction = vi.<span class="title function_">fn</span>();</span><br><span class="line">    <span class="title class_">MessageBox</span>(props).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> <span class="title function_">doAction</span>(res));</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;input&quot;</span>) <span class="keyword">as</span> <span class="title class_">HTMLInputElement</span>;</span><br><span class="line">    input.<span class="property">value</span> = <span class="string">&quot;Test Input&quot;</span>;</span><br><span class="line">    input.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;input&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> confirmBtn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(</span><br><span class="line">      <span class="string">&quot;.er-message-box__confirm-btn&quot;</span></span><br><span class="line">    ) <span class="keyword">as</span> <span class="title class_">HTMLButtonElement</span>;</span><br><span class="line">    confirmBtn.<span class="title function_">click</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(doAction).<span class="title function_">toHaveBeenCalledWith</span>(&#123;</span><br><span class="line">      <span class="attr">value</span>: <span class="string">&quot;Test Input&quot;</span>,</span><br><span class="line">      <span class="attr">action</span>: <span class="string">&quot;confirm&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="├─-MessageBox-vue"><a href="#├─-MessageBox-vue" class="headerlink" title="├─ MessageBox.vue"></a>├─ MessageBox.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, reactive, computed, watch, nextTick, type Ref &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; isFunction, isNil &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import type &#123; MessageBoxProps, MessageBoxAction &#125; from &quot;./types&quot;;</span><br><span class="line">import type &#123; InputInstance &#125; from &quot;../Input/types&quot;;</span><br><span class="line"></span><br><span class="line">import ErOverlay from &quot;../Overlay/Overlay.vue&quot;;</span><br><span class="line">import ErIcon from &quot;../Icon/Icon.vue&quot;;</span><br><span class="line">import ErButton from &quot;../Button/Button.vue&quot;;</span><br><span class="line">import ErInput from &quot;../Input/Input.vue&quot;;</span><br><span class="line"></span><br><span class="line">import &#123; useId, useZIndex &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line">import &#123; typeIconMap &#125; from &quot;@eric-ui/utils&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123; name: &quot;ErMessageBox&quot;, inheritAttrs: false &#125;);</span><br><span class="line"></span><br><span class="line">const props = withDefaults(defineProps&lt;MessageBoxProps&gt;(), &#123;</span><br><span class="line">  lockScroll: true,</span><br><span class="line">  showClose: true,</span><br><span class="line">  closeOnClickModal: true,</span><br><span class="line">  confirmButtonType: &quot;primary&quot;,</span><br><span class="line">  roundButton: false,</span><br><span class="line">  boxType: &quot;&quot;,</span><br><span class="line">  inputValue: &quot;&quot;,</span><br><span class="line">  inputPlaceholder:&#x27;Please input...&#x27;,</span><br><span class="line">  confirmButtonText: &quot;Ok&quot;,</span><br><span class="line">  cancelButtonText: &quot;Cancel&quot;,</span><br><span class="line">  showConfirmButton: true,</span><br><span class="line">&#125;);</span><br><span class="line">const &#123; doAction &#125; = props;</span><br><span class="line"></span><br><span class="line">const headerRef = ref&lt;HTMLElement&gt;();</span><br><span class="line">const inputRef = ref&lt;InputInstance&gt;();</span><br><span class="line"></span><br><span class="line">const inputId = useId();</span><br><span class="line">const &#123; nextZIndex &#125; = useZIndex();</span><br><span class="line"></span><br><span class="line">const state = reactive(&#123;</span><br><span class="line">  ...props,</span><br><span class="line">  zIndex: nextZIndex(),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const hasMessage = computed(() =&gt; !!state.message);</span><br><span class="line">const iconComponent = computed(</span><br><span class="line">  () =&gt; state.icon ?? typeIconMap.get(state.type ?? &quot;&quot;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  () =&gt; props.visible?.value,</span><br><span class="line">  (val) =&gt; &#123;</span><br><span class="line">    if (val) state.zIndex = nextZIndex();</span><br><span class="line"></span><br><span class="line">    if (props.boxType !== &quot;prompt&quot;) return;</span><br><span class="line"></span><br><span class="line">    if (!val) return;</span><br><span class="line"></span><br><span class="line">    nextTick(() =&gt; &#123;</span><br><span class="line">      inputRef.value &amp;&amp; inputRef.value.focus();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">function handleWrapperClick() &#123;</span><br><span class="line">  props.closeOnClickModal &amp;&amp; handleAction(&quot;close&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleInputEnter(e: KeyboardEvent) &#123;</span><br><span class="line">  if (state.inputType === &quot;textarea&quot;) return;</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  return handleAction(&quot;confirm&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleAction(action: MessageBoxAction) &#123;</span><br><span class="line">  isFunction(props.beforeClose)</span><br><span class="line">    ? props.beforeClose(action, state, () =&gt; doAction(action, state.inputValue))</span><br><span class="line">    : doAction(action, state.inputValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleClose() &#123;</span><br><span class="line">  handleAction(&quot;close&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;transition name=&quot;fade-in-linear&quot; @after-leave=&quot;destroy&quot;&gt;</span><br><span class="line">    &lt;er-overlay v-show=&quot;(visible as Ref).value&quot; :z-index=&quot;state.zIndex&quot; mask&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        role=&quot;dialog&quot;</span><br><span class="line">        class=&quot;er-overlay-message-box&quot;</span><br><span class="line">        @click=&quot;handleWrapperClick&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;div</span><br><span class="line">          ref=&quot;rootRef&quot;</span><br><span class="line">          :class=&quot;[</span><br><span class="line">            &#x27;er-message-box&#x27;,</span><br><span class="line">            &#123;</span><br><span class="line">              &#x27;is-center&#x27;: state.center,</span><br><span class="line">            &#125;,</span><br><span class="line">          ]&quot;</span><br><span class="line">          @click.stop</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;div</span><br><span class="line">            v-if=&quot;!isNil(state.title)&quot;</span><br><span class="line">            ref=&quot;headerRef&quot;</span><br><span class="line">            class=&quot;er-message-box__header&quot;</span><br><span class="line">            :class=&quot;&#123; &#x27;show-close&#x27;: state.showClose &#125;&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;div class=&quot;er-message-box__title&quot;&gt;</span><br><span class="line">              &lt;er-icon</span><br><span class="line">                v-if=&quot;iconComponent &amp;&amp; state.center&quot;</span><br><span class="line">                :class=&quot;&#123;</span><br><span class="line">                  [`er-icon-$&#123;state.type&#125;`]: state.type,</span><br><span class="line">                &#125;&quot;</span><br><span class="line">                :icon=&quot;iconComponent&quot;</span><br><span class="line">              /&gt;</span><br><span class="line">              &#123;&#123; state.title &#125;&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;button</span><br><span class="line">              v-if=&quot;showClose&quot;</span><br><span class="line">              class=&quot;er-message-box__header-btn&quot;</span><br><span class="line">              @click.stop=&quot;handleClose&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              &lt;er-icon icon=&quot;xmark&quot; /&gt;</span><br><span class="line">            &lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;er-message-box__content&quot;&gt;</span><br><span class="line">            &lt;er-icon</span><br><span class="line">              v-if=&quot;iconComponent &amp;&amp; !state.center &amp;&amp; hasMessage&quot;</span><br><span class="line">              :class=&quot;&#123;</span><br><span class="line">                [`er-icon-$&#123;state.type&#125;`]: state.type,</span><br><span class="line">              &#125;&quot;</span><br><span class="line">              :icon=&quot;iconComponent&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">            &lt;div v-if=&quot;hasMessage&quot; class=&quot;er-message-box__message&quot;&gt;</span><br><span class="line">              &lt;slot&gt;</span><br><span class="line">                &lt;component</span><br><span class="line">                  :is=&quot;state.showInput ? &#x27;label&#x27; : &#x27;p&#x27;&quot;</span><br><span class="line">                  :for=&quot;state.showInput ? inputId : void 0&quot;</span><br><span class="line">                &gt;</span><br><span class="line">                  &#123;&#123; state.message &#125;&#125;</span><br><span class="line">                &lt;/component&gt;</span><br><span class="line">              &lt;/slot&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div v-show=&quot;state.showInput&quot; class=&quot;er-message-box__input&quot;&gt;</span><br><span class="line">            &lt;er-input</span><br><span class="line">              v-model=&quot;state.inputValue&quot;</span><br><span class="line">              ref=&quot;inputRef&quot;</span><br><span class="line">              :placeholder=&quot;state.inputPlaceholder&quot;</span><br><span class="line">              :type=&quot;state.inputType&quot;</span><br><span class="line">              @keyup.enter=&quot;handleInputEnter&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;er-message-box__footer&quot;&gt;</span><br><span class="line">            &lt;er-button</span><br><span class="line">              v-if=&quot;state.showCancelButton&quot;</span><br><span class="line">              class=&quot;er-message-box__footer-btn er-message-box__cancel-btn&quot;</span><br><span class="line">              :type=&quot;state.cancelButtonType&quot;</span><br><span class="line">              :round=&quot;state.roundButton&quot;</span><br><span class="line">              :loading=&quot;state.cancelButtonLoading&quot;</span><br><span class="line">              @click=&quot;handleAction(&#x27;cancel&#x27;)&quot;</span><br><span class="line">              @keydown.prevent.enter=&quot;handleAction(&#x27;cancel&#x27;)&quot;</span><br><span class="line">              &gt;&#123;&#123; state.cancelButtonText &#125;&#125;&lt;/er-button</span><br><span class="line">            &gt;</span><br><span class="line">            &lt;er-button</span><br><span class="line">              v-show=&quot;state.showConfirmButton&quot;</span><br><span class="line">              class=&quot;er-message-box__footer-btn er-message-box__confirm-btn&quot;</span><br><span class="line">              :type=&quot;state.confirmButtonType ?? &#x27;primary&#x27;&quot;</span><br><span class="line">              :round=&quot;state.roundButton&quot;</span><br><span class="line">              :loading=&quot;state.confirmButtonLoading&quot;</span><br><span class="line">              @click=&quot;handleAction(&#x27;confirm&#x27;)&quot;</span><br><span class="line">              @keydown.prevent.enter=&quot;handleAction(&#x27;confirm&#x27;)&quot;</span><br><span class="line">              &gt;&#123;&#123; state.confirmButtonText &#125;&#125;&lt;/er-button</span><br><span class="line">            &gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/er-overlay&gt;</span><br><span class="line">  &lt;/transition&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-methods-ts-1"><a href="#├─-methods-ts-1" class="headerlink" title="├─ methods.ts"></a>├─ methods.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createVNode,</span><br><span class="line">  isVNode,</span><br><span class="line">  ref,</span><br><span class="line">  render,</span><br><span class="line">  nextTick,</span><br><span class="line">  <span class="keyword">type</span> <span class="title class_">ComponentPublicInstance</span>,</span><br><span class="line">  <span class="keyword">type</span> <span class="title class_">VNode</span>,</span><br><span class="line">  <span class="keyword">type</span> <span class="title class_">VNodeProps</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123;</span><br><span class="line">  <span class="title class_">MessageBoxAction</span>,</span><br><span class="line">  <span class="title class_">MessageBoxOptions</span>,</span><br><span class="line">  <span class="title class_">MessageBoxData</span>,</span><br><span class="line">  <span class="title class_">MessageBoxCallback</span>,</span><br><span class="line">  <span class="title class_">MessageBoxProps</span>,</span><br><span class="line">  <span class="title class_">IErMessageBox</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MessageBoxConstructor</span> <span class="keyword">from</span> <span class="string">&quot;./MessageBox.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  assign,</span><br><span class="line">  each,</span><br><span class="line">  isFunction,</span><br><span class="line">  isObject,</span><br><span class="line">  isString,</span><br><span class="line">  isUndefined,</span><br><span class="line">  set,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> messageInstanceMap = <span class="keyword">new</span> <span class="title class_">Map</span>&lt;</span><br><span class="line">  <span class="title class_">ComponentPublicInstance</span>&lt;&#123; <span class="attr">doClose</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span> &#125;&gt;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">options</span>: <span class="title class_">MessageBoxOptions</span>;</span><br><span class="line">    <span class="attr">callback</span>: <span class="title class_">MessageBoxCallback</span> | <span class="built_in">void</span>;</span><br><span class="line">    <span class="attr">resolve</span>: <span class="function">(<span class="params"><span class="attr">res</span>: <span class="built_in">any</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">    <span class="attr">reject</span>: <span class="function">(<span class="params"><span class="attr">res</span>: <span class="built_in">any</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initInstance</span>(<span class="params"><span class="attr">props</span>: <span class="title class_">MessageBoxProps</span>, <span class="attr">container</span>: <span class="title class_">HTMLElement</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> visible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> isVNodeMsg = <span class="title function_">isFunction</span>(props?.<span class="property">message</span>) || <span class="title function_">isVNode</span>(props?.<span class="property">message</span>);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">genDefaultSlot</span> = (<span class="params"><span class="attr">message</span>: <span class="title class_">VNode</span> | (() =&gt; VNode)</span>) =&gt;</span><br><span class="line">    <span class="title function_">isFunction</span>(message) ? message : <span class="function">() =&gt;</span> message;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> vnode = <span class="title function_">createVNode</span>(</span><br><span class="line">    <span class="title class_">MessageBoxConstructor</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      ...props,</span><br><span class="line">      visible,</span><br><span class="line">    &#125; <span class="keyword">as</span> <span class="title class_">VNodeProps</span>,</span><br><span class="line">    isVNodeMsg ? &#123; <span class="attr">default</span>: <span class="title function_">genDefaultSlot</span>(props.<span class="property">message</span> <span class="keyword">as</span> <span class="title class_">VNode</span>) &#125; : <span class="built_in">void</span> <span class="number">0</span></span><br><span class="line">  );</span><br><span class="line">  <span class="title function_">render</span>(vnode, container);</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(container.<span class="property">firstElementChild</span>!);</span><br><span class="line">  <span class="keyword">return</span> vnode.<span class="property">component</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">genContainer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showMessage</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">MessageBoxOptions</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> container = <span class="title function_">genContainer</span>();</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">props</span>: <span class="title class_">MessageBoxProps</span> = &#123;</span><br><span class="line">    ...options,</span><br><span class="line">    <span class="attr">doClose</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      vm.<span class="property">visible</span>.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">doAction</span>: <span class="function">(<span class="params"><span class="attr">action</span>: <span class="title class_">MessageBoxAction</span>, <span class="attr">inputVal</span>: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> currentMsg = messageInstanceMap.<span class="title function_">get</span>(vm);</span><br><span class="line">      <span class="keyword">let</span> <span class="attr">resolve</span>:</span><br><span class="line">        | <span class="title class_">MessageBoxAction</span></span><br><span class="line">        | &#123; <span class="attr">value</span>: <span class="built_in">string</span>; <span class="attr">action</span>: <span class="title class_">MessageBoxAction</span> &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> vm.<span class="title function_">doClose</span>());</span><br><span class="line">      <span class="keyword">if</span> (options.<span class="property">showInput</span>) &#123;</span><br><span class="line">        resolve = &#123; <span class="attr">value</span>: inputVal, <span class="attr">action</span>: action &#125;;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        resolve = action;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (options.<span class="property">callback</span>) &#123;</span><br><span class="line">        options.<span class="title function_">callback</span>(resolve);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (action === <span class="string">&quot;cancel&quot;</span> || action === <span class="string">&quot;close&quot;</span>) &#123;</span><br><span class="line">        currentMsg?.<span class="title function_">reject</span>(action);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      currentMsg?.<span class="title function_">resolve</span>(resolve);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">destroy</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">render</span>(<span class="literal">null</span>, container);</span><br><span class="line">      messageInstanceMap.<span class="title function_">delete</span>(vm);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> instance = <span class="title function_">initInstance</span>(props <span class="keyword">as</span> <span class="title class_">MessageBoxProps</span>, container);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> vm = instance?.<span class="property">proxy</span> <span class="keyword">as</span> <span class="title class_">ComponentPublicInstance</span>&lt;<span class="built_in">any</span>&gt;;</span><br><span class="line"></span><br><span class="line">  vm.<span class="property">visible</span>.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">return</span> vm;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">MessageBox</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">MessageBoxOptions</span></span>): <span class="title class_">Promise</span>&lt;<span class="title class_">MessageBoxData</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">MessageBox</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">MessageBoxOptions</span> | <span class="built_in">string</span> | <span class="title class_">VNode</span></span>): <span class="title class_">Promise</span>&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">callback</span>: <span class="title class_">MessageBoxCallback</span> | <span class="built_in">void</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isString</span>(options) || <span class="title function_">isVNode</span>(options)) &#123;</span><br><span class="line">    options = &#123;</span><br><span class="line">      <span class="attr">message</span>: options,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    callback = options.<span class="property">callback</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> vm = <span class="title function_">showMessage</span>(options);</span><br><span class="line">    messageInstanceMap.<span class="title function_">set</span>(vm, &#123; options, callback, resolve, reject &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">MESSAGE_BOX_VARIANTS</span> = [<span class="string">&quot;alert&quot;</span>, <span class="string">&quot;confirm&quot;</span>, <span class="string">&quot;prompt&quot;</span>] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="attr">MESSAGE_BOX_DEFAULT_OPTS</span>: <span class="title class_">Record</span>&lt;</span><br><span class="line">  (<span class="keyword">typeof</span> <span class="variable constant_">MESSAGE_BOX_VARIANTS</span>)[<span class="built_in">number</span>],</span><br><span class="line">  <span class="title class_">Partial</span>&lt;<span class="title class_">MessageBoxOptions</span>&gt;</span><br><span class="line">&gt; = &#123;</span><br><span class="line">  <span class="attr">alert</span>: &#123; <span class="attr">closeOnClickModal</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">  <span class="attr">confirm</span>: &#123; <span class="attr">showCancelButton</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  <span class="attr">prompt</span>: &#123; <span class="attr">showCancelButton</span>: <span class="literal">true</span>, <span class="attr">showInput</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">each</span>(<span class="variable constant_">MESSAGE_BOX_VARIANTS</span>, <span class="function">(<span class="params"><span class="keyword">type</span></span>) =&gt;</span></span><br><span class="line">  <span class="title function_">set</span>(<span class="title class_">MessageBox</span>, <span class="keyword">type</span>, <span class="title function_">messageBoxFactory</span>(<span class="keyword">type</span>))</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">messageBoxFactory</span>(<span class="params"><span class="attr">boxType</span>: (<span class="keyword">typeof</span> MESSAGE_BOX_VARIANTS)[<span class="built_in">number</span>]</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="attr">message</span>: <span class="built_in">string</span> | <span class="title class_">VNode</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="attr">title</span>: <span class="built_in">string</span> | <span class="title class_">MessageBoxOptions</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="attr">options</span>: <span class="title class_">MessageBoxOptions</span></span></span></span><br><span class="line"><span class="params"><span class="function">  </span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> titleOrOpts = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">isObject</span>(title)) &#123;</span><br><span class="line">      options = title <span class="keyword">as</span> <span class="title class_">MessageBoxOptions</span>;</span><br><span class="line">      titleOrOpts = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_">isUndefined</span>(title)) &#123;</span><br><span class="line">      titleOrOpts = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      titleOrOpts = title <span class="keyword">as</span> <span class="built_in">string</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">MessageBox</span>(</span><br><span class="line">      <span class="title function_">assign</span>(</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">title</span>: titleOrOpts,</span><br><span class="line">          message,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">          boxType,</span><br><span class="line">          ...<span class="variable constant_">MESSAGE_BOX_DEFAULT_OPTS</span>[boxType],</span><br><span class="line">        &#125;,</span><br><span class="line">        options</span><br><span class="line">      )</span><br><span class="line">    );</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">set</span>(<span class="title class_">MessageBox</span>, <span class="string">&quot;close&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  messageInstanceMap.<span class="title function_">forEach</span>(<span class="function">(<span class="params">_, vm</span>) =&gt;</span> &#123;</span><br><span class="line">    vm.<span class="title function_">doClose</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">  messageInstanceMap.<span class="title function_">clear</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MessageBox</span> <span class="keyword">as</span> <span class="title class_">IErMessageBox</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-9"><a href="#├─-style-css-9" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-message-box</span> &#123;</span><br><span class="line">  <span class="attr">--er-message-box-title-color</span>: <span class="built_in">var</span>(--er-text-color-primary);</span><br><span class="line">  <span class="attr">--er-message-box-width</span>: <span class="number">420px</span>;</span><br><span class="line">  <span class="attr">--er-message-box-border-radius</span>: <span class="built_in">var</span>(--er-border-radius-base);</span><br><span class="line">  <span class="attr">--er-message-box-font-size</span>: <span class="built_in">var</span>(--er-font-size-large);</span><br><span class="line">  <span class="attr">--er-message-box-content-font-size</span>: <span class="built_in">var</span>(--er-font-size-base);</span><br><span class="line">  <span class="attr">--er-message-box-content-color</span>: <span class="built_in">var</span>(--er-text-color-regular);</span><br><span class="line">  <span class="attr">--er-message-box-padding-primary</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attr">--er-message-box-font-line-height</span>: <span class="built_in">var</span>(--er-font-size-medium);</span><br><span class="line">  <span class="attr">--er-message-box-close-size</span>: <span class="built_in">var</span>(--er-message-close-size, <span class="number">16px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-overlay-message-box</span> &#123;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-message-box</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">position</span>: relative; </span><br><span class="line">  <span class="attribute">max-width</span>: <span class="built_in">var</span>(--er-message-box-width);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="built_in">var</span>(--er-message-box-padding-primary);</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-bg-color);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--er-message-box-border-radius);</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-message-box-font-size);</span><br><span class="line">  <span class="attribute">text-align</span>: left;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">backface-visibility</span>: hidden;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">overflow-wrap</span>: break-word;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-pseudo">:focus</span>&#123;</span><br><span class="line">    <span class="attribute">outline</span>: none <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  &amp;<span class="selector-class">.is-center</span> &#123;</span><br><span class="line">    <span class="selector-class">.er-message-box__title</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: flex;</span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line">      <span class="attribute">justify-content</span>: center;</span><br><span class="line">      <span class="attribute">gap</span>: <span class="number">6px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.er-message-box__footer</span>,<span class="selector-class">.er-message-box__content</span> &#123;</span><br><span class="line">      <span class="attribute">justify-content</span>: center;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  :<span class="built_in">deep</span>(.er-icon)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@each</span> $val in info, success, warning, danger &#123;</span><br><span class="line">      &amp;<span class="selector-class">.er-icon-</span>$(val) &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--er-color-$(val))<span class="meta">!important</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.er-icon-error</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-color-danger)<span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.er-message-box__header</span> &#123;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="built_in">var</span>(--er-message-box-padding-primary);</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.er-message-box__title</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-message-box-title-color);</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-message-box-font-size);</span><br><span class="line">      <span class="attribute">line-height</span>: <span class="built_in">var</span>(--er-message-box-font-line-height);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.er-message-box__header-btn</span> &#123;</span><br><span class="line">      <span class="attribute">position</span>: absolute;</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">      <span class="attribute">border</span>: none;</span><br><span class="line">      <span class="attribute">outline</span>: none;</span><br><span class="line">      <span class="attribute">background</span>: transparent;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-message-box-close-size);</span><br><span class="line">      <span class="attribute">cursor</span>: pointer;</span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">i</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--er-color-info);</span><br><span class="line">        <span class="attribute">font-size</span>: inherit; </span><br><span class="line">      &#125;</span><br><span class="line">      &amp;<span class="selector-pseudo">:focus</span>,</span><br><span class="line">      &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="selector-tag">i</span> &#123;</span><br><span class="line">          <span class="attribute">color</span>: <span class="built_in">var</span>(--er-color-danger);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-class">.show-close</span> &#123;</span><br><span class="line">      <span class="attribute">padding-right</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--er-message-box-padding-primary) + <span class="built_in">var</span>(--er-message-box-close-size));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.er-message-box__content</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-message-box-content-font-size);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-message-box-content-color);</span><br><span class="line">    <span class="selector-class">.er-message-box__message</span> &#123;</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">      &amp; <span class="selector-tag">p</span> &#123;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="built_in">var</span>(--er-message-box-font-line-height);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-message-box__input</span> &#123;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="number">12px</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.er-message-box__footer</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">    <span class="attribute">justify-content</span>: flex-end;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">padding-top</span>: <span class="built_in">var</span>(--er-message-box-padding-primary);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fade-in-linear-enter-active</span> &#123;</span><br><span class="line">  <span class="selector-class">.er-overlay-message-box</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: msgbox-fade-in <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fade-in-linear-leave-active</span> &#123;</span><br><span class="line">  <span class="selector-class">.er-overlay-message-box</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: msgbox-fade-in <span class="built_in">var</span>(--er-transition-duration) reverse;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> msgbox-fade-in &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, -<span class="number">20px</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-10"><a href="#└─-types-ts-10" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">type</span> <span class="title class_">Ref</span>, <span class="keyword">type</span> <span class="title class_">VNode</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">type</span> messageType &#125; <span class="keyword">from</span> <span class="string">&quot;../Message/types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">type</span> <span class="title class_">ButtonType</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../Button/types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageBoxAction</span> = <span class="string">&quot;confirm&quot;</span> | <span class="string">&quot;cancel&quot;</span> | <span class="string">&quot;close&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageBoxType</span> = <span class="string">&quot;&quot;</span> | <span class="string">&quot;prompt&quot;</span> | <span class="string">&quot;alert&quot;</span> | <span class="string">&quot;confirm&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageBoxCallback</span> = <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="attr">action</span>: <span class="title class_">MessageBoxAction</span> | &#123; value: <span class="built_in">string</span>; action: MessageBoxAction &#125;</span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageBoxInputData</span> = &#123;</span><br><span class="line">  <span class="attr">value</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">action</span>: <span class="title class_">MessageBoxAction</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageBoxData</span> = <span class="title class_">MessageBoxInputData</span> &amp; <span class="title class_">MessageBoxAction</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">MessageBoxOptions</span> &#123;</span><br><span class="line">  <span class="attr">title</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">message</span>?: <span class="built_in">string</span> | <span class="title class_">VNode</span> | (<span class="function">() =&gt;</span> <span class="title class_">VNode</span>);</span><br><span class="line">  <span class="attr">type</span>?: messageType;</span><br><span class="line">  <span class="attr">boxType</span>?: <span class="title class_">MessageBoxType</span>;</span><br><span class="line">  <span class="attr">icon</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">callback</span>?: <span class="title class_">MessageBoxCallback</span>;</span><br><span class="line">  <span class="attr">showClose</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">showInput</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">showCancelButton</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">showConfirmButton</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">cancelButtonText</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">confirmButtonText</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">cancelButtonLoading</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">confirmButtonLoading</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">cancelButtonDisabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">confirmButtonDisabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">cancelButtonType</span>?: <span class="title class_">ButtonType</span>;</span><br><span class="line">  <span class="attr">confirmButtonType</span>?: <span class="title class_">ButtonType</span>;</span><br><span class="line">  <span class="attr">roundButton</span>?: <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">center</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">lockScroll</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">closeOnClickModal</span>?: <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">inputPlaceholder</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">inputValue</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">inputType</span>?: <span class="string">&quot;text&quot;</span> | <span class="string">&quot;textarea&quot;</span> | <span class="string">&quot;password&quot;</span> | <span class="string">&quot;number&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attr">buttonSize</span>?: <span class="string">&quot;default&quot;</span> | <span class="string">&quot;small&quot;</span> | <span class="string">&quot;large&quot;</span>;</span><br><span class="line">  <span class="attr">beforeClose</span>?: <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="attr">action</span>: <span class="title class_">MessageBoxAction</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="attr">instance</span>: <span class="title class_">MessageBoxOptions</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="attr">done</span>: () =&gt; <span class="built_in">void</span></span></span></span><br><span class="line"><span class="params"><span class="function">  </span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">MessageBoxProps</span> <span class="keyword">extends</span> <span class="title class_">MessageBoxOptions</span> &#123;</span><br><span class="line">  <span class="attr">visible</span>?: <span class="title class_">Ref</span>&lt;<span class="built_in">boolean</span>&gt;;</span><br><span class="line">  <span class="title function_">doClose</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">doAction</span>(<span class="attr">action</span>: <span class="title class_">MessageBoxAction</span>, <span class="attr">inputVal</span>?: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">destroy</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">MessageBoxShortcutMethod</span> = (<span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="attr">message</span>: <span class="title class_">MessageBoxOptions</span>[<span class="string">&quot;message&quot;</span>],</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="attr">title</span>: <span class="title class_">MessageBoxOptions</span>[<span class="string">&quot;title&quot;</span>],</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="attr">options</span>?: <span class="title class_">MessageBoxOptions</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> <span class="title class_">Promise</span>&lt;<span class="title class_">MessageBoxData</span>&gt;) &amp;</span><br><span class="line">  (<span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="attr">message</span>: <span class="title class_">MessageBoxOptions</span>[<span class="string">&quot;message&quot;</span>],</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="attr">options</span>?: <span class="title class_">MessageBoxOptions</span></span></span></span><br><span class="line"><span class="params"><span class="function">  </span>) =&gt;</span> <span class="title class_">Promise</span>&lt;<span class="title class_">MessageBoxData</span>&gt;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">IErMessageBox</span> &#123;</span><br><span class="line">  (<span class="attr">options</span>: <span class="title class_">MessageBoxOptions</span> | <span class="built_in">string</span> | <span class="title class_">VNode</span>): <span class="title class_">Promise</span>&lt;<span class="built_in">any</span>&gt;;</span><br><span class="line"></span><br><span class="line">  <span class="attr">alert</span>: <span class="title class_">MessageBoxShortcutMethod</span>;</span><br><span class="line">  <span class="attr">confirm</span>: <span class="title class_">MessageBoxShortcutMethod</span>;</span><br><span class="line">  <span class="attr">prompt</span>: <span class="title class_">MessageBoxShortcutMethod</span>;</span><br><span class="line">  <span class="title function_">close</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Notification"><a href="#├─-Notification" class="headerlink" title="├─ Notification"></a>├─ Notification</h3><blockquote>
<p>角落弹出通知框</p>
</blockquote>
<h4 id="–API–-10"><a href="#–API–-10" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-index-ts-12"><a href="#├─-index-ts-12" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Notification</span> <span class="keyword">from</span> <span class="string">&quot;./methods&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstallFunction &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErNotification</span> = <span class="title function_">withInstallFunction</span>(</span><br><span class="line">  <span class="title class_">Notification</span>,</span><br><span class="line">  <span class="string">&quot;$notify&quot;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-methods-ts-2"><a href="#├─-methods-ts-2" class="headerlink" title="├─ methods.ts"></a>├─ methods.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123;</span><br><span class="line">  <span class="title class_">CreateNotificationProps</span>,</span><br><span class="line">  <span class="title class_">NotificationInstance</span>,</span><br><span class="line">  <span class="title class_">NotificationFn</span>,</span><br><span class="line">  <span class="title class_">Notification</span>,</span><br><span class="line">  <span class="title class_">NotificationParams</span>,</span><br><span class="line">  <span class="title class_">NotificationHandler</span>,</span><br><span class="line">  <span class="title class_">NotificationProps</span>,</span><br><span class="line">  notificationType,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; notificationTypes, notificationPosition &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; shallowReactive, isVNode, render, h &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; each, findIndex, isString, set, get &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useZIndex, useId &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/hooks&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NotificationConstructor</span> <span class="keyword">from</span> <span class="string">&quot;./Notification.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; nextZIndex &#125; = <span class="title function_">useZIndex</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> notificationDefaults = &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&quot;info&quot;</span>,</span><br><span class="line">  <span class="attr">position</span>: <span class="string">&quot;top-right&quot;</span>,</span><br><span class="line">  <span class="attr">duration</span>: <span class="number">3000</span>,</span><br><span class="line">  <span class="attr">offset</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">transitionName</span>: <span class="string">&quot;fade&quot;</span>,</span><br><span class="line">  <span class="attr">showClose</span>: <span class="literal">true</span>,</span><br><span class="line">&#125; <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">instancesMap</span>: <span class="title class_">Map</span>&lt;<span class="title class_">NotificationProps</span>[<span class="string">&quot;position&quot;</span>], <span class="title class_">NotificationInstance</span>[]&gt; =</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"><span class="title function_">each</span>(notificationPosition, <span class="function">(<span class="params">key</span>) =&gt;</span> instancesMap.<span class="title function_">set</span>(key, <span class="title function_">shallowReactive</span>([])));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getInstancesByPosition = (</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">NotificationProps</span>[<span class="string">&quot;position&quot;</span>]</span><br><span class="line">): <span class="title class_">NotificationInstance</span>[] =&gt; instancesMap.<span class="title function_">get</span>(position)!;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">normalizeOptions</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">options</span>: <span class="title class_">NotificationParams</span></span></span><br><span class="line"><span class="params"></span>): <span class="title class_">CreateNotificationProps</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> result =</span><br><span class="line">    !options || <span class="title function_">isVNode</span>(options) || <span class="title function_">isString</span>(options)</span><br><span class="line">      ? &#123; <span class="attr">message</span>: options &#125;</span><br><span class="line">      : options;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; ...notificationDefaults, ...result &#125; <span class="keyword">as</span> <span class="title class_">CreateNotificationProps</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createNotification</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">props</span>: <span class="title class_">CreateNotificationProps</span></span></span><br><span class="line"><span class="params"></span>): <span class="title class_">NotificationInstance</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> id = <span class="title function_">useId</span>().<span class="property">value</span>;</span><br><span class="line">  <span class="keyword">const</span> container = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> instances = <span class="title function_">getInstancesByPosition</span>(props.<span class="property">position</span> || <span class="string">&quot;top-right&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">destory</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> idx = <span class="title function_">findIndex</span>(instances, &#123; id &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (idx === -<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    instances.<span class="title function_">splice</span>(idx, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="literal">null</span>, container);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> _props = &#123;</span><br><span class="line">    ...props,</span><br><span class="line">    id,</span><br><span class="line">    <span class="attr">zIndex</span>: <span class="title function_">nextZIndex</span>(),</span><br><span class="line">    <span class="attr">onDestory</span>: destory,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> vnode = <span class="title function_">h</span>(<span class="title class_">NotificationConstructor</span>, _props);</span><br><span class="line">  <span class="title function_">render</span>(vnode, container);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(container.<span class="property">firstElementChild</span>!);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> vm = vnode.<span class="property">component</span>!;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">handler</span>: <span class="title class_">NotificationHandler</span> = &#123;</span><br><span class="line">    <span class="attr">close</span>: <span class="function">() =&gt;</span> vm.<span class="property">exposed</span>?.<span class="title function_">close</span>(),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">instance</span>: <span class="title class_">NotificationInstance</span> = &#123;</span><br><span class="line">    <span class="attr">props</span>: _props,</span><br><span class="line">    id,</span><br><span class="line">    vm,</span><br><span class="line">    vnode,</span><br><span class="line">    handler,</span><br><span class="line">  &#125;;</span><br><span class="line">  instances.<span class="title function_">push</span>(instance);</span><br><span class="line">  <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">notification</span>: <span class="title class_">NotificationFn</span> &amp; <span class="title class_">Partial</span>&lt;<span class="title class_">Notification</span>&gt; = <span class="keyword">function</span> (<span class="params"></span></span><br><span class="line"><span class="params">  options = &#123;&#125;</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> normalized = <span class="title function_">normalizeOptions</span>(options);</span><br><span class="line">  <span class="keyword">const</span> instance = <span class="title function_">createNotification</span>(normalized);</span><br><span class="line">  <span class="keyword">return</span> instance.<span class="property">handler</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">closeAll</span>(<span class="params"><span class="attr">type</span>?: notificationType</span>) &#123;</span><br><span class="line">  instancesMap.<span class="title function_">forEach</span>(<span class="function">(<span class="params">instances</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">each</span>(instances, <span class="function">(<span class="params">instance</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">type</span>) &#123;</span><br><span class="line">        instance.<span class="property">props</span>.<span class="property">type</span> === <span class="keyword">type</span> &amp;&amp; instance.<span class="property">handler</span>.<span class="title function_">close</span>();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      instance.<span class="property">handler</span>.<span class="title function_">close</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getLastBottomOffset</span>(<span class="params"><span class="attr">this</span>: <span class="title class_">NotificationProps</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> instances = <span class="title function_">getInstancesByPosition</span>(<span class="variable language_">this</span>.<span class="property">position</span> || <span class="string">&quot;top-right&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> idx = <span class="title function_">findIndex</span>(instances, &#123; <span class="attr">id</span>: <span class="variable language_">this</span>.<span class="property">id</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (idx &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">get</span>(instances, [idx - <span class="number">1</span>, <span class="string">&quot;vm&quot;</span>, <span class="string">&quot;exposed&quot;</span>, <span class="string">&quot;bottomOffset&quot;</span>, <span class="string">&quot;value&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">each</span>(notificationTypes, <span class="function">(<span class="params"><span class="keyword">type</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">set</span>(notification, <span class="keyword">type</span>, <span class="function">(<span class="params"><span class="attr">options</span>: <span class="title class_">NotificationParams</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> normalized = <span class="title function_">normalizeOptions</span>(options);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">notification</span>(&#123; ...normalized, <span class="keyword">type</span> &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">notification.<span class="property">closeAll</span> = closeAll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> notification <span class="keyword">as</span> <span class="title class_">Notification</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-Notification-test-tsx"><a href="#├─-Notification-test-tsx" class="headerlink" title="├─ Notification.test.tsx"></a>├─ Notification.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, test, expect &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; nextTick &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; notification, closeAll &#125; <span class="keyword">from</span> <span class="string">&quot;./methods&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">rAF</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">requestAnimationFrame</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">requestAnimationFrame</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="title function_">res</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">await</span> <span class="title function_">nextTick</span>();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getTopValue</span>(<span class="params"><span class="attr">element</span>: <span class="title class_">Element</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> styles = <span class="variable language_">window</span>.<span class="title function_">getComputedStyle</span>(element);</span><br><span class="line">  <span class="keyword">const</span> topValue = styles.<span class="title function_">getPropertyValue</span>(<span class="string">&quot;top&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Number</span>.<span class="built_in">parseFloat</span>(topValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;createMessage&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;call notification()&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> handler = <span class="title function_">notification</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;hello msg&quot;</span>, <span class="attr">duration</span>: <span class="number">0</span> &#125;);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.er-notification&quot;</span>)).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    handler.<span class="title function_">close</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.er-notification&quot;</span>)).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;call notification() more times&#x27;</span>,<span class="title function_">async</span>()=&gt; &#123;</span><br><span class="line">    <span class="title function_">notification</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;hello msg&quot;</span>, <span class="attr">duration</span>: <span class="number">0</span> &#125;);</span><br><span class="line">    <span class="title function_">notification</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;hello msg&quot;</span>, <span class="attr">duration</span>: <span class="number">0</span> &#125;);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.er-notification&quot;</span>).<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">2</span>);</span><br><span class="line">    notification.<span class="title function_">closeAll</span>()</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>();</span><br><span class="line">    <span class="title function_">expect</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.er-notification&quot;</span>).<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&#x27;offset&#x27;</span>,<span class="title function_">async</span>()=&gt;&#123;</span><br><span class="line">    <span class="title function_">notification</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;hello msg&quot;</span>, <span class="attr">duration</span>: <span class="number">0</span>,<span class="attr">offset</span>:<span class="number">100</span> &#125;);</span><br><span class="line">    <span class="title function_">notification</span>(&#123; <span class="attr">message</span>: <span class="string">&quot;hello msg&quot;</span>, <span class="attr">duration</span>: <span class="number">0</span>,<span class="attr">offset</span>:<span class="number">50</span> &#125;);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">rAF</span>()</span><br><span class="line">    <span class="keyword">const</span> elements = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.er-notification&quot;</span>)</span><br><span class="line">    <span class="title function_">expect</span>(elements.<span class="property">length</span>).<span class="title function_">toBe</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(<span class="title function_">getTopValue</span>(elements[<span class="number">0</span>])).<span class="title function_">toBe</span>(<span class="number">100</span>)</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title function_">getTopValue</span>(elements[<span class="number">1</span>])).<span class="title function_">toBe</span>(<span class="number">150</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="├─-Notification-vue"><a href="#├─-Notification-vue" class="headerlink" title="├─ Notification.vue"></a>├─ Notification.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; NotificationProps &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; ref, computed, onMounted &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; getLastBottomOffset &#125; from &quot;./methods&quot;;</span><br><span class="line">import &#123; bind, delay, isString &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import &#123; RenderVnode, typeIconMap &#125; from &quot;@eric-ui/utils&quot;;</span><br><span class="line">import &#123; useOffset &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line"></span><br><span class="line">import ErIcon from &quot;../Icon/Icon.vue&quot;;</span><br><span class="line"></span><br><span class="line">const props = withDefaults(defineProps&lt;NotificationProps&gt;(), &#123;</span><br><span class="line">  type: &quot;info&quot;,</span><br><span class="line">  duration: 3000,</span><br><span class="line">  offset: 20,</span><br><span class="line">  transitionName: &quot;fade&quot;,</span><br><span class="line">  showClose: true,</span><br><span class="line">&#125;);</span><br><span class="line">const visible = ref(false);</span><br><span class="line">const notifyRef = ref&lt;HTMLDivElement&gt;();</span><br><span class="line"></span><br><span class="line">// 这个 div 的高度</span><br><span class="line">const boxHeight = ref(0);</span><br><span class="line"></span><br><span class="line">const &#123; topOffset, bottomOffset &#125; = useOffset(&#123;</span><br><span class="line">  getLastBottomOffset: bind(getLastBottomOffset, props),</span><br><span class="line">  offset: props.offset,</span><br><span class="line">  boxHeight,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const iconName = computed(() =&gt; &#123;</span><br><span class="line">  if (isString(props.icon)) return props.icon;</span><br><span class="line">  return typeIconMap.get(props.type);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const horizontalClass = computed(() =&gt;</span><br><span class="line">  props.position.endsWith(&quot;right&quot;) ? &quot;right&quot; : &quot;left&quot;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const verticalProperty = computed(() =&gt;</span><br><span class="line">  props.position.startsWith(&quot;top&quot;) ? &quot;top&quot; : &quot;bottom&quot;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const cssStyle = computed(() =&gt; (&#123;</span><br><span class="line">  [verticalProperty.value]: topOffset.value + &quot;px&quot;,</span><br><span class="line">  zIndex: props.zIndex,</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">let timer: number;</span><br><span class="line"></span><br><span class="line">function startTimer() &#123;</span><br><span class="line">  if (props.duration === 0) return;</span><br><span class="line">  timer = delay(close, props.duration);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function clearTimer() &#123;</span><br><span class="line">  clearTimeout(timer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function close() &#123;</span><br><span class="line">  visible.value = false;</span><br><span class="line">  props?.onClose?.();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  visible.value = true;</span><br><span class="line">  startTimer();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">defineExpose(&#123;</span><br><span class="line">  close,</span><br><span class="line">  bottomOffset,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;transition</span><br><span class="line">    :name=&quot;`er-notification-$&#123;transitionName&#125;`&quot;</span><br><span class="line">    @after-leave=&quot;!visible &amp;&amp; onDestory()&quot;</span><br><span class="line">    @enter=&quot;boxHeight = notifyRef!.getBoundingClientRect().height&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      ref=&quot;notifyRef&quot;</span><br><span class="line">      class=&quot;er-notification&quot;</span><br><span class="line">      :class=&quot;&#123;</span><br><span class="line">        [`er-notification--$&#123;type&#125;`]: type,</span><br><span class="line">        &#x27;show-close&#x27;: showClose,</span><br><span class="line">        [horizontalClass]: true,</span><br><span class="line">      &#125;&quot;</span><br><span class="line">      :style=&quot;cssStyle&quot;</span><br><span class="line">      v-show=&quot;visible&quot;</span><br><span class="line">      role=&quot;alert&quot;</span><br><span class="line">      @click=&quot;onClick&quot;</span><br><span class="line">      @mouseenter=&quot;clearTimer&quot;</span><br><span class="line">      @mouseleave=&quot;startTimer&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;er-icon v-if=&quot;iconName&quot; :icon=&quot;iconName&quot; class=&quot;er-notification__icon&quot; /&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;er-notification__text&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;er-notification__title&quot;&gt;&#123;&#123; title &#125;&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;er-notification__content&quot;&gt;</span><br><span class="line">          &lt;slot&gt;</span><br><span class="line">            &lt;render-vnode v-if=&quot;message&quot; :vNode=&quot;message&quot; /&gt;</span><br><span class="line">          &lt;/slot&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;er-notification__close&quot; v-if=&quot;showClose&quot;&gt;</span><br><span class="line">        &lt;er-icon icon=&quot;xmark&quot; @click.stop=&quot;close&quot; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/transition&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-10"><a href="#├─-style-css-10" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-notification</span> &#123;</span><br><span class="line">  <span class="attr">--er-notification-width</span>: <span class="number">330px</span>;</span><br><span class="line">  <span class="attr">--er-notification-padding</span>: <span class="number">14px</span> <span class="number">26px</span> <span class="number">14px</span> <span class="number">13px</span>;</span><br><span class="line">  <span class="attr">--er-notification-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attr">--er-notification-shadow</span>: <span class="built_in">var</span>(--er-box-shadow-light);</span><br><span class="line">  <span class="attr">--er-notification-border-color</span>: <span class="built_in">var</span>(--er-border-color-lighter);</span><br><span class="line">  <span class="attr">--er-notification-icon-size</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attr">--er-notification-close-font-size</span>: <span class="built_in">var</span>(--er-message-close-size, <span class="number">16px</span>);</span><br><span class="line">  <span class="attr">--er-notification-content-font-size</span>: <span class="built_in">var</span>(--er-font-size-base);</span><br><span class="line">  <span class="attr">--er-notification-content-color</span>: <span class="built_in">var</span>(--er-text-color-regular);</span><br><span class="line">  <span class="attr">--er-notification-title-font-size</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attr">--er-notification-title-color</span>: <span class="built_in">var</span>(--er-text-color-primary);</span><br><span class="line">  <span class="attr">--er-notification-close-color</span>: <span class="built_in">var</span>(--er-text-color-secondary);</span><br><span class="line">  <span class="attr">--er-notification-close-hover-color</span>: <span class="built_in">var</span>(--er-text-color-regular)</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-notification</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">width</span>: <span class="built_in">var</span>(--er-notification-width);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="built_in">var</span>(--er-notification-padding);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--er-notification-radius);</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-notification-border-color);</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-bg-color-overlay);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--er-notification-shadow);</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="built_in">var</span>(--er-transition-duration),transform <span class="built_in">var</span>(--er-transition-duration),right <span class="built_in">var</span>(--er-transition-duration),top .<span class="number">4s</span>,bottom <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">  <span class="attribute">overflow-wrap</span>: anywhere;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">9999</span>;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.right</span> &#123;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.left</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.er-notification__text</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-notification__icon</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">var</span>(--er-notification-icon-size);</span><br><span class="line">    <span class="attribute">width</span>: <span class="built_in">var</span>(--er-notification-icon-size);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-notification-icon-size);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-notification-icon-color);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.er-notification__title</span> &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-notification-title-font-size);</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="built_in">var</span>(--er-notification-icon-size);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-notification-title-color);</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-notification__content</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-notification-content-font-size);</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">6px</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-notification-content-color);</span><br><span class="line">    <span class="attribute">text-align</span>: justify</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-notification__close</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-notification-close-color);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-notification-close-font-size)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@each</span> $val in info,success,warning,danger &#123; </span><br><span class="line">  <span class="selector-class">.er-notification--</span>$(val) &#123;</span><br><span class="line">    <span class="attr">--er-notification-icon-color</span>: <span class="built_in">var</span>(--er-color-$(val));</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--el-notification-icon-color);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-notification--error</span> &#123;</span><br><span class="line">  <span class="attr">--er-notification-icon-color</span>: <span class="built_in">var</span>(--er-color-danger);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--el-notification-icon-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-notification-fade-enter-from</span> &#123;</span><br><span class="line">  &amp;<span class="selector-class">.right</span>&#123;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.left</span>&#123;</span><br><span class="line">    <span class="attribute">left</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-notification-fade-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-11"><a href="#└─-types-ts-11" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">VNode</span>, <span class="title class_">ComponentInternalInstance</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> notificationTypes = [</span><br><span class="line">  <span class="string">&quot;info&quot;</span>,</span><br><span class="line">  <span class="string">&quot;success&quot;</span>,</span><br><span class="line">  <span class="string">&quot;warning&quot;</span>,</span><br><span class="line">  <span class="string">&quot;danger&quot;</span>,</span><br><span class="line">] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> notificationType = (<span class="keyword">typeof</span> notificationTypes)[<span class="built_in">number</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> notificationPosition = [</span><br><span class="line">  <span class="string">&quot;top-right&quot;</span>,</span><br><span class="line">  <span class="string">&quot;top-left&quot;</span>,</span><br><span class="line">  <span class="string">&quot;bottom-right&quot;</span>,</span><br><span class="line">  <span class="string">&quot;bottom-left&quot;</span>,</span><br><span class="line">] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">NotificationPosition</span> = (<span class="keyword">typeof</span> notificationPosition)[<span class="built_in">number</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">NotificationProps</span> &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">zIndex</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">position</span>: <span class="title class_">NotificationPosition</span>;</span><br><span class="line">  <span class="attr">type</span>?: <span class="string">&quot;success&quot;</span> | <span class="string">&quot;info&quot;</span> | <span class="string">&quot;warning&quot;</span> | <span class="string">&quot;danger&quot;</span> | <span class="string">&quot;error&quot;</span>;</span><br><span class="line">  <span class="attr">message</span>?: <span class="built_in">string</span> | <span class="title class_">VNode</span>;</span><br><span class="line">  <span class="attr">duration</span>?: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">showClose</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">offset</span>?: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">transitionName</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">icon</span>?: <span class="built_in">string</span>;</span><br><span class="line">  onClick?(): <span class="built_in">void</span>;</span><br><span class="line">  onClose?(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">onDestory</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">NotificationInstance</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">vnode</span>: <span class="title class_">VNode</span>;</span><br><span class="line">  <span class="attr">vm</span>: <span class="title class_">ComponentInternalInstance</span>;</span><br><span class="line">  <span class="attr">props</span>: <span class="title class_">NotificationProps</span>;</span><br><span class="line">  <span class="attr">handler</span>: <span class="title class_">NotificationHandler</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CreateNotificationProps</span> = <span class="title class_">Omit</span>&lt;</span><br><span class="line">  <span class="title class_">NotificationProps</span>,</span><br><span class="line">  <span class="string">&quot;onDestory&quot;</span> | <span class="string">&quot;id&quot;</span> | <span class="string">&quot;zIndex&quot;</span></span><br><span class="line">&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">NotificationHandler</span> &#123;</span><br><span class="line">  <span class="title function_">close</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">NotificationOptions</span> = <span class="title class_">Partial</span>&lt;<span class="title class_">Omit</span>&lt;<span class="title class_">NotificationProps</span>, <span class="string">&quot;id&quot;</span>&gt;&gt;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">NotificationParams</span> = <span class="built_in">string</span> | <span class="title class_">VNode</span> | <span class="title class_">NotificationOptions</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">NotificationFn</span> = &#123;</span><br><span class="line">  (<span class="attr">props</span>: <span class="title class_">NotificationParams</span>): <span class="title class_">NotificationHandler</span>;</span><br><span class="line">  <span class="title function_">closeAll</span>(<span class="attr">type</span>?: notificationType): <span class="built_in">void</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">NotificationTypeFn</span> = <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="attr">props</span>: <span class="title class_">NotificationParams</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> <span class="title class_">NotificationHandler</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">Notification</span> <span class="keyword">extends</span> <span class="title class_">NotificationFn</span> &#123;</span><br><span class="line">  <span class="attr">success</span>: <span class="title class_">NotificationTypeFn</span>;</span><br><span class="line">  <span class="attr">warning</span>: <span class="title class_">NotificationTypeFn</span>;</span><br><span class="line">  <span class="attr">info</span>: <span class="title class_">NotificationTypeFn</span>;</span><br><span class="line">  <span class="attr">danger</span>: <span class="title class_">NotificationTypeFn</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Overlay"><a href="#├─-Overlay" class="headerlink" title="├─ Overlay"></a>├─ Overlay</h3><blockquote>
<p>遮罩层组件，用于覆盖页面内容</p>
</blockquote>
<h4 id="–API–-11"><a href="#–API–-11" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-Overlay-vue"><a href="#├─-Overlay-vue" class="headerlink" title="├─ Overlay.vue"></a>├─ Overlay.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; OverlayProps, OverlayEmits &#125; from &quot;./types&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123; name: &quot;ErOverlay&quot; &#125;);</span><br><span class="line">withDefaults(defineProps&lt;OverlayProps&gt;(), &#123;</span><br><span class="line">  mask: true,</span><br><span class="line">&#125;);</span><br><span class="line">const emits = defineEmits&lt;OverlayEmits&gt;();</span><br><span class="line"></span><br><span class="line">function onMaskClick(e: MouseEvent) &#123;</span><br><span class="line">  emits(&quot;click&quot;, e);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    v-if=&quot;mask&quot;</span><br><span class="line">    class=&quot;er-overlay&quot;</span><br><span class="line">    :class=&quot;overlayClass&quot;</span><br><span class="line">    :style=&quot;&#123; zIndex: zIndex &#125;&quot;</span><br><span class="line">    @click=&quot;onMaskClick&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    v-else</span><br><span class="line">    :class=&quot;overlayClass&quot;</span><br><span class="line">    :style=&quot;&#123;</span><br><span class="line">      zIndex: zIndex,</span><br><span class="line">      position: &#x27;fixed&#x27;,</span><br><span class="line">      top: 0,</span><br><span class="line">      left: 0,</span><br><span class="line">      right: 0,</span><br><span class="line">      bottom: 0,</span><br><span class="line">    &#125;&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.er-overlay &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  top: 0;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  bottom: 0;</span><br><span class="line">  height: 100%;</span><br><span class="line">  background-color: rgba(0, 0, 0, 0.5);</span><br><span class="line">  overflow: auto;</span><br><span class="line">  z-index: 2000;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-12"><a href="#└─-types-ts-12" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">OverlayProps</span> &#123;</span><br><span class="line">  <span class="attr">mask</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">zIndex</span>?: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">overlayClass</span>?: <span class="built_in">string</span> | <span class="built_in">string</span>[] | <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">boolean</span>&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">OverlayEmits</span> &#123;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;click&quot;</span>, <span class="attr">value</span>: <span class="title class_">MouseEvent</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Popconfirm"><a href="#├─-Popconfirm" class="headerlink" title="├─ Popconfirm"></a>├─ Popconfirm</h3><blockquote>
<p>气泡确认框</p>
</blockquote>
<h4 id="–API–-12"><a href="#–API–-12" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-index-ts-13"><a href="#├─-index-ts-13" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Popconfirm</span> <span class="keyword">from</span> <span class="string">&quot;./Popconfirm.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErPopconfirm</span> = <span class="title function_">withInstall</span>(<span class="title class_">Popconfirm</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-Popconfirm-test-tsx"><a href="#├─-Popconfirm-test-tsx" class="headerlink" title="├─ Popconfirm.test.tsx"></a>├─ Popconfirm.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, it, test, expect, vi, beforeEach &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&quot;@vue/test-utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; each, get &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">PopconfirmProps</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ErPopconfirm</span> &#125; <span class="keyword">from</span> <span class="string">&quot;.&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Popconfirm</span> <span class="keyword">from</span> <span class="string">&quot;./Popconfirm.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> onConfirm = vi.<span class="title function_">fn</span>();</span><br><span class="line"><span class="keyword">const</span> onCancel = vi.<span class="title function_">fn</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Popconfirm/index.ts&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 测试 withInstall 函数是否被正确应用</span></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should be exported with withInstall()&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">ErPopconfirm</span>.<span class="property">install</span>).<span class="title function_">toBeDefined</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 测试 Popconfirm 组件是否被正确导出</span></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should be exported Popconfirm component&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">ErPopconfirm</span>).<span class="title function_">toBe</span>(<span class="title class_">Popconfirm</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 可选：测试 withInstall 是否增强了 Popconfirm 组件的功能</span></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;should enhance Popconfirm component&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> enhancedPopconfirm = <span class="title function_">withInstall</span>(<span class="title class_">Popconfirm</span>);</span><br><span class="line">    <span class="title function_">expect</span>(enhancedPopconfirm).<span class="title function_">toBe</span>(<span class="title class_">ErPopconfirm</span>);</span><br><span class="line">    <span class="comment">// 这里可以添加更多测试，确保 withInstall 增强了组件的特定功能</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 可选：如果你的 withInstall 函数有特定的行为或属性，确保它们被正确应用</span></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;should apply specific enhancements&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span>  enhancedPopconfirm  = <span class="title function_">withInstall</span>(<span class="title class_">Popconfirm</span>);</span><br><span class="line">    <span class="comment">// 例如，如果你的 withInstall 增加了一个特定的方法或属性</span></span><br><span class="line">    <span class="title function_">expect</span>(enhancedPopconfirm).<span class="title function_">toHaveProperty</span>(<span class="string">&quot;install&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试组件是否能够接收所有 props</span></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Popconfirm.vue&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> props = &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;Test Title&quot;</span>,</span><br><span class="line">    <span class="attr">confirmButtonText</span>: <span class="string">&quot;Confirm&quot;</span>,</span><br><span class="line">    <span class="attr">cancelButtonText</span>: <span class="string">&quot;Cancel&quot;</span>,</span><br><span class="line">    <span class="attr">confirmButtonType</span>: <span class="string">&quot;primary&quot;</span>,</span><br><span class="line">    <span class="attr">cancelButtonType</span>: <span class="string">&quot;info&quot;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&quot;check-circle&quot;</span>,</span><br><span class="line">    <span class="attr">iconColor</span>: <span class="string">&quot;green&quot;</span>,</span><br><span class="line">    <span class="attr">hideIcon</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">hideAfter</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="attr">width</span>: <span class="number">200</span>,</span><br><span class="line">  &#125; <span class="keyword">as</span> <span class="title class_">PopconfirmProps</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    vi.<span class="title function_">useFakeTimers</span>();</span><br><span class="line">    vi.<span class="title function_">clearAllMocks</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should accept all props&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Popconfirm</span>, &#123;</span><br><span class="line">      props,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查 props 是否被正确设置</span></span><br><span class="line">    <span class="title function_">each</span>(<span class="title class_">Object</span>.<span class="title function_">keys</span>(props), <span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">expect</span>(<span class="title function_">get</span>(wrapper.<span class="title function_">props</span>(), key)).<span class="title function_">toBe</span>(<span class="title function_">get</span>(props, key));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 测试插槽内容</span></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should renders slot content correctly&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> slotContent = <span class="string">&quot;Slot Content&quot;</span>;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Popconfirm</span>, &#123;</span><br><span class="line">      props,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: slotContent,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(slotContent);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;popconfirm emits&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="function">() =&gt;</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;outside&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Popconfirm</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">title</span>=<span class="string">&quot;Test Title&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">hideIcon</span>=<span class="string">&#123;true&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onConfirm</span>=<span class="string">&#123;onConfirm&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onCancel</span>=<span class="string">&#123;onCancel&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;trigger&quot;</span>&gt;</span>trigger<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Popconfirm</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    ));</span><br><span class="line">    <span class="keyword">const</span> triggerArea = wrapper.<span class="title function_">find</span>(<span class="string">&quot;#trigger&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(triggerArea.<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line"></span><br><span class="line">    triggerArea.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 弹出层是否出现</span></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-popconfirm&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="keyword">const</span> confirmButton = wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-popconfirm__confirm&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(confirmButton.<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line"></span><br><span class="line">    confirmButton.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-popconfirm&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(onConfirm).<span class="title function_">toBeCalled</span>();</span><br><span class="line"></span><br><span class="line">    triggerArea.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-popconfirm&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="keyword">const</span> cancelButton = wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-popconfirm__cancel&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(cancelButton.<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    cancelButton.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-popconfirm&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(onCancel).<span class="title function_">toBeCalled</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="├─-Popconfirm-vue"><a href="#├─-Popconfirm-vue" class="headerlink" title="├─ Popconfirm.vue"></a>├─ Popconfirm.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123; ref, computed &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; addUnit &#125; from &quot;@eric-ui/utils&quot;;</span><br><span class="line">import type &#123; PopconfirmProps, PopconfirmEmits &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; useLocale &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line">import type &#123; TooltipInstance &#125; from &quot;../Tooltip&quot;;</span><br><span class="line"></span><br><span class="line">import ErButton from &quot;../Button/Button.vue&quot;;</span><br><span class="line">import ErIcon from &quot;../Icon/Icon.vue&quot;;</span><br><span class="line">import ErTooltip from &quot;../Tooltip/Tooltip.vue&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErPopconfirm&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const props = withDefaults(defineProps&lt;PopconfirmProps&gt;(), &#123;</span><br><span class="line">  title: &quot;&quot;,</span><br><span class="line">  confirmButtonType: &quot;primary&quot;,</span><br><span class="line">  icon: &quot;question-circle&quot;,</span><br><span class="line">  iconColor: &quot;#f90&quot;,</span><br><span class="line">  hideAfter: 200,</span><br><span class="line">  width: 150,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const emits = defineEmits&lt;PopconfirmEmits&gt;();</span><br><span class="line">const tooltipRef = ref&lt;TooltipInstance&gt;();</span><br><span class="line">const style = computed(() =&gt; (&#123; width: addUnit(props.width) &#125;));</span><br><span class="line"></span><br><span class="line">const &#123; t &#125; = useLocale();</span><br><span class="line"></span><br><span class="line">function hidePopper() &#123;</span><br><span class="line">  tooltipRef.value?.hide();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function confirm(e: MouseEvent) &#123;</span><br><span class="line">  emits(&quot;confirm&quot;, e);</span><br><span class="line">  hidePopper();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function cancel(e: MouseEvent) &#123;</span><br><span class="line">  emits(&quot;cancel&quot;, e);</span><br><span class="line">  hidePopper();</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;er-tooltip ref=&quot;tooltipRef&quot; trigger=&quot;click&quot; :hide-timeout=&quot;hideAfter&quot;&gt;</span><br><span class="line">    &lt;template #content&gt;</span><br><span class="line">      &lt;div class=&quot;er-popconfirm&quot; :style=&quot;style&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;er-popconfirm__main&quot;&gt;</span><br><span class="line">          &lt;er-icon v-if=&quot;!hideIcon &amp;&amp; icon&quot; :icon=&quot;icon&quot; :color=&quot;iconColor&quot; /&gt;</span><br><span class="line">          &#123;&#123; title &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;er-popconfirm__action&quot;&gt;</span><br><span class="line">          &lt;er-button</span><br><span class="line">            size=&quot;small&quot;</span><br><span class="line">            class=&quot;er-popconfirm__cancel&quot;</span><br><span class="line">            :type=&quot;cancelButtonType&quot;</span><br><span class="line">            @click=&quot;cancel&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &#123;&#123; cancelButtonText || t(&quot;popconfirm.cancelButtonText&quot;) &#125;&#125;</span><br><span class="line">          &lt;/er-button&gt;</span><br><span class="line">          &lt;er-button</span><br><span class="line">            size=&quot;small&quot;</span><br><span class="line">            class=&quot;er-popconfirm__confirm&quot;</span><br><span class="line">            :type=&quot;confirmButtonType&quot;</span><br><span class="line">            @click=&quot;confirm&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &#123;&#123; confirmButtonText || t(&quot;popconfirm.confirmButtonText&quot;) &#125;&#125;</span><br><span class="line">          &lt;/er-button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">    &lt;template v-if=&quot;$slots.default&quot; #default&gt;</span><br><span class="line">      &lt;slot name=&quot;default&quot;&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">    &lt;template v-if=&quot;$slots.reference&quot; #default&gt;</span><br><span class="line">      &lt;slot name=&quot;reference&quot;&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">  &lt;/er-tooltip&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-11"><a href="#├─-style-css-11" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-popconfirm</span> &#123;</span><br><span class="line">  <span class="selector-class">.er-popconfirm__main</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="selector-tag">i</span> &#123;</span><br><span class="line">      <span class="attribute">margin-right</span>: <span class="number">5px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-popconfirm__action</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: right;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">8px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-13"><a href="#└─-types-ts-13" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ButtonType</span> &#125; <span class="keyword">from</span> <span class="string">&quot;../Button&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">PopconfirmProps</span> &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">confirmButtonText</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">cancelButtonText</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">confirmButtonType</span>?: <span class="title class_">ButtonType</span>;</span><br><span class="line">  <span class="attr">cancelButtonType</span>?: <span class="title class_">ButtonType</span>;</span><br><span class="line">  <span class="attr">icon</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">iconColor</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">hideIcon</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">hideAfter</span>?: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">width</span>?: <span class="built_in">number</span> | <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">PopconfirmEmits</span> &#123;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;confirm&quot;</span>, <span class="attr">value</span>: <span class="title class_">MouseEvent</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;cancel&quot;</span>, <span class="attr">value</span>: <span class="title class_">MouseEvent</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Select"><a href="#├─-Select" class="headerlink" title="├─ Select"></a>├─ Select</h3><blockquote>
<p>下拉选择框组件，用于从一组选项中选择一个或多个值</p>
</blockquote>
<h4 id="–API–-13"><a href="#–API–-13" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-constants-ts-5"><a href="#├─-constants-ts-5" class="headerlink" title="├─ constants.ts"></a>├─ constants.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">InjectionKey</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">SelectContext</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">SELECT_CTX_KEY</span>: <span class="title class_">InjectionKey</span>&lt;<span class="title class_">SelectContext</span>&gt; =</span><br><span class="line">  <span class="title class_">Symbol</span>(<span class="string">&quot;selectContext&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">POPPER_OPTIONS</span>: <span class="built_in">any</span> = &#123;</span><br><span class="line">  <span class="attr">modifiers</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;offset&quot;</span>,</span><br><span class="line">      <span class="attr">options</span>: &#123;</span><br><span class="line">        <span class="attr">offset</span>: [<span class="number">0</span>, <span class="number">9</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;sameWidth&quot;</span>,</span><br><span class="line">      <span class="attr">enabled</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">fn</span>: <span class="function">(<span class="params">&#123; state &#125;: &#123; state: <span class="built_in">any</span> &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">styles</span>.<span class="property">popper</span>.<span class="property">width</span> = <span class="string">`<span class="subst">$&#123;state.rects.reference.width&#125;</span>px`</span>;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">phase</span>: <span class="string">&quot;beforeWrite&quot;</span>,</span><br><span class="line">      <span class="attr">requires</span>: [<span class="string">&quot;computeStyles&quot;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125; <span class="keyword">as</span> <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-index-ts-14"><a href="#├─-index-ts-14" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Select</span> <span class="keyword">from</span> <span class="string">&quot;./Select.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Option</span> <span class="keyword">from</span> <span class="string">&quot;./Option.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErSelect</span> = <span class="title function_">withInstall</span>(<span class="title class_">Select</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErOption</span> = <span class="title function_">withInstall</span>(<span class="title class_">Option</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-Option-vue"><a href="#├─-Option-vue" class="headerlink" title="├─ Option.vue"></a>├─ Option.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; SelectOptionProps &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; SELECT_CTX_KEY &#125; from &quot;./constants&quot;;</span><br><span class="line">import &#123; get, eq, every &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import &#123; computed, inject &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; RenderVnode &#125; from &quot;@eric-ui/utils&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErOption&quot;,</span><br><span class="line">&#125;);</span><br><span class="line">const props = withDefaults(defineProps&lt;SelectOptionProps&gt;(), &#123;</span><br><span class="line">  disabled: false,</span><br><span class="line">&#125;);</span><br><span class="line">const ctx = inject(SELECT_CTX_KEY);</span><br><span class="line">const selected = computed(</span><br><span class="line">  () =&gt; ctx?.selectStates?.selectedOption?.value === props.value</span><br><span class="line">);</span><br><span class="line">const isHighlighted = computed(() =&gt;</span><br><span class="line">  every([&quot;label&quot;, &quot;value&quot;], (key) =&gt;</span><br><span class="line">    eq(get(ctx, [&quot;highlightedLine&quot;, &quot;value&quot;, key]), get(props, key))</span><br><span class="line">  )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">function handleClick() &#123;</span><br><span class="line">  if (props.disabled) return;</span><br><span class="line">  ctx?.handleSelect(props);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;li</span><br><span class="line">    class=&quot;er-select__menu-item&quot;</span><br><span class="line">    :class=&quot;&#123;</span><br><span class="line">      &#x27;is-disabled&#x27;: disabled,</span><br><span class="line">      &#x27;is-selected&#x27;: selected,</span><br><span class="line">      &#x27;is-highlighted&#x27;: isHighlighted,</span><br><span class="line">    &#125;&quot;</span><br><span class="line">    :id=&quot;`select-item-$&#123;value&#125;`&quot;</span><br><span class="line">    @click.stop=&quot;handleClick&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;slot&gt;</span><br><span class="line">      &lt;render-vnode</span><br><span class="line">        :vNode=&quot;ctx?.renderLabel ? ctx?.renderLabel(props) : label&quot;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/slot&gt;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-Select-vue"><a href="#├─-Select-vue" class="headerlink" title="├─ Select.vue"></a>├─ Select.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123;</span><br><span class="line">  assign,</span><br><span class="line">  find,</span><br><span class="line">  get,</span><br><span class="line">  each,</span><br><span class="line">  noop,</span><br><span class="line">  isFunction,</span><br><span class="line">  filter,</span><br><span class="line">  isNil,</span><br><span class="line">  isBoolean,</span><br><span class="line">  includes,</span><br><span class="line">  map,</span><br><span class="line">  size,</span><br><span class="line">  eq,</span><br><span class="line">  debounce,</span><br><span class="line">&#125; from &quot;lodash-es&quot;;</span><br><span class="line">import &#123;</span><br><span class="line">  ref,</span><br><span class="line">  reactive,</span><br><span class="line">  computed,</span><br><span class="line">  onMounted,</span><br><span class="line">  provide,</span><br><span class="line">  useSlots,</span><br><span class="line">  watch,</span><br><span class="line">  h,</span><br><span class="line">  nextTick,</span><br><span class="line">  type Ref,</span><br><span class="line">  type VNode,</span><br><span class="line">&#125; from &quot;vue&quot;;</span><br><span class="line">import type &#123;</span><br><span class="line">  SelectProps,</span><br><span class="line">  SelectEmits,</span><br><span class="line">  SelectOptionProps,</span><br><span class="line">  SelectContext,</span><br><span class="line">  SelectInstance,</span><br><span class="line">  SelectStates,</span><br><span class="line">&#125; from &quot;./types&quot;;</span><br><span class="line">import type &#123; TooltipInstance &#125; from &quot;../Tooltip/types&quot;;</span><br><span class="line">import type &#123; InputInstance &#125; from &quot;../Input/types&quot;;</span><br><span class="line">import &#123; RenderVnode, debugWarn &#125; from &quot;@eric-ui/utils&quot;;</span><br><span class="line">import &#123; useFocusController, useClickOutside &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line">import &#123; SELECT_CTX_KEY, POPPER_OPTIONS &#125; from &quot;./constants&quot;;</span><br><span class="line">import &#123; useFormItem, useFormDisabled, useFormItemInputId &#125; from &quot;../Form&quot;;</span><br><span class="line"></span><br><span class="line">import useKeyMap from &quot;./useKeyMap&quot;;</span><br><span class="line">import ErTooltip from &quot;../Tooltip/Tooltip.vue&quot;;</span><br><span class="line">import ErIcon from &quot;../Icon/Icon.vue&quot;;</span><br><span class="line">import ErInput from &quot;../Input/Input.vue&quot;;</span><br><span class="line">import ErOption from &quot;./Option.vue&quot;;</span><br><span class="line"></span><br><span class="line">const COMPONENT_NAME = &quot;ErSelect&quot; as const;</span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: COMPONENT_NAME,</span><br><span class="line">&#125;);</span><br><span class="line">const props = withDefaults(defineProps&lt;SelectProps&gt;(), &#123;</span><br><span class="line">  options: () =&gt; [],</span><br><span class="line">&#125;);</span><br><span class="line">const emits = defineEmits&lt;SelectEmits&gt;();</span><br><span class="line"></span><br><span class="line">const initialOption = findOption(props.modelValue);</span><br><span class="line"></span><br><span class="line">const selectRef = ref&lt;HTMLElement&gt;();</span><br><span class="line">const tooltipRef = ref&lt;TooltipInstance&gt;();</span><br><span class="line">const inputRef = ref&lt;InputInstance&gt;();</span><br><span class="line"></span><br><span class="line">const isDropdownVisible = ref(false);</span><br><span class="line">const filteredOptions = ref(props.options ?? []);</span><br><span class="line">const filteredChilds: Ref&lt;Map&lt;VNode, SelectOptionProps&gt;&gt; = ref(new Map());</span><br><span class="line"></span><br><span class="line">const selectStates = reactive&lt;SelectStates&gt;(&#123;</span><br><span class="line">  inputValue: initialOption?.label ?? &quot;&quot;,</span><br><span class="line">  selectedOption: initialOption,</span><br><span class="line">  mouseHover: false,</span><br><span class="line">  loading: false,</span><br><span class="line">  highlightedIndex: -1,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const slots = useSlots();</span><br><span class="line">const isDisabled = useFormDisabled();</span><br><span class="line">const &#123; formItem &#125; = useFormItem();</span><br><span class="line">const &#123; inputId &#125; = useFormItemInputId(props, formItem);</span><br><span class="line">const &#123;</span><br><span class="line">  wrapperRef: inputWrapperRef,</span><br><span class="line">  isFocused,</span><br><span class="line">  handleBlur,</span><br><span class="line">  handleFocus,</span><br><span class="line">&#125; = useFocusController(inputRef);</span><br><span class="line"></span><br><span class="line">useClickOutside(selectRef, (e) =&gt; handleClickOutsie(e));</span><br><span class="line"></span><br><span class="line">const highlightedLine = computed(() =&gt; &#123;</span><br><span class="line">  let result: SelectOptionProps | void;</span><br><span class="line">  if (hasChildren.value) &#123;</span><br><span class="line">    const node = [...filteredChilds.value][selectStates.highlightedIndex]?.[0];</span><br><span class="line">    result = filteredChilds.value.get(node);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    result = filteredOptions.value[selectStates.highlightedIndex];</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const children = computed(() =&gt;</span><br><span class="line">  filter(slots?.default?.(), (child) =&gt; eq(child.type, ErOption))</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const hasChildren = computed(() =&gt; size(children.value) &gt; 0);</span><br><span class="line">const childrenOptsions = computed(() =&gt; &#123;</span><br><span class="line">  if (!hasChildren.value) return [];</span><br><span class="line">  return map(children.value, (item) =&gt; (&#123;</span><br><span class="line">    vNode: h(item),</span><br><span class="line">    props: assign(item.props, &#123;</span><br><span class="line">      disabled:</span><br><span class="line">        item.props?.disabled === true ||</span><br><span class="line">        (!isNil(item.props?.disabled) &amp;&amp; !isBoolean(item.props?.disabled)),</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const filterPlaceholder = computed(() =&gt; &#123;</span><br><span class="line">  return props.filterable &amp;&amp;</span><br><span class="line">    selectStates.selectedOption &amp;&amp;</span><br><span class="line">    isDropdownVisible.value</span><br><span class="line">    ? selectStates.selectedOption.label</span><br><span class="line">    : props.placeholder;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const timeout = computed(() =&gt; (props.remote ? 300 : 0));</span><br><span class="line"></span><br><span class="line">const hasData = computed(</span><br><span class="line">  () =&gt;</span><br><span class="line">    (hasChildren.value &amp;&amp; filteredChilds.value.size &gt; 0) ||</span><br><span class="line">    (!hasChildren.value &amp;&amp; size(filteredOptions.value) &gt; 0)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const isNoData = computed(() =&gt; &#123;</span><br><span class="line">  if (!props.filterable) return false;</span><br><span class="line">  if (!hasData.value) return true;</span><br><span class="line">  return false;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const lastIndex = computed(() =&gt;</span><br><span class="line">  hasChildren.value</span><br><span class="line">    ? filteredChilds.value.size - 1</span><br><span class="line">    : size(filteredOptions.value) - 1</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const showClear = computed(</span><br><span class="line">  () =&gt;</span><br><span class="line">    props.clearable &amp;&amp; selectStates.mouseHover &amp;&amp; selectStates.inputValue !== &quot;&quot;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const handleFilterDebounce = debounce(handleFilter, timeout.value);</span><br><span class="line"></span><br><span class="line">const keyMap = useKeyMap(&#123;</span><br><span class="line">  isDropdownVisible,</span><br><span class="line">  controlVisible,</span><br><span class="line">  selectStates,</span><br><span class="line">  highlightedLine,</span><br><span class="line">  handleSelect,</span><br><span class="line">  hasData,</span><br><span class="line">  lastIndex,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const focus: SelectInstance[&quot;focus&quot;] = function () &#123;</span><br><span class="line">  inputRef.value?.focus();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const blur: SelectInstance[&quot;blur&quot;] = function () &#123;</span><br><span class="line">  handleClickOutsie();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function setFilteredChilds(opts: typeof childrenOptsions.value) &#123;</span><br><span class="line">  filteredChilds.value.clear();</span><br><span class="line">  each(opts, (item) =&gt; &#123;</span><br><span class="line">    filteredChilds.value.set(item.vNode, item.props as SelectOptionProps);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function renderLabel(opt: SelectOptionProps): VNode | string &#123;</span><br><span class="line">  if (isFunction(props.renderLabel)) &#123;</span><br><span class="line">    return props.renderLabel(opt);</span><br><span class="line">  &#125;</span><br><span class="line">  return opt.label;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function controlVisible(visible: boolean) &#123;</span><br><span class="line">  if (!tooltipRef.value) return;</span><br><span class="line">  get(tooltipRef, [&quot;value&quot;, visible ? &quot;show&quot; : &quot;hide&quot;])?.();</span><br><span class="line">  props.filterable &amp;&amp; controlInputVal(visible);</span><br><span class="line">  isDropdownVisible.value = visible;</span><br><span class="line">  emits(&quot;visible-change&quot;, visible);</span><br><span class="line"></span><br><span class="line">  selectStates.highlightedIndex = -1;</span><br><span class="line">&#125;</span><br><span class="line">function controlInputVal(visible: boolean) &#123;</span><br><span class="line">  if (!props.filterable) return;</span><br><span class="line">  if (visible) &#123;</span><br><span class="line">    if (selectStates.selectedOption) selectStates.inputValue = &quot;&quot;;</span><br><span class="line">    handleFilterDebounce();</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    selectStates.inputValue = selectStates.selectedOption?.label || &quot;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">function toggleVisible() &#123;</span><br><span class="line">  if (isDisabled.value) return;</span><br><span class="line">  controlVisible(!isDropdownVisible.value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function findOption(value: string) &#123;</span><br><span class="line">  return find(props.options, (option) =&gt; option.value === value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleClickOutsie(e?: Event) &#123;</span><br><span class="line">  if (isFocused.value) &#123;</span><br><span class="line">    nextTick(() =&gt; handleBlur(new FocusEvent(&quot;focus&quot;, e)));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleSelect(o: SelectOptionProps) &#123;</span><br><span class="line">  if (o.disabled) return;</span><br><span class="line"></span><br><span class="line">  selectStates.inputValue = o.label;</span><br><span class="line">  selectStates.selectedOption = o;</span><br><span class="line">  each([&quot;change&quot;, &quot;update:modelValue&quot;], (k) =&gt; emits(k as any, o.value));</span><br><span class="line">  controlVisible(false);</span><br><span class="line">  inputRef.value?.focus();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function setSelected() &#123;</span><br><span class="line">  const option = findOption(props.modelValue);</span><br><span class="line">  if (!option) return;</span><br><span class="line">  selectStates.inputValue = option.label;</span><br><span class="line">  selectStates.selectedOption = option;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleClear() &#123;</span><br><span class="line">  inputRef.value?.clear();</span><br><span class="line">  selectStates.inputValue = &quot;&quot;;</span><br><span class="line">  selectStates.selectedOption = null;</span><br><span class="line"></span><br><span class="line">  emits(&quot;clear&quot;);</span><br><span class="line">  each([&quot;change&quot;, &quot;update:modelValue&quot;], (k) =&gt; emits(k as any, &quot;&quot;));</span><br><span class="line">  formItem?.clearValidate();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">async function callRemoteMethod(method: Function, search: string) &#123;</span><br><span class="line">  if (!method || !isFunction(method)) return;</span><br><span class="line"></span><br><span class="line">  selectStates.loading = true;</span><br><span class="line">  let result;</span><br><span class="line">  try &#123;</span><br><span class="line">    result = await method(search);</span><br><span class="line">  &#125; catch (error) &#123;</span><br><span class="line">    debugWarn(error as Error);</span><br><span class="line">    debugWarn(COMPONENT_NAME, &quot;callRemoteMethod error&quot;);</span><br><span class="line">    result = [];</span><br><span class="line">    return Promise.reject(error);</span><br><span class="line">  &#125; finally &#123;</span><br><span class="line">    selectStates.loading = false;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">async function genFilterOptions(search: string) &#123;</span><br><span class="line">  if (!props.filterable) return;</span><br><span class="line"></span><br><span class="line">  if (props.remote &amp;&amp; props.remoteMethod &amp;&amp; isFunction(props.remoteMethod)) &#123;</span><br><span class="line">    filteredOptions.value = await callRemoteMethod(props.remoteMethod, search);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (props.filterMethod &amp;&amp; isFunction(props.filterMethod)) &#123;</span><br><span class="line">    filteredOptions.value = props.filterMethod(search);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  filteredOptions.value = filter(props.options, (opt) =&gt;</span><br><span class="line">    includes(opt.label, search)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">async function genFilterChilds(search: string) &#123;</span><br><span class="line">  if (!props.filterable) return;</span><br><span class="line"></span><br><span class="line">  if (props.remote &amp;&amp; props.remoteMethod &amp;&amp; isFunction(props.remoteMethod)) &#123;</span><br><span class="line">    await callRemoteMethod(props.remoteMethod, search);</span><br><span class="line">    setFilteredChilds(childrenOptsions.value);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  if (props.filterMethod &amp;&amp; isFunction(props.filterMethod)) &#123;</span><br><span class="line">    const options = map(props.filterMethod(search), &quot;value&quot;);</span><br><span class="line">    setFilteredChilds(</span><br><span class="line">      filter(childrenOptsions.value, (item) =&gt;</span><br><span class="line">        includes(options, get(item, [&quot;props&quot;, &quot;value&quot;]))</span><br><span class="line">      )</span><br><span class="line">    );</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  setFilteredChilds(</span><br><span class="line">    filter(childrenOptsions.value, (item) =&gt;</span><br><span class="line">      includes(get(item, [&quot;props&quot;, &quot;label&quot;]), search)</span><br><span class="line">    )</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleFilter() &#123;</span><br><span class="line">  const searchKey = selectStates.inputValue;</span><br><span class="line">  selectStates.highlightedIndex = -1;</span><br><span class="line"></span><br><span class="line">  if (hasChildren.value) &#123;</span><br><span class="line">    genFilterChilds(searchKey);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  genFilterOptions(searchKey);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleKeyDown(e: KeyboardEvent) &#123;</span><br><span class="line">  keyMap.has(e.key) &amp;&amp; keyMap.get(e.key)?.(e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  () =&gt; props.options,</span><br><span class="line">  (newOpts) =&gt; &#123;</span><br><span class="line">    filteredOptions.value = newOpts ?? [];</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  () =&gt; childrenOptsions.value,</span><br><span class="line">  (newOpts) =&gt; setFilteredChilds(newOpts),</span><br><span class="line">  &#123; immediate: true &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  () =&gt; props.modelValue,</span><br><span class="line">  (newVal, oldVal) =&gt; &#123;</span><br><span class="line">    if (newVal !== oldVal) &#123;</span><br><span class="line">      formItem?.validate(&quot;change&quot;).catch((err) =&gt; debugWarn(err));</span><br><span class="line">    &#125;</span><br><span class="line">    setSelected();</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  setSelected();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">provide&lt;SelectContext&gt;(SELECT_CTX_KEY, &#123;</span><br><span class="line">  handleSelect,</span><br><span class="line">  selectStates,</span><br><span class="line">  renderLabel,</span><br><span class="line">  highlightedLine,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">defineExpose&lt;SelectInstance&gt;(&#123;</span><br><span class="line">  focus,</span><br><span class="line">  blur,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    ref=&quot;selectRef&quot;</span><br><span class="line">    class=&quot;er-select&quot;</span><br><span class="line">    :class=&quot;&#123;</span><br><span class="line">      &#x27;is-disabled&#x27;: isDisabled,</span><br><span class="line">    &#125;&quot;</span><br><span class="line">    @click.stop=&quot;toggleVisible&quot;</span><br><span class="line">    @mouseenter=&quot;selectStates.mouseHover = true&quot;</span><br><span class="line">    @mouseleave=&quot;selectStates.mouseHover = false&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;er-tooltip</span><br><span class="line">      ref=&quot;tooltipRef&quot;</span><br><span class="line">      placement=&quot;bottom-start&quot;</span><br><span class="line">      :popper-options=&quot;POPPER_OPTIONS&quot;</span><br><span class="line">      @click-outside=&quot;controlVisible(false)&quot;</span><br><span class="line">      manual</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;template #default&gt;</span><br><span class="line">        &lt;div ref=&quot;inputWrapperRef&quot;&gt;</span><br><span class="line">          &lt;er-input</span><br><span class="line">            ref=&quot;inputRef&quot;</span><br><span class="line">            v-model=&quot;selectStates.inputValue&quot;</span><br><span class="line">            :id=&quot;inputId&quot;</span><br><span class="line">            :disabled=&quot;isDisabled&quot;</span><br><span class="line">            :placeholder=&quot;filterable ? filterPlaceholder : placeholder&quot;</span><br><span class="line">            :readonly=&quot;!filterable || !isDropdownVisible&quot;</span><br><span class="line">            @focus=&quot;handleFocus&quot;</span><br><span class="line">            @blur=&quot;handleBlur&quot;</span><br><span class="line">            @input=&quot;handleFilterDebounce&quot;</span><br><span class="line">            @keydown=&quot;handleKeyDown&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;template #suffix&gt;</span><br><span class="line">              &lt;er-icon</span><br><span class="line">                v-if=&quot;showClear&quot;</span><br><span class="line">                icon=&quot;circle-xmark&quot;</span><br><span class="line">                class=&quot;er-input__clear&quot;</span><br><span class="line">                @click.stop=&quot;handleClear&quot;</span><br><span class="line">                @mousedown.prevent=&quot;noop&quot;</span><br><span class="line">              /&gt;</span><br><span class="line">              &lt;er-icon</span><br><span class="line">                v-else</span><br><span class="line">                class=&quot;header-angle&quot;</span><br><span class="line">                icon=&quot;angle-down&quot;</span><br><span class="line">                :class=&quot;&#123; &#x27;is-active&#x27;: isDropdownVisible &#125;&quot;</span><br><span class="line">              /&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">          &lt;/er-input&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template #content&gt;</span><br><span class="line">        &lt;div class=&quot;er-select__loading&quot; v-if=&quot;selectStates.loading&quot;&gt;</span><br><span class="line">          &lt;er-icon icon=&quot;spinner&quot; spin /&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;er-select__nodata&quot; v-else-if=&quot;filterable &amp;&amp; isNoData&quot;&gt;</span><br><span class="line">          No data</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;ul class=&quot;er-select__menu&quot; v-else&gt;</span><br><span class="line">          &lt;template v-if=&quot;!hasChildren&quot;&gt;</span><br><span class="line">            &lt;er-option</span><br><span class="line">              v-for=&quot;item in filteredOptions&quot;</span><br><span class="line">              :key=&quot;item.value&quot;</span><br><span class="line">              v-bind=&quot;item&quot;</span><br><span class="line">            /&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">          &lt;template v-else&gt;</span><br><span class="line">            &lt;template</span><br><span class="line">              v-for=&quot;[vNode, _props] in filteredChilds&quot;</span><br><span class="line">              :key=&quot;_props.value&quot;</span><br><span class="line">            &gt;</span><br><span class="line">              &lt;render-vnode :vNode=&quot;vNode&quot; /&gt;</span><br><span class="line">            &lt;/template&gt;</span><br><span class="line">          &lt;/template&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/er-tooltip&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-12"><a href="#├─-style-css-12" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-select</span> &#123;</span><br><span class="line">  <span class="attr">--er-select-item-hover-bg-color</span>: <span class="built_in">var</span>(--er-fill-color-light);</span><br><span class="line">  <span class="attr">--er-select-item-font-size</span>: <span class="built_in">var</span>(--er-font-size-base);</span><br><span class="line">  <span class="attr">--er-select-item-font-color</span>: <span class="built_in">var</span>(--er-text-color-regular);</span><br><span class="line">  <span class="attr">--er-select-item-selected-font-color</span>: <span class="built_in">var</span>(--er-color-primary);</span><br><span class="line">  <span class="attr">--er-select-item-disabled-font-color</span>: <span class="built_in">var</span>(--er-text-color-placeholder);</span><br><span class="line">  <span class="attr">--er-select-input-focus-border-color</span>: <span class="built_in">var</span>(--er-color-primary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-select</span>&#123;</span><br><span class="line"> <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">32px</span>;</span><br><span class="line">  :<span class="built_in">deep</span>(.er-tooltip__popper) &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  :<span class="built_in">deep</span>(.er-input)&#123;</span><br><span class="line">    <span class="selector-class">.header-angle</span> &#123;</span><br><span class="line">      <span class="attribute">transition</span>: transform <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">      &amp;<span class="selector-class">.is-active</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">180deg</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.er-select__nodata</span>, <span class="selector-class">.er-select__loading</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-text-color-secondary);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-select-font-size);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-select__menu</span> &#123;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">6px</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-select__menu-item</span> &#123; </span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-select-item-font-size);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">32px</span> <span class="number">0</span> <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-select-item-font-color);</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">34px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">34px</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-select-item-hover-bg-color);</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.is-selected</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-select-item-selected-font-color);</span><br><span class="line">      <span class="attribute">font-weight</span>: <span class="number">700</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.is-highlighted</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-select-item-hover-bg-color);</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-class">.is-disabled</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-select-item-disabled-font-color);</span><br><span class="line">      <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">      &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: transparent;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  :<span class="built_in">deep</span>(.er-input__inner) &#123;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="├─-types-ts"><a href="#├─-types-ts" class="headerlink" title="├─ types.ts"></a>├─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">VNode</span>, <span class="title class_">ComputedRef</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">RenderLabelFunc</span> = <span class="function">(<span class="params"><span class="attr">option</span>: <span class="title class_">SelectOptionProps</span></span>) =&gt;</span> <span class="title class_">VNode</span> | <span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CustomFilterFunc</span> = <span class="function">(<span class="params"><span class="attr">value</span>: <span class="built_in">string</span></span>) =&gt;</span> <span class="title class_">SelectOptionProps</span>[];</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">CustomFilterRemoteFunc</span> = <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="attr">value</span>: <span class="built_in">string</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> <span class="title class_">Promise</span>&lt;<span class="title class_">SelectOptionProps</span>[] | <span class="built_in">void</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SelectOptionProps</span> &#123;</span><br><span class="line">  <span class="attr">value</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">label</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">disabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SelectProps</span> &#123;</span><br><span class="line">  <span class="attr">modelValue</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">id</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">options</span>?: <span class="title class_">SelectOptionProps</span>[];</span><br><span class="line">  <span class="attr">placeholder</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">disabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">clearable</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">renderLabel</span>?: <span class="title class_">RenderLabelFunc</span>;</span><br><span class="line">  <span class="attr">filterable</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">filterMethod</span>?: <span class="title class_">CustomFilterFunc</span>;</span><br><span class="line">  <span class="attr">remote</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">remoteMethod</span>?: <span class="title class_">CustomFilterRemoteFunc</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SelectStates</span> &#123;</span><br><span class="line">  <span class="attr">inputValue</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">selectedOption</span>: <span class="title class_">SelectOptionProps</span> | <span class="built_in">void</span> | <span class="literal">null</span>;</span><br><span class="line">  <span class="attr">mouseHover</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">loading</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">highlightedIndex</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SelectEmits</span> &#123;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;update:modelValue&quot;</span>, <span class="attr">value</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;change&quot;</span>, <span class="attr">value</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;visible-change&quot;</span>, <span class="attr">vlaue</span>: <span class="built_in">boolean</span>): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;clear&quot;</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;focus&quot;</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;blur&quot;</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SelectContext</span> &#123;</span><br><span class="line">  <span class="attr">selectStates</span>: <span class="title class_">SelectStates</span>;</span><br><span class="line">  <span class="attr">renderLabel</span>?: <span class="title class_">RenderLabelFunc</span>;</span><br><span class="line">  <span class="attr">highlightedLine</span>?: <span class="title class_">ComputedRef</span>&lt;<span class="title class_">SelectOptionProps</span> | <span class="built_in">void</span>&gt;;</span><br><span class="line">  <span class="title function_">handleSelect</span>(<span class="attr">item</span>: <span class="title class_">SelectOptionProps</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SelectInstance</span> &#123;</span><br><span class="line">  <span class="title function_">focus</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">blur</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="└─-useKeyMap-ts"><a href="#└─-useKeyMap-ts" class="headerlink" title="└─ useKeyMap.ts"></a>└─ useKeyMap.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Ref</span>, <span class="title class_">ComputedRef</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">SelectOptionProps</span>, <span class="title class_">SelectStates</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">KeyMapParams</span> &#123;</span><br><span class="line">  <span class="attr">isDropdownVisible</span>: <span class="title class_">Ref</span>&lt;<span class="built_in">boolean</span>&gt;;</span><br><span class="line">  <span class="attr">highlightedLine</span>: <span class="title class_">ComputedRef</span>&lt;<span class="title class_">SelectOptionProps</span> | <span class="built_in">void</span>&gt;;</span><br><span class="line">  <span class="attr">hasData</span>: <span class="title class_">ComputedRef</span>&lt;<span class="built_in">boolean</span>&gt;;</span><br><span class="line">  <span class="attr">lastIndex</span>: <span class="title class_">ComputedRef</span>&lt;<span class="built_in">number</span>&gt;;</span><br><span class="line">  <span class="attr">selectStates</span>: <span class="title class_">SelectStates</span>;</span><br><span class="line">  <span class="title function_">controlVisible</span>(<span class="attr">visible</span>: <span class="built_in">boolean</span>): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">handleSelect</span>(<span class="attr">option</span>: <span class="title class_">SelectOptionProps</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useKeyMap</span>(<span class="params">&#123;</span></span><br><span class="line"><span class="params">  isDropdownVisible,</span></span><br><span class="line"><span class="params">  controlVisible,</span></span><br><span class="line"><span class="params">  selectStates,</span></span><br><span class="line"><span class="params">  highlightedLine,</span></span><br><span class="line"><span class="params">  handleSelect,</span></span><br><span class="line"><span class="params">  hasData,</span></span><br><span class="line"><span class="params">  lastIndex,</span></span><br><span class="line"><span class="params">&#125;: <span class="title class_">KeyMapParams</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">keyMap</span>: <span class="title class_">Map</span>&lt;<span class="built_in">string</span>, <span class="title class_">Function</span>&gt; = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"></span><br><span class="line">  keyMap.<span class="title function_">set</span>(<span class="string">&quot;Enter&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isDropdownVisible.<span class="property">value</span>) &#123;</span><br><span class="line">      <span class="title function_">controlVisible</span>(<span class="literal">true</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (selectStates.<span class="property">highlightedIndex</span> &gt;= <span class="number">0</span> &amp;&amp; highlightedLine.<span class="property">value</span>) &#123;</span><br><span class="line">        <span class="title function_">handleSelect</span>(highlightedLine.<span class="property">value</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">controlVisible</span>(<span class="literal">false</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  keyMap.<span class="title function_">set</span>(</span><br><span class="line">    <span class="string">&quot;Escape&quot;</span>,</span><br><span class="line">    <span class="function">() =&gt;</span> isDropdownVisible.<span class="property">value</span> &amp;&amp; <span class="title function_">controlVisible</span>(!isDropdownVisible.<span class="property">value</span>)</span><br><span class="line">  );</span><br><span class="line">  keyMap.<span class="title function_">set</span>(<span class="string">&quot;ArrowUp&quot;</span>, <span class="function">(<span class="params"><span class="attr">e</span>: <span class="title class_">KeyboardEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="keyword">if</span> (!hasData.<span class="property">value</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      selectStates.<span class="property">highlightedIndex</span> === -<span class="number">1</span> ||</span><br><span class="line">      selectStates.<span class="property">highlightedIndex</span> === <span class="number">0</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      selectStates.<span class="property">highlightedIndex</span> = lastIndex.<span class="property">value</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    selectStates.<span class="property">highlightedIndex</span>--;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  keyMap.<span class="title function_">set</span>(<span class="string">&quot;ArrowDown&quot;</span>, <span class="function">(<span class="params"><span class="attr">e</span>: <span class="title class_">KeyboardEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="keyword">if</span> (!hasData.<span class="property">value</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      selectStates.<span class="property">highlightedIndex</span> === -<span class="number">1</span> ||</span><br><span class="line">      selectStates.<span class="property">highlightedIndex</span> === lastIndex.<span class="property">value</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      selectStates.<span class="property">highlightedIndex</span> = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    selectStates.<span class="property">highlightedIndex</span>++;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> keyMap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Switch"><a href="#├─-Switch" class="headerlink" title="├─ Switch"></a>├─ Switch</h3><blockquote>
<p>开关组件，用于在两种状态之间切换</p>
</blockquote>
<h4 id="–API–-14"><a href="#–API–-14" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-index-ts-15"><a href="#├─-index-ts-15" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Switch</span> <span class="keyword">from</span> <span class="string">&quot;./Switch.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErSwitch</span> = <span class="title function_">withInstall</span>(<span class="title class_">Switch</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-13"><a href="#├─-style-css-13" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-switch</span> &#123;</span><br><span class="line">  <span class="attr">--er-switch-on-color</span>: <span class="built_in">var</span>(--er-color-primary);</span><br><span class="line">  <span class="attr">--er-switch-off-color</span>: <span class="built_in">var</span>(--er-border-color);</span><br><span class="line">  <span class="attr">--er-switch-on-border-color</span>: <span class="built_in">var</span>(--er-color-primary);</span><br><span class="line">  <span class="attr">--er-switch-off-border-color</span>: <span class="built_in">var</span>(--er-border-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-switch</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">32px</span>;</span><br><span class="line">  <span class="selector-class">.er-switch__input</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    &amp;<span class="selector-pseudo">:focus-visible</span>&#123;</span><br><span class="line">      &amp; ~ <span class="selector-class">.er-switch__core</span>&#123;</span><br><span class="line">        <span class="attribute">outline</span>: <span class="number">2px</span> solid <span class="built_in">var</span>(--er-switch-on-color);</span><br><span class="line">        <span class="attribute">outline-offset</span>: <span class="number">1px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-disabled</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: .<span class="number">6</span>;</span><br><span class="line">    <span class="selector-class">.er-switch__core</span> &#123;</span><br><span class="line">      <span class="attribute">cursor</span>: not-allowed;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-checked</span>&#123;</span><br><span class="line">    <span class="selector-class">.er-switch__core</span>&#123;</span><br><span class="line">      <span class="attribute">border-color</span>: <span class="built_in">var</span>(--er-switch-on-border-color);</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-switch-on-color);</span><br><span class="line">      <span class="selector-class">.er-switch__core-action</span>&#123;</span><br><span class="line">        <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">17px</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="selector-class">.er-switch__core-inner</span> &#123;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">18px</span> <span class="number">0</span> <span class="number">4px</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-switch--large</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="selector-class">.er-switch__core</span> &#123;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="selector-class">.er-switch__core-action</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">20px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-checked</span> &#123;</span><br><span class="line">    <span class="selector-class">.er-switch__core</span> <span class="selector-class">.er-switch__core-action</span> &#123;</span><br><span class="line">      <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">21px</span>);</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-switch-on-color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-switch--small</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">16px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">24px</span>;</span><br><span class="line">  <span class="selector-class">.er-switch__core</span> &#123;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="selector-class">.er-switch__core-action</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">12px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.is-checked</span> &#123;</span><br><span class="line">    <span class="selector-class">.er-switch__core</span> <span class="selector-class">.er-switch-core-action</span> &#123;</span><br><span class="line">      <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">13px</span>);</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-switch-on-color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.er-switch__core</span>&#123;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">display</span>: inline-flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">border</span>:<span class="number">1px</span> solid <span class="built_in">var</span>(--er-switch-off-border-color);</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--er-switch-off-color);</span><br><span class="line">  <span class="attribute">transition</span>: border-color <span class="built_in">var</span>(--er-transition-duration),background-color <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">  <span class="selector-class">.er-switch__core-action</span>&#123;</span><br><span class="line">     <span class="attribute">position</span>: absolute;</span><br><span class="line">     <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--er-border-radius-circle);</span><br><span class="line">     <span class="attribute">left</span>: <span class="number">1px</span>;</span><br><span class="line">     <span class="attribute">width</span>: <span class="number">16px</span>;</span><br><span class="line">     <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">     <span class="attribute">background-color</span>: <span class="built_in">var</span>(--er-color-white);</span><br><span class="line">     <span class="attribute">transition</span>: all <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.er-switch__core-inner</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">4px</span> <span class="number">0</span> <span class="number">18px</span>;</span><br><span class="line">    <span class="selector-class">.er-switch__core-inner-text</span>&#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--er-color-white);</span><br><span class="line">      <span class="attribute">user-select</span>: none;</span><br><span class="line">      <span class="attribute">overflow</span>: hidden;</span><br><span class="line">      <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">      <span class="attribute">white-space</span>: nowrap;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="├─-Switch-test-tsx"><a href="#├─-Switch-test-tsx" class="headerlink" title="├─ Switch.test.tsx"></a>├─ Switch.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, it, expect &#125; <span class="keyword">from</span> <span class="string">&#x27;vitest&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&#x27;@vue/test-utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Switch</span> <span class="keyword">from</span> <span class="string">&#x27;./Switch.vue&#x27;</span>; <span class="comment">// 确保这是你的 Switch 组件的路径</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Switch.vue&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should render correctly with default props&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Switch</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&#x27;.er-switch&#x27;</span>)).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should handle click event and toggle the checked state&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Switch</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="literal">false</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">trigger</span>(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()[<span class="string">&#x27;update:modelValue&#x27;</span>][<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="literal">true</span>]);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()[<span class="string">&#x27;change&#x27;</span>][<span class="number">0</span>]).<span class="title function_">toEqual</span>([<span class="literal">true</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">trigger</span>(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()[<span class="string">&#x27;update:modelValue&#x27;</span>][<span class="number">1</span>]).<span class="title function_">toEqual</span>([<span class="literal">false</span>]);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()[<span class="string">&#x27;change&#x27;</span>][<span class="number">1</span>]).<span class="title function_">toEqual</span>([<span class="literal">false</span>]);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should not toggle when disabled&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Switch</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">modelValue</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">disabled</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">trigger</span>(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="property">not</span>.<span class="title function_">toHaveProperty</span>(<span class="string">&#x27;update:modelValue&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">emitted</span>()).<span class="property">not</span>.<span class="title function_">toHaveProperty</span>(<span class="string">&#x27;change&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="├─-Switch-vue"><a href="#├─-Switch-vue" class="headerlink" title="├─ Switch.vue"></a>├─ Switch.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; ref, computed, onMounted, watch &#125; from &quot;vue&quot;;</span><br><span class="line">import type &#123; SwitchEmits, SwitchProps, SwitchInstance &#125; from &quot;./types&quot;;</span><br><span class="line">import &#123; debugWarn &#125; from &quot;@eric-ui/utils&quot;;</span><br><span class="line">import &#123; useFormItem, useFormDisabled, useFormItemInputId &#125; from &quot;../Form&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123; name: &quot;ErSwitch&quot;, inheritAttrs: false &#125;);</span><br><span class="line">const props = withDefaults(defineProps&lt;SwitchProps&gt;(), &#123;</span><br><span class="line">  activeValue: true,</span><br><span class="line">  inactiveValue: false,</span><br><span class="line">&#125;);</span><br><span class="line">const emits = defineEmits&lt;SwitchEmits&gt;();</span><br><span class="line">const isDisabled = useFormDisabled();</span><br><span class="line">const &#123; formItem &#125; = useFormItem();</span><br><span class="line">const &#123; inputId &#125; = useFormItemInputId(props, formItem);</span><br><span class="line"></span><br><span class="line">const innerValue = ref(props.modelValue);</span><br><span class="line">const inputRef = ref&lt;HTMLInputElement | null&gt;(null);</span><br><span class="line">const checked = computed(() =&gt; innerValue.value === props.activeValue);</span><br><span class="line"></span><br><span class="line">const focus: SwitchInstance[&quot;focus&quot;] = function () &#123;</span><br><span class="line">  inputRef.value?.focus();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function handleChange() &#123;</span><br><span class="line">  if (isDisabled.value) return;</span><br><span class="line"></span><br><span class="line">  const newVal = checked.value ? props.inactiveValue : props.activeValue;</span><br><span class="line"></span><br><span class="line">  innerValue.value = newVal;</span><br><span class="line">  emits(&quot;update:modelValue&quot;, newVal);</span><br><span class="line">  emits(&quot;change&quot;, newVal);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  inputRef.value!.checked = checked.value;</span><br><span class="line">&#125;);</span><br><span class="line">watch(checked, (val) =&gt; &#123;</span><br><span class="line">  inputRef.value!.checked = val;</span><br><span class="line">  formItem?.validate(&quot;change&quot;).catch((err) =&gt; debugWarn(err));</span><br><span class="line">&#125;);</span><br><span class="line">watch(</span><br><span class="line">  () =&gt; props.modelValue,</span><br><span class="line">  (val) =&gt; (innerValue.value = val)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">defineExpose&lt;SwitchInstance&gt;(&#123;</span><br><span class="line">  focus,</span><br><span class="line">  checked,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    class=&quot;er-switch&quot;</span><br><span class="line">    :class=&quot;&#123;</span><br><span class="line">      [`er-switch--$&#123;size&#125;`]: size,</span><br><span class="line">      &#x27;is-disabled&#x27;: isDisabled,</span><br><span class="line">      &#x27;is-checked&#x27;: checked,</span><br><span class="line">    &#125;&quot;</span><br><span class="line">    @click=&quot;handleChange&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;input</span><br><span class="line">      class=&quot;er-switch__input&quot;</span><br><span class="line">      type=&quot;checkbox&quot;</span><br><span class="line">      role=&quot;switch&quot;</span><br><span class="line">      ref=&quot;inputRef&quot;</span><br><span class="line">      :id=&quot;inputId&quot;</span><br><span class="line">      :name=&quot;name&quot;</span><br><span class="line">      :disabled=&quot;isDisabled&quot;</span><br><span class="line">      :checked=&quot;checked&quot;</span><br><span class="line">      @keydown.enter=&quot;handleChange&quot;</span><br><span class="line">      @blur=&quot;formItem?.validate(&#x27;blur&#x27;).catch((err) =&gt; debugWarn(err))&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">    &lt;div class=&quot;er-switch__core&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;er-switch__core-inner&quot;&gt;</span><br><span class="line">        &lt;span</span><br><span class="line">          v-if=&quot;activeText || inactiveText&quot;</span><br><span class="line">          class=&quot;er-switch__core-inner-text&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &#123;&#123; checked ? activeText : inactiveText &#125;&#125;</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;er-switch__core-action&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="└─-types-ts-14"><a href="#└─-types-ts-14" class="headerlink" title="└─ types.ts"></a>└─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ComputedRef</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">SwitchValueType</span> = <span class="built_in">boolean</span> | <span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SwitchProps</span> &#123;</span><br><span class="line">  <span class="attr">modelValue</span>: <span class="title class_">SwitchValueType</span>;</span><br><span class="line">  <span class="attr">disabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">activeText</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">inactiveText</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">activeValue</span>?: <span class="title class_">SwitchValueType</span>;</span><br><span class="line">  <span class="attr">inactiveValue</span>?: <span class="title class_">SwitchValueType</span>;</span><br><span class="line">  <span class="attr">name</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">id</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">size</span>?: <span class="string">&quot;small&quot;</span> | <span class="string">&quot;large&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SwitchEmits</span> &#123;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;update:modelValue&quot;</span>, <span class="attr">value</span>: <span class="title class_">SwitchValueType</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;change&quot;</span>, <span class="attr">value</span>: <span class="title class_">SwitchValueType</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">SwitchInstance</span> &#123;</span><br><span class="line">  <span class="title function_">focus</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="attr">checked</span>: <span class="title class_">ComputedRef</span>&lt;<span class="built_in">boolean</span>&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Tooltip"><a href="#├─-Tooltip" class="headerlink" title="├─ Tooltip"></a>├─ Tooltip</h3><blockquote>
<p>hover文字提示, 显示额外的信息</p>
</blockquote>
<h4 id="–API–-15"><a href="#–API–-15" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-index-ts-16"><a href="#├─-index-ts-16" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Tooltip</span> <span class="keyword">from</span> <span class="string">&quot;./Tooltip.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErTooltip</span> = <span class="title function_">withInstall</span>(<span class="title class_">Tooltip</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="├─-style-css-14"><a href="#├─-style-css-14" class="headerlink" title="├─ style.css"></a>├─ style.css</h4><blockquote>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.er-tooltip</span> &#123;</span><br><span class="line">  <span class="attr">--er-popover-bg-color</span>: <span class="built_in">var</span>(--er-bg-color-overlay);</span><br><span class="line">  <span class="attr">--er-popover-font-size</span>: <span class="built_in">var</span>(--er-font-size-base);</span><br><span class="line">  <span class="attr">--er-popover-border-color</span>: <span class="built_in">var</span>(--er-border-color-lighter);</span><br><span class="line">  <span class="attr">--er-popover-padding</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attr">--er-popover-border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.er-tooltip</span> &#123;</span><br><span class="line">  <span class="selector-class">.fade-enter-active</span>,</span><br><span class="line">  <span class="selector-class">.fade-leave-active</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: opacity <span class="built_in">var</span>(--er-transition-duration);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.fade-enter-from</span>,</span><br><span class="line">  <span class="selector-class">.fade-leave-to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.er-tooltip__popper</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--er-popover-bg-color);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--er-popover-border-radius);</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-popover-border-color);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="built_in">var</span>(--er-popover-padding);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--er-text-color-regular);</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.4</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: justify;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">var</span>(--er-popover-font-size);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--er-box-shadow-light);</span><br><span class="line">    <span class="attribute">word-break</span>: break-all;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1000</span>;</span><br><span class="line">    <span class="selector-id">#arrow</span>,</span><br><span class="line">    <span class="selector-id">#arrow</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">      <span class="attribute">position</span>: absolute;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">8px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">      <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">var</span>(--er-popover-bg-color);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-id">#arrow</span> &#123;</span><br><span class="line">      <span class="attribute">visibility</span>: hidden;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-id">#arrow</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">      <span class="attribute">visibility</span>: visible;</span><br><span class="line">      <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-attr">[data-popper-placement^=<span class="string">&#x27;top&#x27;</span>]</span> &gt; <span class="selector-id">#arrow</span> &#123;</span><br><span class="line">      <span class="attribute">bottom</span>: -<span class="number">5px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-attr">[data-popper-placement^=<span class="string">&#x27;bottom&#x27;</span>]</span> &gt; <span class="selector-id">#arrow</span> &#123;</span><br><span class="line">      <span class="attribute">top</span>: -<span class="number">5px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-attr">[data-popper-placement^=<span class="string">&#x27;left&#x27;</span>]</span> &gt; <span class="selector-id">#arrow</span> &#123;</span><br><span class="line">      <span class="attribute">right</span>: -<span class="number">5px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-attr">[data-popper-placement^=<span class="string">&#x27;right&#x27;</span>]</span> &gt; <span class="selector-id">#arrow</span> &#123;</span><br><span class="line">      <span class="attribute">left</span>: -<span class="number">5px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-attr">[data-popper-placement^=<span class="string">&#x27;top&#x27;</span>]</span> &gt; <span class="selector-id">#arrow</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">      <span class="attribute">border-right</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-popover-border-color);</span><br><span class="line">      <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-popover-border-color);</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-attr">[data-popper-placement^=<span class="string">&#x27;bottom&#x27;</span>]</span> &gt; <span class="selector-id">#arrow</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">      <span class="attribute">border-left</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-popover-border-color);</span><br><span class="line">      <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-popover-border-color);</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-attr">[data-popper-placement^=<span class="string">&#x27;left&#x27;</span>]</span> &gt; <span class="selector-id">#arrow</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">      <span class="attribute">border-right</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-popover-border-color);</span><br><span class="line">      <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-popover-border-color);</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;<span class="selector-attr">[data-popper-placement^=<span class="string">&#x27;right&#x27;</span>]</span> &gt; <span class="selector-id">#arrow</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">      <span class="attribute">border-left</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-popover-border-color);</span><br><span class="line">      <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--er-popover-border-color);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="├─-Tooltip-test-tsx"><a href="#├─-Tooltip-test-tsx" class="headerlink" title="├─ Tooltip.test.tsx"></a>├─ Tooltip.test.tsx</h4><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, test,it, expect, vi, beforeEach &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&quot;@vue/test-utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ErTooltip</span> &#125; <span class="keyword">from</span> <span class="string">&quot;.&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Tooltip</span> <span class="keyword">from</span> <span class="string">&quot;./Tooltip.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line">vi.<span class="title function_">mock</span>(<span class="string">&quot;@popperjs/core&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> onVisibleChange = vi.<span class="title function_">fn</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Tooltip/index.ts&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 测试 withInstall 函数是否被正确应用</span></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should be exported with withInstall()&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">ErTooltip</span>.<span class="property">install</span>).<span class="title function_">toBeDefined</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 测试 Tooltip 组件是否被正确导出</span></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should be exported Tooltip component&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">ErTooltip</span>).<span class="title function_">toBe</span>(<span class="title class_">Tooltip</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 可选：测试 withInstall 是否增强了 Tooltip 组件的功能</span></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;should enhance Tooltip component&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> enhancedTooltip = <span class="title function_">withInstall</span>(<span class="title class_">Tooltip</span>);</span><br><span class="line">    <span class="title function_">expect</span>(enhancedTooltip).<span class="title function_">toBe</span>(<span class="title class_">ErTooltip</span>);</span><br><span class="line">    <span class="comment">// 这里可以添加更多测试，确保 withInstall 增强了组件的特定功能</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 可选：如果你的 withInstall 函数有特定的行为或属性，确保它们被正确应用</span></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;should apply specific enhancements&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> enhancedTooltip = <span class="title function_">withInstall</span>(<span class="title class_">Tooltip</span>);</span><br><span class="line">    <span class="comment">// 例如，如果你的 withInstall 增加了一个特定的方法或属性</span></span><br><span class="line">    <span class="title function_">expect</span>(enhancedTooltip).<span class="title function_">toHaveProperty</span>(<span class="string">&quot;install&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Tooltip.vue&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    vi.<span class="title function_">useFakeTimers</span>();</span><br><span class="line">    vi.<span class="title function_">clearAllMocks</span>()</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;basic tooltip&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(</span><br><span class="line">      <span class="function">() =&gt;</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;outside&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Tooltip</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">content</span>=<span class="string">&quot;hello tooltip&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">trigger</span>=<span class="string">&quot;click&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#123;<span class="attr">...</span>&#123; <span class="attr">onVisibleChange</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;trigger&quot;</span>&gt;</span>trigger<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Tooltip</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      ),</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">attachTo</span>: <span class="variable language_">document</span>.<span class="property">body</span>,</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">const</span> triggerArea = wrapper.<span class="title function_">find</span>(<span class="string">&quot;#trigger&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(triggerArea.<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 弹出层是否出现</span></span><br><span class="line">    triggerArea.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">get</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">text</span>()).<span class="title function_">toBe</span>(<span class="string">&quot;hello tooltip&quot;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(onVisibleChange).<span class="title function_">toHaveBeenCalledWith</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再次点击</span></span><br><span class="line">    triggerArea.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(onVisibleChange).<span class="title function_">toHaveBeenCalledTimes</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 等待动画</span></span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line"></span><br><span class="line">    triggerArea.<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="comment">// 区域外点击关闭 tooltip</span></span><br><span class="line">    wrapper.<span class="title function_">get</span>(<span class="string">&quot;#outside&quot;</span>).<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(onVisibleChange).<span class="title function_">toHaveBeenCalledTimes</span>(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注销流程</span></span><br><span class="line">    wrapper.<span class="title function_">unmount</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;tooltip with hover trigger&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// ... 省略其他设置</span></span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Tooltip</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123; <span class="attr">trigger</span>: <span class="string">&quot;hover&quot;</span>, <span class="attr">content</span>: <span class="string">&quot;test&quot;</span> &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 测试悬停显示</span></span><br><span class="line">    wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__trigger&quot;</span>).<span class="title function_">trigger</span>(<span class="string">&quot;mouseenter&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="comment">// 测试悬外隐藏</span></span><br><span class="line">    wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip&quot;</span>).<span class="title function_">trigger</span>(<span class="string">&quot;mouseleave&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 右键菜单触发的测试</span></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;tooltip with contextmenu trigger&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// ... 省略其他设置</span></span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Tooltip</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123; <span class="attr">trigger</span>: <span class="string">&quot;contextmenu&quot;</span>, <span class="attr">content</span>: <span class="string">&quot;test&quot;</span> &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 测试右键菜单显示</span></span><br><span class="line">    wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__trigger&quot;</span>).<span class="title function_">trigger</span>(<span class="string">&quot;contextmenu&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="comment">// 测试右键菜单隐藏（可以模拟点击外部区域）</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 手动模式的测试</span></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;tooltip with manual trigger&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// ... 省略其他设置</span></span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Tooltip</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123; <span class="attr">manual</span>: <span class="literal">true</span>, <span class="attr">content</span>: <span class="string">&quot;test&quot;</span> &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 测试手动触发显示和隐藏</span></span><br><span class="line">    wrapper.<span class="property">vm</span>.<span class="title function_">show</span>(); <span class="comment">// 假设 show 方法可以通过某种方式访问</span></span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    wrapper.<span class="property">vm</span>.<span class="title function_">hide</span>();</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 禁用状态的测试</span></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;disabled tooltip&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// ... 省略其他设置</span></span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Tooltip</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123; <span class="attr">disabled</span>: <span class="literal">true</span>, <span class="attr">content</span>: <span class="string">&quot;test&quot;</span> &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 测试禁用状态下点击不会触发显示</span></span><br><span class="line">    wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__trigger&quot;</span>).<span class="title function_">trigger</span>(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeFalsy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 虚拟触发节点的测试</span></span><br><span class="line">  <span class="title function_">test</span>(<span class="string">&quot;tooltip with virtual trigger node&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// ... 省略其他设置</span></span><br><span class="line">    <span class="keyword">const</span> virtualRef = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Tooltip</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123; virtualRef, <span class="attr">virtualTriggering</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 测试虚拟节点的事件触发</span></span><br><span class="line">    virtualRef.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;mouseenter&quot;</span>));</span><br><span class="line">    <span class="keyword">await</span> vi.<span class="title function_">runAllTimers</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">find</span>(<span class="string">&quot;.er-tooltip__popper&quot;</span>).<span class="title function_">exists</span>()).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="├─-Tooltip-vue"><a href="#├─-Tooltip-vue" class="headerlink" title="├─ Tooltip.vue"></a>├─ Tooltip.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; createPopper, type Instance &#125; from &quot;@popperjs/core&quot;;</span><br><span class="line">import &#123; ref, watch, watchEffect, onUnmounted, computed, type Ref &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; bind, debounce, type DebouncedFunc &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import &#123; useClickOutside &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line"></span><br><span class="line">import type &#123; TooltipProps, TooltipEmits, TooltipInstance &#125; from &quot;./types&quot;;</span><br><span class="line">import type &#123; ButtonInstance &#125; from &quot;../Button&quot;;</span><br><span class="line"></span><br><span class="line">import useEvenstToTiggerNode from &quot;./useEventsToTiggerNode&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErTooltip&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">interface _TooltipProps extends TooltipProps &#123;</span><br><span class="line">  virtualRef?: HTMLElement | ButtonInstance | void;</span><br><span class="line">  virtualTriggering?: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const props = withDefaults(defineProps&lt;_TooltipProps&gt;(), &#123;</span><br><span class="line">  placement: &quot;bottom&quot;,</span><br><span class="line">  trigger: &quot;hover&quot;,</span><br><span class="line">  transition: &quot;fade&quot;,</span><br><span class="line">  showTimeout: 0,</span><br><span class="line">  hideTimeout: 200,</span><br><span class="line">&#125;);</span><br><span class="line">const emits = defineEmits&lt;TooltipEmits&gt;();</span><br><span class="line">const visible = ref(false);</span><br><span class="line"></span><br><span class="line">const events: Ref&lt;Record&lt;string, EventListener&gt;&gt; = ref(&#123;&#125;);</span><br><span class="line">const outerEvents: Ref&lt;Record&lt;string, EventListener&gt;&gt; = ref(&#123;&#125;);</span><br><span class="line">const dropdownEvents: Ref&lt;Record&lt;string, EventListener&gt;&gt; = ref(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">const containerNode = ref&lt;HTMLElement&gt;();</span><br><span class="line">const popperNode = ref&lt;HTMLElement&gt;();</span><br><span class="line">const _triggerNode = ref&lt;HTMLElement&gt;();</span><br><span class="line"></span><br><span class="line">const triggerNode = computed(() =&gt; &#123;</span><br><span class="line">  if (props.virtualTriggering)</span><br><span class="line">    return (</span><br><span class="line">      // @tips any 为了 fix 一个初始设计上的小失误 （后续重构 &quot;虚拟目标节点&quot; 时解决）</span><br><span class="line">      ((props.virtualRef as ButtonInstance)?.ref as any) ??</span><br><span class="line">      (props.virtualRef as HTMLElement) ??</span><br><span class="line">      _triggerNode.value</span><br><span class="line">    );</span><br><span class="line">  return _triggerNode.value as HTMLElement;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const popperOptions = computed(() =&gt; (&#123;</span><br><span class="line">  placement: props.placement,</span><br><span class="line">  modifiers: [</span><br><span class="line">    &#123;</span><br><span class="line">      name: &quot;offset&quot;,</span><br><span class="line">      options: &#123;</span><br><span class="line">        offset: [0, 9],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  ...props.popperOptions,</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">const openDelay = computed(() =&gt;</span><br><span class="line">  props.trigger === &quot;hover&quot; ? props.showTimeout : 0</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const closeDelay = computed(() =&gt;</span><br><span class="line">  props.trigger === &quot;hover&quot; ? props.hideTimeout : 0</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">const triggerStrategyMap: Map&lt;string, () =&gt; void&gt; = new Map();</span><br><span class="line">triggerStrategyMap.set(&quot;hover&quot;, () =&gt; &#123;</span><br><span class="line">  events.value[&quot;mouseenter&quot;] = openFinal;</span><br><span class="line">  outerEvents.value[&quot;mouseleave&quot;] = closeFinal;</span><br><span class="line">  dropdownEvents.value[&quot;mouseenter&quot;] = openFinal;</span><br><span class="line">&#125;);</span><br><span class="line">triggerStrategyMap.set(&quot;click&quot;, () =&gt; &#123;</span><br><span class="line">  events.value[&quot;click&quot;] = togglePopper;</span><br><span class="line">&#125;);</span><br><span class="line">triggerStrategyMap.set(&quot;contextmenu&quot;, () =&gt; &#123;</span><br><span class="line">  events.value[&quot;contextmenu&quot;] = (e) =&gt; &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    openFinal();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">let openDebounce: DebouncedFunc&lt;() =&gt; void&gt; | void;</span><br><span class="line">let closeDebounce: DebouncedFunc&lt;() =&gt; void&gt; | void;</span><br><span class="line"></span><br><span class="line">function openFinal() &#123;</span><br><span class="line">  closeDebounce?.cancel();</span><br><span class="line">  openDebounce?.();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function closeFinal() &#123;</span><br><span class="line">  openDebounce?.cancel();</span><br><span class="line">  closeDebounce?.();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function togglePopper() &#123;</span><br><span class="line">  visible.value ? closeFinal() : openFinal();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function setVisible(val: boolean) &#123;</span><br><span class="line">  if (props.disabled) return;</span><br><span class="line">  visible.value = val;</span><br><span class="line">  emits(&quot;visible-change&quot;, val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function attachEvents() &#123;</span><br><span class="line">  if (props.disabled || props.manual) return;</span><br><span class="line">  triggerStrategyMap.get(props.trigger)?.();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let popperInstance: null | Instance;</span><br><span class="line">function destroyPopperInstance() &#123;</span><br><span class="line">  popperInstance?.destroy();</span><br><span class="line">  popperInstance = null;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function resetEvents() &#123;</span><br><span class="line">  events.value = &#123;&#125;;</span><br><span class="line">  outerEvents.value = &#123;&#125;;</span><br><span class="line">  dropdownEvents.value = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  attachEvents();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (!props.manual) &#123;</span><br><span class="line">  attachEvents();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const show: TooltipInstance[&quot;show&quot;] = openFinal;</span><br><span class="line"></span><br><span class="line">const hide: TooltipInstance[&quot;hide&quot;] = function () &#123;</span><br><span class="line">  openDebounce?.cancel();</span><br><span class="line">  setVisible(false);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">useClickOutside(containerNode, () =&gt; &#123;</span><br><span class="line">  emits(&quot;click-outside&quot;);</span><br><span class="line">  if (props.trigger === &quot;hover&quot; || props.manual) return;</span><br><span class="line">  visible.value &amp;&amp; closeFinal();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  visible,</span><br><span class="line">  (val) =&gt; &#123;</span><br><span class="line">    if (!val) return;</span><br><span class="line"></span><br><span class="line">    if (triggerNode.value &amp;&amp; popperNode.value) &#123;</span><br><span class="line">      popperInstance = createPopper(</span><br><span class="line">        triggerNode.value,</span><br><span class="line">        popperNode.value,</span><br><span class="line">        popperOptions.value</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; flush: &quot;post&quot; &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  () =&gt; props.manual,</span><br><span class="line">  (isManual) =&gt; &#123;</span><br><span class="line">    if (isManual) &#123;</span><br><span class="line">      events.value = &#123;&#125;;</span><br><span class="line">      outerEvents.value = &#123;&#125;;</span><br><span class="line">      dropdownEvents.value = &#123;&#125;;</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line">    attachEvents();</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  () =&gt; props.trigger,</span><br><span class="line">  (newTrigger, oldTrigger) =&gt; &#123;</span><br><span class="line">    if (newTrigger === oldTrigger) return;</span><br><span class="line">    resetEvents();</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">watch(</span><br><span class="line">  () =&gt; props.disabled,</span><br><span class="line">  (val, oldVal) =&gt; &#123;</span><br><span class="line">    if (val === oldVal) return;</span><br><span class="line">    openDebounce?.cancel();</span><br><span class="line">    visible.value = false;</span><br><span class="line">    emits(&quot;visible-change&quot;, false);</span><br><span class="line">    resetEvents();</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">watchEffect(() =&gt; &#123;</span><br><span class="line">  openDebounce = debounce(bind(setVisible, null, true), openDelay.value);</span><br><span class="line">  closeDebounce = debounce(bind(setVisible, null, false), closeDelay.value);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">useEvenstToTiggerNode(props, triggerNode, events, () =&gt; &#123;</span><br><span class="line">  openDebounce?.cancel();</span><br><span class="line">  setVisible(false);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">onUnmounted(() =&gt; &#123;</span><br><span class="line">  destroyPopperInstance();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">defineExpose&lt;TooltipInstance&gt;(&#123;</span><br><span class="line">  show,</span><br><span class="line">  hide,</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;er-tooltip&quot; ref=&quot;containerNode&quot; v-on=&quot;outerEvents&quot;&gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      class=&quot;er-tooltip__trigger&quot;</span><br><span class="line">      ref=&quot;_triggerNode&quot;</span><br><span class="line">      v-on=&quot;events&quot;</span><br><span class="line">      v-if=&quot;!virtualTriggering&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;slot name=&quot;default&quot; v-else&gt;&lt;/slot&gt;</span><br><span class="line"></span><br><span class="line">    &lt;transition :name=&quot;transition&quot; @after-leave=&quot;destroyPopperInstance&quot;&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        class=&quot;er-tooltip__popper&quot;</span><br><span class="line">        ref=&quot;popperNode&quot;</span><br><span class="line">        v-on=&quot;dropdownEvents&quot;</span><br><span class="line">        v-if=&quot;visible&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;slot name=&quot;content&quot;&gt;</span><br><span class="line">          &#123;&#123; content &#125;&#125;</span><br><span class="line">        &lt;/slot&gt;</span><br><span class="line">        &lt;div id=&quot;arrow&quot; data-popper-arrow&gt;&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/transition&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">@import &quot;./style.css&quot;;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h4 id="├─-types-ts-1"><a href="#├─-types-ts-1" class="headerlink" title="├─ types.ts"></a>├─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Placement</span>, <span class="title class_">Options</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@popperjs/core&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">TooltipProps</span> &#123;</span><br><span class="line">  <span class="attr">content</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">trigger</span>?: <span class="string">&quot;hover&quot;</span> | <span class="string">&quot;click&quot;</span> | <span class="string">&quot;contextmenu&quot;</span>;</span><br><span class="line">  <span class="attr">placement</span>?: <span class="title class_">Placement</span>;</span><br><span class="line">  <span class="attr">manual</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">disabled</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">popperOptions</span>?: <span class="title class_">Partial</span>&lt;<span class="title class_">Options</span>&gt;;</span><br><span class="line">  <span class="attr">transition</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">showTimeout</span>?: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">hideTimeout</span>?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">TooltipEmits</span> &#123;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;visible-change&quot;</span>, <span class="attr">value</span>: <span class="built_in">boolean</span>): <span class="built_in">void</span>;</span><br><span class="line">  (<span class="attr">e</span>: <span class="string">&quot;click-outside&quot;</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">TooltipInstance</span> &#123;</span><br><span class="line">  <span class="title function_">show</span>(): <span class="built_in">void</span>;</span><br><span class="line">  <span class="title function_">hide</span>(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="└─-useEventsToTiggerNode-ts"><a href="#└─-useEventsToTiggerNode-ts" class="headerlink" title="└─ useEventsToTiggerNode.ts"></a>└─ useEventsToTiggerNode.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; each, isElement &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; onMounted, onUnmounted, watch &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ComputedRef</span>, <span class="title class_">Ref</span>, <span class="title class_">WatchStopHandle</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">TooltipProps</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useEvenstToTiggerNode</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">props</span>: <span class="title class_">TooltipProps</span> &amp; &#123; virtualTriggering?: <span class="built_in">boolean</span> &#125;,</span></span><br><span class="line"><span class="params">  <span class="attr">triggerNode</span>: <span class="title class_">ComputedRef</span>&lt;<span class="title class_">HTMLElement</span> | <span class="literal">undefined</span>&gt;,</span></span><br><span class="line"><span class="params">  <span class="attr">events</span>: <span class="title class_">Ref</span>&lt;<span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="title class_">EventListener</span>&gt;&gt;,</span></span><br><span class="line"><span class="params">  <span class="attr">closeMethod</span>: () =&gt; <span class="built_in">void</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">watchEventsStopHandle</span>: <span class="title class_">WatchStopHandle</span> | <span class="built_in">void</span>;</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">watchTriggerNodeStopHandle</span>: <span class="title class_">WatchStopHandle</span> | <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> _eventHandleMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">_bindEventToVirtualTiggerNode</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> el = triggerNode.<span class="property">value</span>;</span><br><span class="line">    <span class="title function_">isElement</span>(el) &amp;&amp;</span><br><span class="line">      <span class="title function_">each</span>(events.<span class="property">value</span>, <span class="function">(<span class="params">fn, event</span>) =&gt;</span> &#123;</span><br><span class="line">        _eventHandleMap.<span class="title function_">set</span>(event, fn);</span><br><span class="line">        el?.<span class="title function_">addEventListener</span>(event <span class="keyword">as</span> keyof <span class="title class_">HTMLElementEventMap</span>, fn);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">_unbindEventToVirtualTiggerNode</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> el = triggerNode.<span class="property">value</span>;</span><br><span class="line">    <span class="title function_">isElement</span>(el) &amp;&amp;</span><br><span class="line">      <span class="title function_">each</span>(</span><br><span class="line">        [<span class="string">&quot;mouseenter&quot;</span>, <span class="string">&quot;click&quot;</span>, <span class="string">&quot;contextmenu&quot;</span>],</span><br><span class="line">        <span class="function">(<span class="params">key</span>) =&gt;</span></span><br><span class="line">          _eventHandleMap.<span class="title function_">has</span>(key) &amp;&amp;</span><br><span class="line">          el?.<span class="title function_">removeEventListener</span>(key, _eventHandleMap.<span class="title function_">get</span>(key))</span><br><span class="line">      );</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    watchTriggerNodeStopHandle = <span class="title function_">watch</span>(</span><br><span class="line">      triggerNode,</span><br><span class="line">      <span class="function">() =&gt;</span> props.<span class="property">virtualTriggering</span> &amp;&amp; <span class="title function_">_bindEventToVirtualTiggerNode</span>(),</span><br><span class="line">      &#123; <span class="attr">immediate</span>: <span class="literal">true</span> &#125;</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    watchEventsStopHandle = <span class="title function_">watch</span>(</span><br><span class="line">      events,</span><br><span class="line">      <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!props.<span class="property">virtualTriggering</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="title function_">_unbindEventToVirtualTiggerNode</span>();</span><br><span class="line">        <span class="title function_">_bindEventToVirtualTiggerNode</span>();</span><br><span class="line">        <span class="title function_">closeMethod</span>();</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; <span class="attr">deep</span>: <span class="literal">true</span> &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onUnmounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    watchTriggerNodeStopHandle?.();</span><br><span class="line">    watchEventsStopHandle?.();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useEvenstToTiggerNode;</span><br></pre></td></tr></table></figure>



<h3 id="├─-Upload"><a href="#├─-Upload" class="headerlink" title="├─ Upload"></a>├─ Upload</h3><blockquote>
<p>上传组件，用于上传文件</p>
</blockquote>
<h4 id="–API–-16"><a href="#–API–-16" class="headerlink" title="–API–"></a>–API–</h4><h4 id="├─-index-ts-17"><a href="#├─-index-ts-17" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Upload</span> <span class="keyword">from</span> <span class="string">&quot;./Upload.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErUpload</span> = <span class="title function_">withInstall</span>(<span class="title class_">Upload</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./types&quot;</span>;</span><br></pre></td></tr></table></figure>



<h4 id="├─-types-ts-2"><a href="#├─-types-ts-2" class="headerlink" title="├─ types.ts"></a>├─ types.ts</h4><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> <span class="title class_">UploadFileStatus</span> = <span class="string">&quot;ready&quot;</span> | <span class="string">&quot;uploading&quot;</span> | <span class="string">&quot;success&quot;</span> | <span class="string">&quot;error&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">UploadFile</span> &#123;</span><br><span class="line">  <span class="attr">uid</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">size</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">status</span>?: <span class="title class_">UploadFileStatus</span>;</span><br><span class="line">  <span class="attr">percent</span>?: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">raw</span>?: <span class="title class_">File</span>;</span><br><span class="line">  <span class="attr">response</span>?: <span class="built_in">any</span>;</span><br><span class="line">  <span class="attr">error</span>?: <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">UploadProps</span> &#123;</span><br><span class="line">  <span class="attr">action</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">defaultFileList</span>?: <span class="title class_">UploadFile</span>[];</span><br><span class="line">  beforeUpload?(<span class="attr">file</span>: <span class="title class_">File</span>): <span class="built_in">boolean</span> | <span class="title class_">Promise</span>&lt;<span class="title class_">File</span>&gt;;</span><br><span class="line">  onChange?(<span class="attr">file</span>: <span class="title class_">File</span>): <span class="built_in">void</span>;</span><br><span class="line">  onProgress?(<span class="attr">percentage</span>: <span class="built_in">number</span>, <span class="attr">file</span>: <span class="title class_">File</span>): <span class="built_in">void</span>;</span><br><span class="line">  onSuccess?(<span class="attr">data</span>: <span class="built_in">any</span>, <span class="attr">file</span>: <span class="title class_">File</span>): <span class="built_in">void</span>;</span><br><span class="line">  onError?(<span class="attr">err</span>: <span class="built_in">any</span>, <span class="attr">file</span>: <span class="title class_">File</span>): <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">  onRemove?(<span class="attr">file</span>: <span class="title class_">UploadFile</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">UploadListProps</span> &#123;</span><br><span class="line">  <span class="attr">fileList</span>: <span class="title class_">UploadFile</span>[];</span><br><span class="line">  onRemove?(<span class="attr">file</span>: <span class="title class_">UploadFile</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="├─-Upload-vue"><a href="#├─-Upload-vue" class="headerlink" title="├─ Upload.vue"></a>├─ Upload.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; UploadProps, UploadFile &#125; from &quot;./types&quot;;</span><br><span class="line">import ErButton from &quot;../Button/Button.vue&quot;;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line">import &#123; cloneDeep, each, isFunction &#125; from &quot;lodash-es&quot;;</span><br><span class="line">import axios, &#123; type AxiosProgressEvent &#125; from &quot;axios&quot;;</span><br><span class="line">import &#123; useId &#125; from &quot;@eric-ui/hooks&quot;;</span><br><span class="line">import UploadList from &quot;./UploadList.vue&quot;;</span><br><span class="line"></span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErUpload&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const props = defineProps&lt;UploadProps&gt;();</span><br><span class="line"></span><br><span class="line">const fileInputRef = ref&lt;HTMLInputElement&gt;();</span><br><span class="line">const fileList = ref&lt;UploadFile[]&gt;(props.defaultFileList ?? []);</span><br><span class="line"></span><br><span class="line">function setFileListItem(item: UploadFile) &#123;</span><br><span class="line">  const index = fileList.value.findIndex((file) =&gt; file.uid === item.uid);</span><br><span class="line">  if (index !== -1) &#123;</span><br><span class="line">    fileList.value.splice(index, 1, cloneDeep(item));</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    fileList.value.unshift(cloneDeep(item));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleClick() &#123;</span><br><span class="line">  fileInputRef.value?.click();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleFileChange(e: Event) &#123;</span><br><span class="line">  const files = (e.target as HTMLInputElement)?.files;</span><br><span class="line">  if (!files) return;</span><br><span class="line">  uploadFiles(files);</span><br><span class="line">  if (fileInputRef.value) &#123;</span><br><span class="line">    fileInputRef.value.value = &quot;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function uploadFiles(files: FileList) &#123;</span><br><span class="line">  const postFiles = Array.from(files);</span><br><span class="line">  each(postFiles, (file) =&gt; &#123;</span><br><span class="line">    if (!props?.beforeUpload) &#123;</span><br><span class="line">      post(file);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      const result = props.beforeUpload(file);</span><br><span class="line">      if (result &amp;&amp; result instanceof Promise) &#123;</span><br><span class="line">        result.then((processFile) =&gt; &#123;</span><br><span class="line">          post(processFile);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; else if (result !== false) &#123;</span><br><span class="line">        post(file);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function post(file: File) &#123;</span><br><span class="line">  const _file: UploadFile = &#123;</span><br><span class="line">    uid: useId().value + &quot;_upload-file_&quot; + Date.now(),</span><br><span class="line">    status: &quot;ready&quot;,</span><br><span class="line">    name: file.name,</span><br><span class="line">    size: file.size,</span><br><span class="line">    percent: 0,</span><br><span class="line">    raw: file,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  setFileListItem(_file);</span><br><span class="line"></span><br><span class="line">  const formData = new FormData();</span><br><span class="line">  formData.append(file.name, file);</span><br><span class="line">  axios</span><br><span class="line">    .postForm(props.action, formData, &#123;</span><br><span class="line">      headers: &#123;</span><br><span class="line">        &quot;Content-Type&quot;: &quot;multipart/form-data&quot;,</span><br><span class="line">      &#125;,</span><br><span class="line">      onUploadProgress: (e: AxiosProgressEvent) =&gt; &#123;</span><br><span class="line">        let percent = Math.round((e.loaded * 100) / e.total!) || 0;</span><br><span class="line"></span><br><span class="line">        _file.percent = percent;</span><br><span class="line">        if (percent &lt; 100) &#123;</span><br><span class="line">          _file.status = &quot;uploading&quot;;</span><br><span class="line">          setFileListItem(_file);</span><br><span class="line">        &#125;</span><br><span class="line">        isFunction(props.onProgress) &amp;&amp; props.onProgress(percent, file);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">    .then((resp: any) =&gt; &#123;</span><br><span class="line">      _file.status = &quot;success&quot;;</span><br><span class="line">      _file.response = resp.data;</span><br><span class="line">      isFunction(props.onSuccess) &amp;&amp; props.onSuccess(resp.data, file);</span><br><span class="line">      setFileListItem(_file);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch((err) =&gt; &#123;</span><br><span class="line">      _file.status = &quot;error&quot;;</span><br><span class="line">      isFunction(props.onError) &amp;&amp; props.onError(err, file);</span><br><span class="line">      setFileListItem(_file);</span><br><span class="line">    &#125;)</span><br><span class="line">    .finally(() =&gt; &#123;</span><br><span class="line">      isFunction(props.onChange) &amp;&amp; props.onChange(file);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function handleRemove(file: UploadFile) &#123;</span><br><span class="line">  fileList.value = fileList.value.filter((item) =&gt; item.uid !== file.uid);</span><br><span class="line">  isFunction(props.onRemove) &amp;&amp; props.onRemove(file);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;er-upload&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;er-upload__content&quot; @click=&quot;handleClick&quot;&gt;</span><br><span class="line">      &lt;slot&gt;</span><br><span class="line">        &lt;er-button type=&quot;primary&quot;&gt;Upload File&lt;/er-button&gt;</span><br><span class="line">      &lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;input</span><br><span class="line">      ref=&quot;fileInputRef&quot;</span><br><span class="line">      class=&quot;er-file-input&quot;</span><br><span class="line">      type=&quot;file&quot;</span><br><span class="line">      @change=&quot;handleFileChange&quot;</span><br><span class="line">      style=&quot;display: none&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">    &lt;upload-list :file-list=&quot;fileList&quot; :on-remove=&quot;handleRemove&quot; /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>



<h4 id="└─-UploadList-vue"><a href="#└─-UploadList-vue" class="headerlink" title="└─ UploadList.vue"></a>└─ UploadList.vue</h4><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; UploadListProps &#125; from &quot;./types&quot;;</span><br><span class="line">import ErIcon from &quot;../Icon/Icon.vue&quot;;</span><br><span class="line">defineOptions(&#123;</span><br><span class="line">  name: &quot;ErUploadList&quot;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">defineProps&lt;UploadListProps&gt;();</span><br><span class="line"></span><br><span class="line">const statusIconMap = new Map([</span><br><span class="line">  [&quot;success&quot;, &quot;check-circle&quot;],</span><br><span class="line">  [&quot;error&quot;, &quot;times-circle&quot;],</span><br><span class="line">  [&quot;uploading&quot;, &quot;spinner&quot;],</span><br><span class="line">]);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;ul class=&quot;er-upload-list&quot;&gt;</span><br><span class="line">    &lt;li v-for=&quot;item in fileList&quot; :key=&quot;item.uid&quot; class=&quot;er-upload-list__item&quot;&gt;</span><br><span class="line">      &lt;span class=&quot;file-name&quot; :class=&quot;&#123; [`file-name-$&#123;item.status&#125;`]: true &#125;&quot;&gt;</span><br><span class="line">        &lt;er-icon icon=&quot;file-alt&quot; /&gt;</span><br><span class="line">        &#123;&#123; item.name &#125;&#125;</span><br><span class="line">      &lt;/span&gt;</span><br><span class="line">      &lt;span</span><br><span class="line">        class=&quot;file-status&quot;</span><br><span class="line">        :class=&quot;&#123; [`file-status-$&#123;item.status&#125;`]: true &#125;&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;er-icon</span><br><span class="line">          :icon=&quot;statusIconMap.get(item.status || &#x27;&#x27;) ?? &#x27;&#x27;&quot;</span><br><span class="line">          :spin=&quot;item.status === &#x27;uploading&#x27;&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/span&gt;</span><br><span class="line">      &lt;span class=&quot;file-action&quot;&gt;</span><br><span class="line">        &lt;er-icon icon=&quot;times&quot; @click=&quot;onRemove?.(item)&quot; /&gt;</span><br><span class="line">      &lt;/span&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.er-upload-list &#123;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">  list-style-type: none;</span><br><span class="line">  .er-upload-list__item &#123;</span><br><span class="line">    transition: all 0.5s cubic-bezier(0.55, 0, 0.1, 1);</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    line-height: 1.8;</span><br><span class="line">    margin-top: 5px;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line">    min-width: 200px;</span><br><span class="line">    position: relative;</span><br><span class="line">    &amp;:first-child &#123;</span><br><span class="line">      margin-top: 10px;</span><br><span class="line">    &#125;</span><br><span class="line">    .file-name &#123;</span><br><span class="line">      margin-left: 5px;</span><br><span class="line">      margin-right: 40px;</span><br><span class="line">      color: var(--er-text-color-regular);</span><br><span class="line">      svg &#123;</span><br><span class="line">        margin-right: 5px;</span><br><span class="line">        color: var(--er-text-color-regular);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .file-name-error &#123;</span><br><span class="line">      color: var(--er-color-danger);</span><br><span class="line">    &#125;</span><br><span class="line">    .file-status-success &#123;</span><br><span class="line">      color: var(--er-color-success);</span><br><span class="line">    &#125;</span><br><span class="line">    .file-status-error &#123;</span><br><span class="line">      color: var(--er-color-danger);</span><br><span class="line">    &#125;</span><br><span class="line">    .file-status &#123;</span><br><span class="line">      display: block;</span><br><span class="line">      position: absolute;</span><br><span class="line">      right: 5px;</span><br><span class="line">      top: 0;</span><br><span class="line">      line-height: inherit;</span><br><span class="line">    &#125;</span><br><span class="line">    .file-action &#123;</span><br><span class="line">      display: none;</span><br><span class="line">      position: absolute;</span><br><span class="line">      right: 7px;</span><br><span class="line">      top: 0;</span><br><span class="line">      line-height: inherit;</span><br><span class="line">      cursor: pointer;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;:hover &#123;</span><br><span class="line">      background-color: var(--er-fill-color-light);</span><br><span class="line">      .file-status &#123;</span><br><span class="line">        display: none;</span><br><span class="line">      &#125;</span><br><span class="line">      .file-action &#123;</span><br><span class="line">        display: block;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>



<h3 id="├─-index-test-ts"><a href="#├─-index-test-ts" class="headerlink" title="├─ index.test.ts"></a>├─ index.test.ts</h3><blockquote>
</blockquote>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Plugin</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; describe, it, expect &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">ErAlert</span>,</span><br><span class="line">  <span class="title class_">ErButton</span>,</span><br><span class="line">  <span class="title class_">ErButtonGroup</span>,</span><br><span class="line">  <span class="title class_">ErCollapse</span>,</span><br><span class="line">  <span class="title class_">ErCollapseItem</span>,</span><br><span class="line">  <span class="title class_">ErDropdown</span>,</span><br><span class="line">  <span class="title class_">ErDropdownItem</span>,</span><br><span class="line">  <span class="title class_">ErForm</span>,</span><br><span class="line">  <span class="title class_">ErFormItem</span>,</span><br><span class="line">  <span class="title class_">ErIcon</span>,</span><br><span class="line">  <span class="title class_">ErInput</span>,</span><br><span class="line">  <span class="title class_">ErLoading</span>,</span><br><span class="line">  <span class="title class_">ErLoadingDirective</span>,</span><br><span class="line">  <span class="title class_">ErLoadingService</span>,</span><br><span class="line">  <span class="title class_">ErMessage</span>,</span><br><span class="line">  <span class="title class_">ErMessageBox</span>,</span><br><span class="line">  <span class="title class_">ErNotification</span>,</span><br><span class="line">  <span class="title class_">ErOption</span>,</span><br><span class="line">  <span class="title class_">ErPopconfirm</span>,</span><br><span class="line">  <span class="title class_">ErSelect</span>,</span><br><span class="line">  <span class="title class_">ErSwitch</span>,</span><br><span class="line">  <span class="title class_">ErTooltip</span>,</span><br><span class="line">  <span class="title class_">ErUpload</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;./index&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; map, get &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> components = [</span><br><span class="line">  <span class="title class_">ErButton</span>,</span><br><span class="line">  <span class="title class_">ErButtonGroup</span>,</span><br><span class="line">  <span class="title class_">ErCollapse</span>,</span><br><span class="line">  <span class="title class_">ErCollapseItem</span>,</span><br><span class="line">  <span class="title class_">ErIcon</span>,</span><br><span class="line">  <span class="title class_">ErDropdown</span>,</span><br><span class="line">  <span class="title class_">ErDropdownItem</span>,</span><br><span class="line">  <span class="title class_">ErTooltip</span>,</span><br><span class="line">  <span class="title class_">ErMessage</span>,</span><br><span class="line">  <span class="title class_">ErInput</span>,</span><br><span class="line">  <span class="title class_">ErSwitch</span>,</span><br><span class="line">  <span class="title class_">ErSelect</span>,</span><br><span class="line">  <span class="title class_">ErOption</span>,</span><br><span class="line">  <span class="title class_">ErForm</span>,</span><br><span class="line">  <span class="title class_">ErFormItem</span>,</span><br><span class="line">  <span class="title class_">ErAlert</span>,</span><br><span class="line">  <span class="title class_">ErNotification</span>,</span><br><span class="line">  <span class="title class_">ErLoading</span>,</span><br><span class="line">  <span class="title class_">ErUpload</span>,</span><br><span class="line">  <span class="title class_">ErPopconfirm</span>,</span><br><span class="line">  <span class="title class_">ErMessageBox</span>,</span><br><span class="line">] <span class="keyword">as</span> <span class="title class_">Plugin</span>[];</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;components/index.ts&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  it.<span class="title function_">each</span>(<span class="title function_">map</span>(components, <span class="function">(<span class="params">c</span>) =&gt;</span> [<span class="title function_">get</span>(c, <span class="string">&quot;name&quot;</span>) ?? <span class="string">&quot;&quot;</span>, c]))(<span class="string">&quot;%s should be exported&quot;</span>, <span class="function">(<span class="params">_, component</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(component).<span class="title function_">toBeDefined</span>();</span><br><span class="line">    <span class="title function_">expect</span>(component.<span class="property">install</span>).<span class="title function_">toBeDefined</span>()</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;ErLoadingService and ErLoadingDirective should be exported&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">ErLoadingService</span>).<span class="title function_">toBeDefined</span>()</span><br><span class="line">    <span class="title function_">expect</span>(<span class="title class_">ErLoadingDirective</span>).<span class="title function_">toBeDefined</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h3 id="├─-index-ts-18"><a href="#├─-index-ts-18" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h3><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;./ConfigProvider&#x27;</span></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Icon&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Button&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Collapse&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Dropdown&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Message&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Tooltip&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Input&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Switch&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Select&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Form&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Alert&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Notification&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Loading&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Upload&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./Popconfirm&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./MessageBox&quot;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="└─-package-json"><a href="#└─-package-json" class="headerlink" title="└─ package.json"></a>└─ package.json</h3><p><strong>项目依赖</strong></p>
<blockquote>
<p>无</p>
</blockquote>
<p><strong>开发依赖</strong></p>
<blockquote>
<ul>
<li><code>axios</code>：HTTP 客户端（用于测试或示例）。</li>
</ul>
</blockquote>
<h2 id="├─-constants"><a href="#├─-constants" class="headerlink" title="├─ constants"></a>├─ <em><del>constants</del></em></h2><blockquote>
<p>常量系统</p>
</blockquote>
<h3 id="├─-index-ts-19"><a href="#├─-index-ts-19" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h3><h3 id="├─-key-ts"><a href="#├─-key-ts" class="headerlink" title="├─ key.ts"></a>├─ key.ts</h3><h3 id="└─-package-json-1"><a href="#└─-package-json-1" class="headerlink" title="└─ package.json"></a>└─ package.json</h3><p><strong>项目依赖</strong></p>
<blockquote>
<p>空包</p>
</blockquote>
<p><strong>开发依赖</strong></p>
<blockquote>
<p><code>axios</code>：HTTP 客户端（用于测试或示例）。</p>
</blockquote>
<h2 id="├─-core"><a href="#├─-core" class="headerlink" title="├─ core"></a>├─ core</h2><blockquote>
<p>核心包托管模式</p>
<p>npm包的入口，同时作为 components 的唯一出口</p>
<p>负责聚合所有子模块（如 <code>components</code>, <code>hooks</code>, <code>theme</code>, <code>utils</code> 等）的功能，并提供给外部使用</p>
</blockquote>
<h3 id="├─-build"><a href="#├─-build" class="headerlink" title="├─ build"></a>├─ build</h3><blockquote>
<p>构建入口</p>
<p>放vite的两个配置文件</p>
</blockquote>
<h4 id="├─-vite-es-config-ts"><a href="#├─-vite-es-config-ts" class="headerlink" title="├─ vite.es.config.ts"></a>├─ vite.es.config.ts</h4><blockquote>
<p>ES Module 构建</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; readdirSync, readdir &#125; <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; resolve &#125; <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; defer, delay, filter, map, includes &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; visualizer &#125; <span class="keyword">from</span> <span class="string">&quot;rollup-plugin-visualizer&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; hooksPlugin <span class="keyword">as</span> hooks &#125; <span class="keyword">from</span> <span class="string">&quot;@tyche/vite-plugins&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> shell <span class="keyword">from</span> <span class="string">&quot;shelljs&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&quot;@vitejs/plugin-vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> dts <span class="keyword">from</span> <span class="string">&quot;vite-plugin-dts&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> terser <span class="keyword">from</span> <span class="string">&quot;@rollup/plugin-terser&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">TRY_MOVE_STYLES_DELAY</span> = <span class="number">750</span> <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isProd = process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;production&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> isDev = process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;development&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> isTest = process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;test&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getDirectoriesSync</span>(<span class="params"><span class="attr">basePath</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> entries = <span class="title function_">readdirSync</span>(basePath, &#123; <span class="attr">withFileTypes</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">map</span>(</span><br><span class="line">    <span class="title function_">filter</span>(entries, <span class="function">(<span class="params">entry</span>) =&gt;</span> entry.<span class="title function_">isDirectory</span>()),</span><br><span class="line">    <span class="function">(<span class="params">entry</span>) =&gt;</span> entry.<span class="property">name</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">moveStyles</span>(<span class="params"></span>) &#123; <span class="comment">//在构建完成后，将 dist/es/theme 目录移动到 dist 目录</span></span><br><span class="line">  <span class="title function_">readdir</span>(<span class="string">&quot;./dist/es/theme&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="title function_">delay</span>(moveStyles, <span class="variable constant_">TRY_MOVE_STYLES_DELAY</span>);</span><br><span class="line">    <span class="title function_">defer</span>(<span class="function">() =&gt;</span> shell.<span class="title function_">mv</span>(<span class="string">&quot;./dist/es/theme&quot;</span>, <span class="string">&quot;./dist&quot;</span>));<span class="comment">//使用 shell.mv 命令执行移动操作，通过 defer 和 delay 处理异步操作</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">vue</span>(),<span class="comment">//支持 Vue 3 的单文件组件</span></span><br><span class="line">    <span class="title function_">visualizer</span>(&#123;<span class="comment">//生成构建性能分析报告（dist/stats.es.html</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&quot;dist/stats.es.html&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title function_">dts</span>(&#123;<span class="comment">//生成 TypeScript 类型定义文件（dist/types/core/index.d.ts）</span></span><br><span class="line">      <span class="attr">tsconfigPath</span>: <span class="string">&quot;../../tsconfig.build.json&quot;</span>,</span><br><span class="line">      <span class="attr">outDir</span>: <span class="string">&quot;dist/types&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title function_">terser</span>(&#123;<span class="comment">//压缩代码（仅生产环境启用）</span></span><br><span class="line">      <span class="attr">compress</span>: &#123;</span><br><span class="line">        <span class="attr">sequences</span>: isProd,</span><br><span class="line">        <span class="attr">arguments</span>: isProd,</span><br><span class="line">        <span class="attr">drop_console</span>: isProd &amp;&amp; [<span class="string">&quot;log&quot;</span>],</span><br><span class="line">        <span class="attr">drop_debugger</span>: isProd,</span><br><span class="line">        <span class="attr">passes</span>: isProd ? <span class="number">4</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">global_defs</span>: &#123;</span><br><span class="line">          <span class="string">&quot;@DEV&quot;</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(isDev),</span><br><span class="line">          <span class="string">&quot;@PROD&quot;</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(isProd),</span><br><span class="line">          <span class="string">&quot;@TEST&quot;</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(isTest),</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">format</span>: &#123;</span><br><span class="line">        <span class="attr">semicolons</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">shorthand</span>: isProd,</span><br><span class="line">        <span class="attr">braces</span>: !isProd,</span><br><span class="line">        <span class="attr">beautify</span>: !isProd,</span><br><span class="line">        <span class="attr">comments</span>: !isProd,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">mangle</span>: &#123;</span><br><span class="line">        <span class="attr">toplevel</span>: isProd,</span><br><span class="line">        <span class="attr">eval</span>: isProd,</span><br><span class="line">        <span class="attr">keep_classnames</span>: isDev,</span><br><span class="line">        <span class="attr">keep_fnames</span>: isDev,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title function_">hooks</span>(&#123;<span class="comment">//自定义构建钩子，如清理文件和移动 CSS 文件</span></span><br><span class="line">      <span class="attr">rmFiles</span>: [</span><br><span class="line">        <span class="string">&quot;./dist/es&quot;</span>,</span><br><span class="line">        <span class="string">&quot;./dist/theme&quot;</span>,</span><br><span class="line">        <span class="string">&quot;./dist/types&quot;</span>,</span><br><span class="line">        <span class="string">&quot;./dist/stats.es.html&quot;</span>,</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">afterBuild</span>: moveStyles,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">outDir</span>: <span class="string">&quot;dist/es&quot;</span>,<span class="comment">//输出目录为 dist/es</span></span><br><span class="line">    <span class="attr">minify</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">cssCodeSplit</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">sourcemap</span>: !isProd,</span><br><span class="line">    <span class="attr">lib</span>: &#123;<span class="comment">//配置库的</span></span><br><span class="line">      <span class="attr">entry</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;../index.ts&quot;</span>),<span class="comment">//入口文件</span></span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;EricUI&quot;</span>,<span class="comment">//名称</span></span><br><span class="line">      <span class="attr">fileName</span>: <span class="string">&quot;index&quot;</span>,<span class="comment">//文件名</span></span><br><span class="line">      <span class="attr">formats</span>: [<span class="string">&quot;es&quot;</span>],<span class="comment">//格式</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">rollupOptions</span>: &#123;</span><br><span class="line">      <span class="attr">external</span>: [<span class="comment">//声明外部依赖，避免打包到最终输出中。</span></span><br><span class="line">        <span class="string">&quot;vue&quot;</span>,</span><br><span class="line">        <span class="string">&quot;@fortawesome/fontawesome-svg-core&quot;</span>,</span><br><span class="line">        <span class="string">&quot;@fortawesome/free-solid-svg-icons&quot;</span>,</span><br><span class="line">        <span class="string">&quot;@fortawesome/vue-fontawesome&quot;</span>,</span><br><span class="line">        <span class="string">&quot;@popperjs/core&quot;</span>,</span><br><span class="line">        <span class="string">&quot;async-validator&quot;</span>,</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">assetFileNames</span>: <span class="function">(<span class="params">chunkInfo</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (chunkInfo.<span class="property">name</span> === <span class="string">&quot;style.css&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;index.css&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (</span><br><span class="line">            chunkInfo.<span class="property">type</span> === <span class="string">&quot;asset&quot;</span> &amp;&amp;</span><br><span class="line">            <span class="regexp">/\.(css)$/i</span>.<span class="title function_">test</span>(chunkInfo.<span class="property">name</span> <span class="keyword">as</span> <span class="built_in">string</span>)</span><br><span class="line">          ) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;theme/[name].[ext]&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> chunkInfo.<span class="property">name</span> <span class="keyword">as</span> <span class="built_in">string</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">manualChunks</span>(<span class="params">id</span>) &#123;<span class="comment">//手动分块策略</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="title function_">includes</span>(id, <span class="string">&quot;node_modules&quot;</span>)) <span class="keyword">return</span> <span class="string">&quot;vendor&quot;</span>;<span class="comment">//第三方库</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="title function_">includes</span>(id, <span class="string">&quot;/packages/hooks&quot;</span>)) <span class="keyword">return</span> <span class="string">&quot;hooks&quot;</span>;<span class="comment">//自定义钩子</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="title function_">includes</span>(id, <span class="string">&quot;/packages/utils&quot;</span>) || <span class="title function_">includes</span>(id, <span class="string">&quot;plugin-vue:export-helper&quot;</span>)) <span class="keyword">return</span> <span class="string">&quot;utils&quot;</span>;<span class="comment">//工具函数</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> <span class="title function_">getDirectoriesSync</span>(<span class="string">&quot;../components&quot;</span>)) &#123;</span><br><span class="line">            <span class="comment">//组件目录（如 components/xxx） → 对应组件名称的分块</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">includes</span>(id, <span class="string">`/packages/components/<span class="subst">$&#123;item&#125;</span>`</span>)) <span class="keyword">return</span> item;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="└─-vite-umd-config-ts"><a href="#└─-vite-umd-config-ts" class="headerlink" title="└─ vite.umd.config.ts"></a>└─ vite.umd.config.ts</h4><blockquote>
<p>UMD 构建</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; readFile &#125; <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;<span class="comment">//同步读取（文件）</span></span><br><span class="line"><span class="keyword">import</span> &#123; resolve &#125; <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; defer, delay &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; visualizer &#125; <span class="keyword">from</span> <span class="string">&quot;rollup-plugin-visualizer&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; hooksPlugin <span class="keyword">as</span> hooks &#125; <span class="keyword">from</span> <span class="string">&quot;@tyche/vite-plugins&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> shell <span class="keyword">from</span> <span class="string">&quot;shelljs&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&quot;@vitejs/plugin-vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> compression <span class="keyword">from</span> <span class="string">&quot;vite-plugin-compression&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> terser <span class="keyword">from</span> <span class="string">&quot;@rollup/plugin-terser&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">TRY_MOVE_STYLES_DELAY</span> = <span class="number">750</span> <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isProd = process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;production&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> isDev = process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;development&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> isTest = process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;test&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">moveStyles</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">readFile</span>(<span class="string">&quot;./dist/umd/index.css.gz&quot;</span>, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="title function_">delay</span>(moveStyles, <span class="variable constant_">TRY_MOVE_STYLES_DELAY</span>);</span><br><span class="line">    <span class="title function_">defer</span>(<span class="function">() =&gt;</span> shell.<span class="title function_">cp</span>(<span class="string">&quot;./dist/umd/index.css&quot;</span>, <span class="string">&quot;./dist/index.css&quot;</span>));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">vue</span>(),</span><br><span class="line">    <span class="title function_">compression</span>(&#123;</span><br><span class="line">      <span class="attr">filter</span>: <span class="regexp">/.(cjs|css)$/i</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title function_">visualizer</span>(&#123;</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&quot;dist/stats.umd.html&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title function_">terser</span>(&#123;</span><br><span class="line">      <span class="attr">compress</span>: &#123;</span><br><span class="line">        <span class="attr">drop_console</span>: [<span class="string">&quot;log&quot;</span>],</span><br><span class="line">        <span class="attr">drop_debugger</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">passes</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">global_defs</span>: &#123;</span><br><span class="line">          <span class="string">&quot;@DEV&quot;</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(isDev),</span><br><span class="line">          <span class="string">&quot;@PROD&quot;</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(isProd),</span><br><span class="line">          <span class="string">&quot;@TEST&quot;</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(isTest),</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title function_">hooks</span>(&#123;</span><br><span class="line">      <span class="attr">rmFiles</span>: [<span class="string">&quot;./dist/umd&quot;</span>, <span class="string">&quot;./dist/index.css&quot;</span>, <span class="string">&quot;./dist/stats.umd.html&quot;</span>],</span><br><span class="line">      <span class="attr">afterBuild</span>: moveStyles,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">outDir</span>: <span class="string">&quot;dist/umd&quot;</span>,</span><br><span class="line">    <span class="attr">lib</span>: &#123;</span><br><span class="line">      <span class="attr">entry</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;../index.ts&quot;</span>),</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;EricUI&quot;</span>,</span><br><span class="line">      <span class="attr">fileName</span>: <span class="string">&quot;index&quot;</span>,</span><br><span class="line">      <span class="attr">formats</span>: [<span class="string">&quot;umd&quot;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">rollupOptions</span>: &#123;</span><br><span class="line">      <span class="attr">external</span>: [<span class="string">&quot;vue&quot;</span>],</span><br><span class="line">      <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">exports</span>: <span class="string">&quot;named&quot;</span>,</span><br><span class="line">        <span class="attr">globals</span>: &#123;</span><br><span class="line">          <span class="attr">vue</span>: <span class="string">&quot;Vue&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">assetFileNames</span>: <span class="function">(<span class="params">chunkInfo</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (chunkInfo.<span class="property">name</span> === <span class="string">&quot;style.css&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;index.css&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> chunkInfo.<span class="property">name</span> <span class="keyword">as</span> <span class="built_in">string</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="├─-componens-ts"><a href="#├─-componens-ts" class="headerlink" title="├─ componens.ts"></a>├─ <em><del>componens.ts</del></em></h3><blockquote>
<p>集中导出组件</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ErButton</span>, <span class="title class_">ErButtonGroup</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@tyche/components&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Plugin</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> [<span class="title class_">ErButton</span>, <span class="title class_">ErButtonGroup</span>] <span class="keyword">as</span> <span class="title class_">Plugin</span>[]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>将组件注册为 Vue 插件，用户通过 <code>app.use(Tyche)</code> 可以一次性安装所有组件。</p>
</blockquote>
<h3 id="├─-index-ts-20"><a href="#├─-index-ts-20" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h3><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; library &#125; <span class="keyword">from</span> <span class="string">&quot;@fortawesome/fontawesome-svg-core&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; fas &#125; <span class="keyword">from</span> <span class="string">&quot;@fortawesome/free-solid-svg-icons&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; makeInstaller &#125; <span class="keyword">from</span> <span class="string">&#x27;@tyche/utils&#x27;</span></span><br><span class="line"><span class="keyword">import</span> components <span class="keyword">from</span> <span class="string">&#x27;./components&#x27;</span></span><br><span class="line"><span class="keyword">import</span> printLogo <span class="keyword">from</span> <span class="string">&quot;./pringLogo&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@tyche/theme/index.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">printLogo</span>();</span><br><span class="line"></span><br><span class="line">library.<span class="title function_">add</span>(fas);</span><br><span class="line"><span class="keyword">const</span> installer = <span class="title function_">makeInstaller</span>(components);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;@tyche/components&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> installer</span><br></pre></td></tr></table></figure>

<h3 id="├─-makeInstaller-ts"><a href="#├─-makeInstaller-ts" class="headerlink" title="├─ makeInstaller.ts"></a>├─ <em><del>makeInstaller.ts</del></em></h3><blockquote>
<p>全局注册+构建配置</p>
<p><strong>插件安装器</strong>：将组件集合转换为 Vue 插件，并支持全局配置（如主题、国际化）</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">makeInstaller</span>(<span class="params"><span class="attr">components</span>: <span class="title class_">Plugin</span>[]</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">install</span> = (<span class="params"><span class="attr">app</span>: <span class="title class_">App</span>, <span class="attr">options</span>?: <span class="title class_">ConfigProviderProps</span></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">get</span>(app, <span class="variable constant_">INSTALLED_KEY</span>)) <span class="keyword">return</span>;</span><br><span class="line">        <span class="title function_">set</span>(app, <span class="variable constant_">INSTALLED_KEY</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="title function_">each</span>(components, <span class="function">(<span class="params">c</span>) =&gt;</span> app.<span class="title function_">use</span>(c));</span><br><span class="line">        <span class="keyword">if</span> (options) <span class="title function_">provideGlobalConfig</span>(options, app, <span class="literal">true</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> install;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>防止重复安装插件。</li>
<li>通过 <code>app.use</code> 注册所有组件。</li>
<li>支持全局配置（如通过 <code>provideGlobalConfig</code> 提供主题或默认选项）。</li>
</ul>
</blockquote>
<h3 id="├─-package-json-1"><a href="#├─-package-json-1" class="headerlink" title="├─ package.json"></a>├─ <em><del>package.json</del></em></h3><p><strong>项目依赖</strong></p>
<blockquote>
<ul>
<li><code>@fortawesome/fontawesome-svg-core</code></li>
<li><code>@fortawesome/free-solid-svg-icons</code></li>
<li><code>@fortawesome/vue-fontawesome</code></li>
<li><code>@popperjs/core</code></li>
<li><code>async-validator</code></li>
</ul>
</blockquote>
<p><strong>开发依赖</strong></p>
<blockquote>
<ul>
<li><code>@rollup/plugin-terser</code>：Rollup 压缩插件</li>
<li><code>rollup-plugin-visualizer</code>：打包分析插件</li>
<li><code>vite-plugin-compression</code>：文件压缩插件</li>
</ul>
</blockquote>
<p><strong>项目元数据与依赖管理</strong>：定义构建目标、入口文件、依赖关系等</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tyche&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;使用 Vue3 + Ts 构建的组件库&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;module&quot;</span><span class="punctuation">,</span><span class="comment">//指定使用 ES 模块</span></span><br><span class="line">    <span class="attr">&quot;files&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;dist&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sideEffects&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;./dist/index.css&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;./dist/theme/*.css&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/umd/index.umd.cjs&quot;</span><span class="punctuation">,</span><span class="comment">//CommonJS 格式的入口文件</span></span><br><span class="line">    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/es/index.js&quot;</span><span class="punctuation">,</span><span class="comment">//ESM 格式的入口文件</span></span><br><span class="line">    <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/types/core/index.d.ts&quot;</span><span class="punctuation">,</span><span class="comment">//TypeScript 类型定义文件的位置</span></span><br><span class="line">    <span class="attr">&quot;exports&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="comment">//定义模块导出路径</span></span><br><span class="line">        <span class="attr">&quot;.&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="comment">//分别指向不同环境的入口文件</span></span><br><span class="line">            <span class="attr">&quot;import&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/es/index.js&quot;</span><span class="punctuation">,</span> <span class="comment">//ESM 入口</span></span><br><span class="line">            <span class="attr">&quot;require&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/umd/index.umd.cjs&quot;</span><span class="punctuation">,</span> <span class="comment">//CommonJS 入口</span></span><br><span class="line">            <span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/types/core/index.d.ts&quot;</span> <span class="comment">//TypeScript 类型定义</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;./dist/&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="comment">//额外指定了对 dist 目录下资源的导入规则</span></span><br><span class="line">            <span class="attr">&quot;import&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;require&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./dist/&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;run-p build-es build-umd&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;build:watch&quot;</span><span class="punctuation">:</span> <span class="string">&quot;run-p build-es:watch build-umd:watch&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;build-es&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vite build --config build/vite.es.config.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;build-umd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vite build --config build/vite.umd.config.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;build-es:watch&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vite build --watch --config build/vite.es.config.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;build-umd:watch&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vite build --watch --config build/vite.umd.config.ts&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;keywords&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Breezli&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span><span class="punctuation">,</span><span class="comment">//许可证类型为 ISC，一个简化的开源许可证</span></span><br><span class="line">    <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="comment">//开发环境</span></span><br><span class="line">        <span class="attr">&quot;@rollup/plugin-terser&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^0.4.4&quot;</span><span class="punctuation">,</span><span class="comment">//Rollup 插件，用于压缩代码</span></span><br><span class="line">        <span class="attr">&quot;rollup-plugin-visualizer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.12.0&quot;</span><span class="punctuation">,</span><span class="comment">//提供构建结果的可视化分析</span></span><br><span class="line">        <span class="attr">&quot;terser&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.31.0&quot;</span><span class="punctuation">,</span><span class="comment">//JavaScript 解析器和压缩工具</span></span><br><span class="line">        <span class="attr">&quot;vite-plugin-compression&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^0.5.1&quot;</span><span class="comment">//Vite 插件，用于压缩资源文件</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@fortawesome/fontawesome-svg-core&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.5.1&quot;</span><span class="punctuation">,</span><span class="comment">//FontAwesome 图标集</span></span><br><span class="line">        <span class="attr">&quot;@fortawesome/free-solid-svg-icons&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.5.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;@fortawesome/vue-fontawesome&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.0.6&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;@popperjs/core&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.11.8&quot;</span><span class="punctuation">,</span><span class="comment">//Popper.js 核心库，通常用于定位提示框、菜单等元素</span></span><br><span class="line">        <span class="attr">&quot;async-validator&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.2.5&quot;</span><span class="comment">//异步表单验证库</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;peerDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.4.27&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>&#x2F;&#x2F;&#x2F; <em>补充：peerDependencies</em> &#x2F;&#x2F;&#x2F;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">├── helloWorld</span><br><span class="line">│   └── node_modules</span><br><span class="line">│       ├── packageA</span><br><span class="line">│       ├── plugin1</span><br><span class="line">│       │   └── nodule_modules</span><br><span class="line">│       │       └── packageA</span><br><span class="line">│       └── plugin2</span><br><span class="line">│       │   └── nodule_modules</span><br><span class="line">│       │       └── packageA</span><br></pre></td></tr></table></figure>

<blockquote>
<p>packageA 核心依赖库被重复下载</p>
</blockquote>
<p>此时我们应该在</p>
<p><strong><code>plugin1 /package.json</code></strong>  <em>&amp;</em>  <strong><code>plugin2 /package.json</code></strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;peerDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;packageA&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong><code>/package.json</code></strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;packageA&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>结构就变成了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">├── helloWorld</span><br><span class="line">│   └── node_modules</span><br><span class="line">│       ├── packageA</span><br><span class="line">│       ├── plugin1</span><br><span class="line">│       └── plugin2</span><br></pre></td></tr></table></figure>

<blockquote>
<p>通常用于库或插件，这些库或插件不直接包含在最终应用中，但需要与其他包协同工作</p>
<p>当你安装一个包时，如果该包有peerDependencies，npm或yarn会检查这些依赖是否已经安装在项目中，如果没有，它会给出警告，但不会默认安装它们</p>
</blockquote>
<h3 id="└─-pringLogo-ts"><a href="#└─-pringLogo-ts" class="headerlink" title="└─ pringLogo.ts"></a>└─ <em><del>pringLogo.ts</del></em></h3><blockquote>
<p><strong>构建时输出 Logo 和提示信息</strong>：在生产环境构建时打印彩色 Logo，在开发环境提示当前模式。</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable constant_">PROD</span>) &#123; <span class="comment">// 项目正在`生产环境`中运行</span></span><br><span class="line">    <span class="keyword">const</span> logo = <span class="string">`...`</span>; <span class="comment">// 彩色渐变的 EricUI Logo 文字</span></span><br><span class="line">    <span class="keyword">const</span> rainbowGradient = <span class="string">`...`</span>; <span class="comment">// CSS 样式</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`%c<span class="subst">$&#123;logo&#125;</span>`</span>, rainbowGradient);</span><br><span class="line">      <span class="comment">//%c 是占位符，表示接下来的一个参数 (rainbowGradient) 应该被解释为CSS样式。</span></span><br><span class="line">      <span class="comment">//$&#123;logo&#125; 是实际要打印到控制台的文字内容（即那个ASCII艺术风格的logo）。</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable constant_">DEV</span>) &#123; <span class="comment">// 项目处于`开发模式`下</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[EricUI]:dev mode...&quot;</span>); <span class="comment">// 简单地向控制台输出一条 &quot;[EricUI]:dev mode...&quot;。有助于开发者快速识别项目的当前状态是处于开发阶段</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="├─-docs"><a href="#├─-docs" class="headerlink" title="├─ docs"></a>├─ <em><del>docs</del></em></h2><blockquote>
<p>组件库项目文档，vitepress站点</p>
</blockquote>
<h3 id="├─-vitepress"><a href="#├─-vitepress" class="headerlink" title="├─ .vitepress"></a>├─ .vitepress</h3><h4 id="├─-config-ts"><a href="#├─-config-ts" class="headerlink" title="├─ config.ts"></a>├─ config.ts</h4><h4 id="└─-theme"><a href="#└─-theme" class="headerlink" title="└─ theme"></a>└─ theme</h4><h5 id="└─-index-ts"><a href="#└─-index-ts" class="headerlink" title="└─ index.ts"></a>└─ index.ts</h5><h3 id="├─-components-1"><a href="#├─-components-1" class="headerlink" title="├─ components"></a>├─ components</h3><h4 id="├─-alert-md"><a href="#├─-alert-md" class="headerlink" title="├─ alert.md"></a>├─ alert.md</h4><h4 id="├─-button-md"><a href="#├─-button-md" class="headerlink" title="├─ button.md"></a>├─ button.md</h4><h4 id="├─-collapse-md"><a href="#├─-collapse-md" class="headerlink" title="├─ collapse.md"></a>├─ collapse.md</h4><h4 id="├─-dropdown-md"><a href="#├─-dropdown-md" class="headerlink" title="├─ dropdown.md"></a>├─ dropdown.md</h4><h4 id="├─-form-md"><a href="#├─-form-md" class="headerlink" title="├─ form.md"></a>├─ form.md</h4><h4 id="├─-loading-md"><a href="#├─-loading-md" class="headerlink" title="├─ loading.md"></a>├─ loading.md</h4><h4 id="├─-message-md"><a href="#├─-message-md" class="headerlink" title="├─ message.md"></a>├─ message.md</h4><h4 id="├─-messagebox-md"><a href="#├─-messagebox-md" class="headerlink" title="├─ messagebox.md"></a>├─ messagebox.md</h4><h4 id="├─-notification-md"><a href="#├─-notification-md" class="headerlink" title="├─ notification.md"></a>├─ notification.md</h4><h4 id="├─-popconfirm-md"><a href="#├─-popconfirm-md" class="headerlink" title="├─ popconfirm.md"></a>├─ popconfirm.md</h4><h4 id="└─-tooltip-md"><a href="#└─-tooltip-md" class="headerlink" title="└─ tooltip.md"></a>└─ tooltip.md</h4><h3 id="├─-demo"><a href="#├─-demo" class="headerlink" title="├─ demo"></a>├─ demo</h3><h4 id="├─-alert"><a href="#├─-alert" class="headerlink" title="├─ alert"></a>├─ alert</h4><p>├─ Basic.vue<br>├─ Close.vue<br>├─ Desc.vue<br>├─ IconDesc.vue<br>├─ ShowIcon.vue<br>├─ TextCenter.vue<br>└─ Theme.vue</p>
<h4 id="├─-button"><a href="#├─-button" class="headerlink" title="├─ button"></a>├─ button</h4><p>├─ Basic.vue<br>├─ Disabled.vue<br>├─ Group.vue<br>├─ Icon.vue<br>├─ Loading.vue<br>├─ Size.vue<br>├─ Tag.vue<br>└─ Throttle.vue</p>
<h4 id="├─-collapse"><a href="#├─-collapse" class="headerlink" title="├─ collapse"></a>├─ collapse</h4><p>├─ Accordion.vue<br>├─ Basic.vue<br>├─ CustomTitle.vue<br>└─ Disabled.vue</p>
<h4 id="│-│-│-├─-dropdown"><a href="#│-│-│-├─-dropdown" class="headerlink" title="│  │  │  ├─ dropdown"></a>│  │  │  ├─ dropdown</h4><p>├─ Basic.vue<br>├─ Command.vue<br>├─ Disabled.vue<br>├─ HideOnClick.vue<br>├─ InstanceMethod.vue<br>├─ Size.vue<br>├─ SplitButton.vue<br>└─ Trigger.vue</p>
<h4 id="├─-form"><a href="#├─-form" class="headerlink" title="├─ form"></a>├─ form</h4><p>├─ Basic.vue<br>├─ CustomValidate.vue<br>├─ Position.vue<br>└─ Validate.vue</p>
<h4 id="├─-loading"><a href="#├─-loading" class="headerlink" title="├─ loading"></a>├─ loading</h4><p>├─ Basic.vue<br>├─ Custom.vue<br>└─ Fullscreen.vue</p>
<h4 id="├─-message"><a href="#├─-message" class="headerlink" title="├─ message"></a>├─ message</h4><p>├─ Basic.vue<br>├─ Center.vue<br>├─ Closeable.vue<br>├─ Test.vue<br>└─ Type.vue</p>
<h4 id="├─-messagebox"><a href="#├─-messagebox" class="headerlink" title="├─ messagebox"></a>├─ messagebox</h4><p>├─ Alert.vue<br>├─ Center.vue<br>├─ Confirm.vue<br>├─ Custom.vue<br>├─ Prompt.vue<br>└─ VNode.vue</p>
<h4 id="├─-notification"><a href="#├─-notification" class="headerlink" title="├─ notification"></a>├─ notification</h4><p>├─ Basic.vue<br>├─ Closeable.vue<br>└─ Type.vue</p>
<h4 id="├─-popconfirm"><a href="#├─-popconfirm" class="headerlink" title="├─ popconfirm"></a>├─ popconfirm</h4><p>├─ Basic.vue<br>├─ Callback.vue<br>└─ Custom.vue</p>
<h4 id="└─-tooltip"><a href="#└─-tooltip" class="headerlink" title="└─ tooltip"></a>└─ tooltip</h4><p>├─ Basic.vue<br>├─ Disabled.vue<br>└─ Slot.vue</p>
<h3 id="├─-get-started-md"><a href="#├─-get-started-md" class="headerlink" title="├─ get-started.md"></a>├─ get-started.md</h3><h3 id="├─-index-md"><a href="#├─-index-md" class="headerlink" title="├─ index.md"></a>├─ index.md</h3><h3 id="└─-package-json-2"><a href="#└─-package-json-2" class="headerlink" title="└─ package.json"></a>└─ package.json</h3><p><strong>依赖（dependencies）</strong></p>
<blockquote>
<p><strong>无</strong>（通过根目录继承）。</p>
</blockquote>
<p><strong>开发依赖（devDependencies）</strong></p>
<blockquote>
<ul>
<li><code>@vitepress-demo-preview/component</code>：VitePress 组件预览插件</li>
<li><code>@vitepress-demo-preview/plugin</code>：VitePress 插件</li>
<li><code>vitepress</code>：文档框架</li>
</ul>
</blockquote>
<h2 id="├─-hooks"><a href="#├─-hooks" class="headerlink" title="├─ hooks"></a>├─ <em><del>hooks</del></em></h2><blockquote>
<p>钩子函数, 自定义的 Vue 组合式 API</p>
<p>逻辑复用, 用于处理各种功能需求</p>
</blockquote>
<h3 id="├─-index-ts-21"><a href="#├─-index-ts-21" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h3><blockquote>
<p><code>hooks</code> 的入口文件，导出所有 API</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> useClickOutside <span class="keyword">from</span> <span class="string">&quot;./useClickOutside&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useEventListener <span class="keyword">from</span> <span class="string">&quot;./useEventListener&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useFocusController <span class="keyword">from</span> <span class="string">&quot;./useFocusController&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useZIndex <span class="keyword">from</span> <span class="string">&quot;./useZIndex&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useProp <span class="keyword">from</span> <span class="string">&quot;./useProp&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useDisabledStyle <span class="keyword">from</span> <span class="string">&quot;./useDisabledStyle&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useId <span class="keyword">from</span> <span class="string">&quot;./useId&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useLocale <span class="keyword">from</span> <span class="string">&quot;./useLocale&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useOffset <span class="keyword">from</span> <span class="string">&quot;./useOffset&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  useClickOutside,</span><br><span class="line">  useEventListener,</span><br><span class="line">  useZIndex,</span><br><span class="line">  useProp,</span><br><span class="line">  useFocusController,</span><br><span class="line">  useDisabledStyle,</span><br><span class="line">  useLocale,</span><br><span class="line">  useOffset,</span><br><span class="line">  useId,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="├─-package-json-2"><a href="#├─-package-json-2" class="headerlink" title="├─ package.json"></a>├─ package.json</h3><p><strong>依赖</strong></p>
<blockquote>
<p>无</p>
</blockquote>
<p><strong>peerDependencies（必须由用户安装）</strong></p>
<blockquote>
<ul>
<li><code>vue</code>：Vue 3 核心库</li>
<li><code>lodash-es</code>：Lodash 的 ES 模块版本</li>
</ul>
</blockquote>
<h3 id="├─-useClickOutside-ts"><a href="#├─-useClickOutside-ts" class="headerlink" title="├─ useClickOutside.ts"></a>├─ useClickOutside.ts</h3><blockquote>
<p>监听用户是否点击了某个 DOM 元素之外的区域</p>
</blockquote>
<blockquote>
<p>实现 <strong>下拉菜单</strong>、<strong>弹窗</strong> 等需要点击外部关闭的功能</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">type</span> <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> useEventListener <span class="keyword">from</span> <span class="string">&#x27;./useEventListener&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useClickOutside</span> (<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">elementRef</span>: <span class="title class_">Ref</span>&lt;<span class="title class_">HTMLElement</span> | <span class="built_in">void</span>&gt;,</span></span><br><span class="line"><span class="params">  <span class="attr">callback</span>: (e: MouseEvent) =&gt; <span class="built_in">void</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">useEventListener</span>(<span class="variable language_">document</span>, <span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params"><span class="attr">e</span>: <span class="title class_">Event</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (elementRef.<span class="property">value</span> &amp;&amp; e.<span class="property">target</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (!elementRef.<span class="property">value</span>.<span class="title function_">contains</span>(e.<span class="property">target</span> <span class="keyword">as</span> <span class="title class_">HTMLElement</span>)) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(e <span class="keyword">as</span> <span class="title class_">MouseEvent</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-useDisabledStyle-ts"><a href="#├─-useDisabledStyle-ts" class="headerlink" title="├─ useDisabledStyle.ts"></a>├─ useDisabledStyle.ts</h3><blockquote>
<p>动态控制组件的禁用样式</p>
</blockquote>
<blockquote>
<p>可以根据 <code>disabled</code> 属性动态添加或移除样式类</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; each, isFunction, cloneDeep, assign &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; watchEffect, useSlots, getCurrentInstance, <span class="keyword">type</span> <span class="title class_">VNode</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">_dfs</span> = (<span class="params"><span class="attr">nodes</span>: <span class="title class_">VNode</span>[], <span class="attr">cb</span>: (node: VNode) =&gt; <span class="built_in">void</span></span>) =&gt;</span><br><span class="line">  <span class="title function_">each</span>(nodes, <span class="function">(<span class="params">node</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">isFunction</span>(cb) &amp;&amp; <span class="title function_">cb</span>(node);</span><br><span class="line">    node.<span class="property">children</span> &amp;&amp; <span class="title function_">_dfs</span>(node.<span class="property">children</span> <span class="keyword">as</span> <span class="title class_">VNode</span>[], cb);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useDisabledStyle</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> nodePropsMap = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> instance = <span class="title function_">getCurrentInstance</span>()!;</span><br><span class="line">  <span class="keyword">const</span> children = <span class="title function_">useSlots</span>()?.<span class="property">default</span>?.();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!instance.<span class="property">props</span>?.<span class="property">disabled</span>) &#123;</span><br><span class="line">      <span class="title function_">_dfs</span>(children ?? [], <span class="function">(<span class="params">node</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!nodePropsMap.<span class="title function_">has</span>(node)) <span class="keyword">return</span>;</span><br><span class="line">        node.<span class="property">props</span> = nodePropsMap.<span class="title function_">get</span>(node);</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">_dfs</span>(children ?? [], <span class="function">(<span class="params">node</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!node?.<span class="property">props</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">      nodePropsMap.<span class="title function_">set</span>(node, <span class="title function_">cloneDeep</span>(node.<span class="property">props</span>));</span><br><span class="line">      node.<span class="property">props</span> = <span class="title function_">assign</span>(node?.<span class="property">props</span>, &#123;</span><br><span class="line">        <span class="attr">style</span>: &#123;</span><br><span class="line">          <span class="attr">cursor</span>: <span class="string">&quot;not-allowed&quot;</span>,</span><br><span class="line">          <span class="attr">color</span>: <span class="string">&quot;var(--er-text-color-placeholder)&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useDisabledStyle;</span><br></pre></td></tr></table></figure>



<h3 id="├─-useEventListener-ts"><a href="#├─-useEventListener-ts" class="headerlink" title="├─ useEventListener.ts"></a>├─ useEventListener.ts</h3><blockquote>
<p>封装了一个通用的 <strong>事件监听器</strong></p>
</blockquote>
<blockquote>
<p>支持在组件生命周期内</p>
<p>自动绑定和解绑事件</p>
<p>避免内存泄漏</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  onMounted,</span><br><span class="line">  onBeforeUnmount,</span><br><span class="line">  watch,</span><br><span class="line">  isRef,</span><br><span class="line">  unref,</span><br><span class="line">  <span class="keyword">type</span> <span class="title class_">MaybeRef</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useEventListener</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">target</span>: <span class="title class_">MaybeRef</span>&lt;<span class="title class_">EventTarget</span> | <span class="title class_">HTMLElement</span> | <span class="built_in">void</span>&gt;,</span></span><br><span class="line"><span class="params">  <span class="attr">event</span>: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">handler</span>: (e: Event) =&gt; <span class="built_in">any</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isRef</span>(target)) &#123;</span><br><span class="line">    <span class="title function_">watch</span>(target, <span class="function">(<span class="params">val, oldVal</span>) =&gt;</span> &#123;</span><br><span class="line">      oldVal?.<span class="title function_">removeEventListener</span>(event, handler);</span><br><span class="line">      val?.<span class="title function_">addEventListener</span>(event, handler);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> target?.<span class="title function_">addEventListener</span>(event, handler));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onBeforeUnmount</span>(<span class="function">() =&gt;</span> <span class="title function_">unref</span>(target)?.<span class="title function_">removeEventListener</span>(event, handler));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-useFocusController-ts"><a href="#├─-useFocusController-ts" class="headerlink" title="├─ useFocusController.ts"></a>├─ useFocusController.ts</h3><blockquote>
<p>对焦点的管理功能</p>
</blockquote>
<blockquote>
<p>聚焦某个元素或在多个元素之间切换焦点</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; isFunction &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getCurrentInstance, ref, <span class="keyword">type</span> <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> useEventListener <span class="keyword">from</span> <span class="string">&quot;./useEventListener&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">UseFocusControllerOptions</span> &#123;</span><br><span class="line">  afterFocus?(): <span class="built_in">void</span>;</span><br><span class="line">  beforeBlur?(<span class="attr">event</span>: <span class="title class_">FocusEvent</span>): <span class="built_in">boolean</span> | <span class="built_in">void</span>;</span><br><span class="line">  afterBlur?(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> useFocusController&lt;T <span class="keyword">extends</span> <span class="title class_">HTMLElement</span> | &#123; <span class="title function_">focus</span>(): <span class="built_in">void</span> &#125;&gt;(</span><br><span class="line">  <span class="attr">target</span>: <span class="title class_">Ref</span>&lt;T | <span class="built_in">void</span>&gt;,</span><br><span class="line">  &#123; afterFocus, beforeBlur, afterBlur &#125;: <span class="title class_">UseFocusControllerOptions</span> = &#123;&#125;</span><br><span class="line">) &#123;</span><br><span class="line">  <span class="keyword">const</span> instance = <span class="title function_">getCurrentInstance</span>()!;</span><br><span class="line">  <span class="keyword">const</span> &#123; emit &#125; = instance;</span><br><span class="line">  <span class="keyword">const</span> wrapperRef = ref&lt;<span class="title class_">HTMLElement</span>&gt;();</span><br><span class="line">  <span class="keyword">const</span> isFocused = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleFocus</span> = (<span class="params"><span class="attr">event</span>: <span class="title class_">FocusEvent</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (isFocused.<span class="property">value</span>) <span class="keyword">return</span>;</span><br><span class="line">    isFocused.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="title function_">emit</span>(<span class="string">&quot;focus&quot;</span>, event);</span><br><span class="line">    afterFocus?.();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleBlur</span> = (<span class="params"><span class="attr">event</span>: <span class="title class_">FocusEvent</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> cancelBlur = <span class="title function_">isFunction</span>(beforeBlur) ? <span class="title function_">beforeBlur</span>(event) : <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      cancelBlur ||</span><br><span class="line">      (event.<span class="property">relatedTarget</span> &amp;&amp;</span><br><span class="line">        wrapperRef.<span class="property">value</span>?.<span class="title function_">contains</span>(event.<span class="property">relatedTarget</span> <span class="keyword">as</span> <span class="title class_">Node</span>))</span><br><span class="line">    )</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    isFocused.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="title function_">emit</span>(<span class="string">&quot;blur&quot;</span>, event);</span><br><span class="line">    afterBlur?.();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    target.<span class="property">value</span>?.<span class="title function_">focus</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEventListener</span>(wrapperRef, <span class="string">&quot;click&quot;</span>, handleClick);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    wrapperRef,</span><br><span class="line">    isFocused,</span><br><span class="line">    handleFocus,</span><br><span class="line">    handleBlur,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useFocusController;</span><br></pre></td></tr></table></figure>



<h3 id="├─-useId-ts"><a href="#├─-useId-ts" class="headerlink" title="├─ useId.ts"></a>├─ useId.ts</h3><blockquote>
<p>生成唯一的 ID</p>
</blockquote>
<blockquote>
<p>通常用于组件内部需要唯一标识符的场景</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">type</span> <span class="title class_">Ref</span>, computed &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> defaultIdInjection = &#123;</span><br><span class="line">  <span class="attr">prefix</span>: <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">10000</span>),</span><br><span class="line">  <span class="attr">current</span>: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useId</span>(<span class="params"><span class="attr">namespace</span>: <span class="built_in">string</span> = <span class="string">&quot;er&quot;</span></span>): <span class="title class_">Ref</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> idRef = <span class="title function_">computed</span>(</span><br><span class="line">    <span class="function">() =&gt;</span></span><br><span class="line">      <span class="string">`<span class="subst">$&#123;namespace&#125;</span>-id-<span class="subst">$&#123;</span></span></span><br><span class="line"><span class="subst"><span class="string">        defaultIdInjection.prefix</span></span></span><br><span class="line"><span class="subst"><span class="string">      &#125;</span>-<span class="subst">$&#123;defaultIdInjection.current++&#125;</span>`</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> idRef;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useId;</span><br></pre></td></tr></table></figure>



<h3 id="├─-useLocale-ts"><a href="#├─-useLocale-ts" class="headerlink" title="├─ useLocale.ts"></a>├─ useLocale.ts</h3><blockquote>
<p>提供国际化（i18n）支持</p>
</blockquote>
<blockquote>
<p>动态获取当前语言环境下的文本内容</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; inject, <span class="keyword">type</span> <span class="title class_">Ref</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; omit &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createI18n, i18nSymbol, <span class="keyword">type</span> I18nInstance &#125; <span class="keyword">from</span> <span class="string">&quot;vue3-i18n&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Language</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/locale&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">English</span> <span class="keyword">from</span> <span class="string">&quot;@eric-ui/locale/lang/en&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useLocale</span>(<span class="params"><span class="attr">localeOverrides</span>?: <span class="title class_">Ref</span>&lt;<span class="title class_">Language</span>&gt;</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!localeOverrides) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">omit</span>(</span><br><span class="line">      &lt;I18nInstance&gt;(</span><br><span class="line">        <span class="title function_">inject</span>(</span><br><span class="line">          i18nSymbol,</span><br><span class="line">          <span class="title function_">createI18n</span>(&#123; <span class="attr">locale</span>: <span class="title class_">English</span>.<span class="property">name</span>, <span class="attr">messages</span>: &#123; <span class="attr">en</span>: <span class="title class_">English</span>.<span class="property">el</span> &#125; &#125;)</span><br><span class="line">        )</span><br><span class="line">      ),</span><br><span class="line">      <span class="string">&quot;install&quot;</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">omit</span>(</span><br><span class="line">    <span class="title function_">createI18n</span>(&#123;</span><br><span class="line">      <span class="attr">locale</span>: localeOverrides.<span class="property">value</span>.<span class="property">name</span>,</span><br><span class="line">      <span class="attr">messages</span>: &#123;</span><br><span class="line">        <span class="attr">en</span>: <span class="title class_">English</span>.<span class="property">el</span>,</span><br><span class="line">        [localeOverrides.<span class="property">value</span>.<span class="property">name</span>]: localeOverrides.<span class="property">value</span>.<span class="property">el</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="string">&quot;install&quot;</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useLocale;</span><br></pre></td></tr></table></figure>



<h3 id="├─-useOffset-ts"><a href="#├─-useOffset-ts" class="headerlink" title="├─ useOffset.ts"></a>├─ useOffset.ts</h3><blockquote>
<p>计算某个 DOM 元素相对于视口或其他父级元素的偏移量</p>
</blockquote>
<blockquote>
<p>实现 <strong>悬浮层</strong>、**弹出框 **等需要精确定位的功能</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">type</span> <span class="title class_">Ref</span>, computed &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> useOffsetOptions &#123;</span><br><span class="line">  <span class="comment">// id: string;</span></span><br><span class="line">  <span class="attr">offset</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">boxHeight</span>: <span class="title class_">Ref</span>&lt;<span class="built_in">number</span>&gt;;</span><br><span class="line">  <span class="attr">getLastBottomOffset</span>: <span class="function">() =&gt;</span> <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> useOffsetResult &#123;</span><br><span class="line">  <span class="attr">topOffset</span>: <span class="title class_">Ref</span>&lt;<span class="built_in">number</span>&gt;;</span><br><span class="line">  <span class="attr">bottomOffset</span>: <span class="title class_">Ref</span>&lt;<span class="built_in">number</span>&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useOffset</span>(<span class="params"><span class="attr">opts</span>: useOffsetOptions</span>): useOffsetResult &#123;</span><br><span class="line">  <span class="comment">// 上一个实例最下面的坐标，第一个是0</span></span><br><span class="line">  <span class="keyword">const</span> lastBottomOffset = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> opts.<span class="title function_">getLastBottomOffset</span>());</span><br><span class="line">  <span class="comment">// 本元素应该的 top</span></span><br><span class="line">  <span class="keyword">const</span> topOffset = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> opts.<span class="property">offset</span> + lastBottomOffset.<span class="property">value</span>);</span><br><span class="line">  <span class="comment">// 为下一个实例预留的底部 offset</span></span><br><span class="line">  <span class="keyword">const</span> bottomOffset = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> topOffset.<span class="property">value</span> + opts.<span class="property">boxHeight</span>.<span class="property">value</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    topOffset,</span><br><span class="line">    bottomOffset,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useOffset;</span><br></pre></td></tr></table></figure>



<h3 id="├─-useProp-ts"><a href="#├─-useProp-ts" class="headerlink" title="├─ useProp.ts"></a>├─ useProp.ts</h3><blockquote>
<p>封装了对组件 <code>props</code> 的处理逻辑</p>
</blockquote>
<blockquote>
<p>提供更安全的默认值和类型检查</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; computed, getCurrentInstance, <span class="keyword">type</span> <span class="title class_">ComputedRef</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> useProp&lt;T&gt;(<span class="attr">propName</span>: <span class="built_in">string</span>): <span class="title class_">ComputedRef</span>&lt;T | <span class="built_in">void</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> instance = <span class="title function_">getCurrentInstance</span>();</span><br><span class="line">  <span class="keyword">if</span> (!instance) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;useProp must be used within a component&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">computed</span>(<span class="function">() =&gt;</span> (instance?.<span class="property">proxy</span>?.<span class="property">$props</span> <span class="keyword">as</span> <span class="built_in">any</span>)?.[propName] <span class="keyword">as</span> T);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-useZIndex-ts"><a href="#├─-useZIndex-ts" class="headerlink" title="├─ useZIndex.ts"></a>├─ useZIndex.ts</h3><blockquote>
<p>管理弹窗的 <code>z-index</code>层级,确保组件的层级关系正确</p>
</blockquote>
<blockquote>
<p>如 <strong>弹窗</strong>、**加载遮罩 **等</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; computed, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> zIndex = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useZIndex</span>(<span class="params">initialValue = <span class="number">2000</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> _initialValue = <span class="title function_">ref</span>(initialValue);</span><br><span class="line">  <span class="keyword">const</span> currentZindex = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> zIndex.<span class="property">value</span> + _initialValue.<span class="property">value</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">nextZIndex</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    zIndex.<span class="property">value</span>++;</span><br><span class="line">    <span class="keyword">return</span> currentZindex.<span class="property">value</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">initialValue</span>: _initialValue,</span><br><span class="line">    currentZindex,</span><br><span class="line">    nextZIndex,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-vite-config-ts"><a href="#├─-vite-config-ts" class="headerlink" title="├─ vite.config.ts"></a>├─ vite.config.ts</h3><blockquote>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; resolve &#125; <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; last, split, first, includes &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; hooksPlugin <span class="keyword">as</span> hooks &#125; <span class="keyword">from</span> <span class="string">&quot;@eric-ui/vite-plugins&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> dts <span class="keyword">from</span> <span class="string">&quot;vite-plugin-dts&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="title function_">dts</span>(&#123;</span><br><span class="line">      <span class="attr">include</span>: [<span class="string">&quot;./**/*.ts&quot;</span>],</span><br><span class="line">      <span class="attr">exclude</span>: [<span class="string">&quot;./vite.config.ts&quot;</span>],</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title function_">hooks</span>(&#123;</span><br><span class="line">      <span class="attr">rmFiles</span>: [<span class="string">&quot;./dist&quot;</span>],</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">minify</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">lib</span>: &#123;</span><br><span class="line">      <span class="attr">entry</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./index.ts&quot;</span>),</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;hooks&quot;</span>,</span><br><span class="line">      <span class="attr">fileName</span>: <span class="string">&quot;index&quot;</span>,</span><br><span class="line">      <span class="attr">formats</span>: [<span class="string">&quot;es&quot;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">rollupOptions</span>: &#123;</span><br><span class="line">      <span class="attr">external</span>: [<span class="string">&quot;vue&quot;</span>, <span class="string">&quot;lodash-es&quot;</span>, <span class="string">&quot;vue3-i18n&quot;</span>],</span><br><span class="line">      <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="title function_">manualChunks</span>(<span class="params">id</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (<span class="title function_">includes</span>(id, <span class="string">&quot;/packages/hooks/use&quot;</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">first</span>(<span class="title function_">split</span>(<span class="title function_">last</span>(<span class="title function_">split</span>(id, <span class="string">&quot;/&quot;</span>)), <span class="string">&quot;.&quot;</span>));</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h3 id="└─-test"><a href="#└─-test" class="headerlink" title="└─ test"></a>└─ <strong>test</strong></h3><blockquote>
<p>测试文件</p>
</blockquote>
<h4 id="├─-index-test-tsx"><a href="#├─-index-test-tsx" class="headerlink" title="├─ index.test.tsx"></a>├─ index.test.tsx</h4><blockquote>
<p>对 <code>hooks</code> 入口文件的单元测试</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, expect, it &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useClickOutside,useEventListener&#125; <span class="keyword">from</span> <span class="string">&#x27;..&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;hooks/index&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;useEventListener should be exported&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="title function_">expect</span>(useEventListener).<span class="title function_">toBeDefined</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;useClickOutside should be exported&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="title function_">expect</span>(useClickOutside).<span class="title function_">toBeDefined</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h4 id="├─-useClickOutset-test-tsx"><a href="#├─-useClickOutset-test-tsx" class="headerlink" title="├─ useClickOutset.test.tsx"></a>├─ useClickOutset.test.tsx</h4><blockquote>
<p>对 <code>useClickOutside</code> 的单元测试</p>
</blockquote>
<blockquote>
<p>验证其点击外部区域的行为是否符合预期</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, expect, it, vi &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, defineComponent &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&quot;@vue/test-utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> useClickOutside <span class="keyword">from</span> <span class="string">&quot;../useClickOutside&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;hooks/useClickOutside&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;should add &quot;click-outside&quot; listener&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> target = ref&lt;<span class="title class_">HTMLElement</span> | <span class="built_in">void</span>&gt;();</span><br><span class="line">    <span class="keyword">const</span> btnRef = ref&lt;<span class="title class_">HTMLButtonElement</span> | <span class="built_in">void</span>&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handler = vi.<span class="title function_">fn</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">mount</span>(</span><br><span class="line">      <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">        <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="title function_">useClickOutside</span>(target, handler);</span><br><span class="line">          <span class="keyword">return</span> <span class="function">() =&gt;</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;target&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">button</span> <span class="attr">ref</span>=<span class="string">&#123;btnRef&#125;</span>&gt;</span>click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> btnRef.<span class="property">value</span>?.<span class="title function_">click</span>();</span><br><span class="line">    <span class="title function_">expect</span>(handler).<span class="property">not</span>.<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">click</span>();</span><br><span class="line">    <span class="title function_">expect</span>(handler).<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h4 id="└─-useEventListener-test-tsx"><a href="#└─-useEventListener-test-tsx" class="headerlink" title="└─ useEventListener.test.tsx"></a>└─ useEventListener.test.tsx</h4><blockquote>
<p>对 <code>useEventListener</code> 的单元测试</p>
</blockquote>
<blockquote>
<p>验证事件监听器的绑定和解绑是否正常</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, expect, it, vi &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ref, defineComponent &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&quot;@vue/test-utils&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> useEventListener <span class="keyword">from</span> <span class="string">&quot;../useEventListener&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;hooks/useEventListener&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should add and remove event listener when target is HTMLElement&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> target = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;button&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> handler = vi.<span class="title function_">fn</span>();</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(</span><br><span class="line">      <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">        <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="title function_">useEventListener</span>(target, <span class="string">&quot;click&quot;</span>, handler);</span><br><span class="line">          <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">    wrapper.<span class="title function_">get</span>(<span class="string">&quot;#container&quot;</span>).<span class="property">element</span>.<span class="title function_">appendChild</span>(target);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> target.<span class="title function_">click</span>();</span><br><span class="line">    <span class="title function_">expect</span>(handler).<span class="title function_">toHaveBeenCalledOnce</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">unmount</span>();</span><br><span class="line">    <span class="keyword">await</span> target.<span class="title function_">click</span>();</span><br><span class="line">    <span class="title function_">expect</span>(handler).<span class="title function_">toHaveBeenCalledOnce</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;should add and remove event listener when target is Ref&lt;HTMLElement&gt;&quot;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> target = ref&lt;<span class="title class_">HTMLElement</span> | <span class="built_in">void</span>&gt;();</span><br><span class="line">    <span class="keyword">const</span> handler = vi.<span class="title function_">fn</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">mount</span>(</span><br><span class="line">      <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">        <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="title function_">useEventListener</span>(target, <span class="string">&quot;click&quot;</span>, handler);</span><br><span class="line">          <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;target&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;container&#x27;</span>)?.<span class="title function_">click</span>()</span><br><span class="line">    <span class="keyword">await</span> target.<span class="property">value</span>?.<span class="title function_">click</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(handler).<span class="title function_">toHaveBeenCalledOnce</span>();</span><br><span class="line"></span><br><span class="line">    target.<span class="property">value</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;container&#x27;</span>)?.<span class="title function_">click</span>()</span><br><span class="line">    <span class="title function_">expect</span>(handler).<span class="title function_">toHaveBeenCalledOnce</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h2 id="├─-locale"><a href="#├─-locale" class="headerlink" title="├─ locale"></a>├─ <em><del>locale</del></em></h2><blockquote>
<p>国际化</p>
</blockquote>
<h3 id="├─-index-ts-22"><a href="#├─-index-ts-22" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h3><h3 id="├─-lang"><a href="#├─-lang" class="headerlink" title="├─ lang"></a>├─ lang</h3><blockquote>
<p>语言包</p>
</blockquote>
<h4 id="├─-en-ts"><a href="#├─-en-ts" class="headerlink" title="├─ en.ts"></a>├─ en.ts</h4><h4 id="├─-ja-ts"><a href="#├─-ja-ts" class="headerlink" title="├─ ja.ts"></a>├─ ja.ts</h4><h4 id="├─-ko-ts"><a href="#├─-ko-ts" class="headerlink" title="├─ ko.ts"></a>├─ ko.ts</h4><h4 id="├─-zh-cn-ts"><a href="#├─-zh-cn-ts" class="headerlink" title="├─ zh-cn.ts"></a>├─ zh-cn.ts</h4><h4 id="└─-zh-tw-ts"><a href="#└─-zh-tw-ts" class="headerlink" title="└─ zh-tw.ts"></a>└─ zh-tw.ts</h4><h3 id="└─-package-json-3"><a href="#└─-package-json-3" class="headerlink" title="└─ package.json"></a>└─ package.json</h3><blockquote>
<p>空包</p>
</blockquote>
<h2 id="├─-play"><a href="#├─-play" class="headerlink" title="├─ play"></a>├─ <em><del>play</del></em></h2><blockquote>
<p>storybook实验室</p>
</blockquote>
<h3 id="├─-storybook"><a href="#├─-storybook" class="headerlink" title="├─ .storybook"></a>├─ .storybook</h3><h4 id="├─-main-js"><a href="#├─-main-js" class="headerlink" title="├─ main.js"></a>├─ main.js</h4><h4 id="└─-preview-js"><a href="#└─-preview-js" class="headerlink" title="└─ preview.js"></a>└─ preview.js</h4><h3 id="├─-index-html"><a href="#├─-index-html" class="headerlink" title="├─ index.html"></a>├─ index.html</h3><h3 id="├─-public"><a href="#├─-public" class="headerlink" title="├─ public"></a>├─ public</h3><h4 id="└─-vite-svg"><a href="#└─-vite-svg" class="headerlink" title="└─ vite.svg"></a>└─ vite.svg</h4><h3 id="├─-src"><a href="#├─-src" class="headerlink" title="├─ src"></a>├─ src</h3><h4 id="├─-App-vue"><a href="#├─-App-vue" class="headerlink" title="├─ App.vue"></a>├─ App.vue</h4><h4 id="├─-main-ts"><a href="#├─-main-ts" class="headerlink" title="├─ main.ts"></a>├─ main.ts</h4><h4 id="├─-stories"><a href="#├─-stories" class="headerlink" title="├─ stories"></a>├─ stories</h4><h5 id="├─-Alert-stories-tsx"><a href="#├─-Alert-stories-tsx" class="headerlink" title="├─ Alert.stories.tsx"></a>├─ Alert.stories.tsx</h5><h5 id="├─-Button-stories-ts"><a href="#├─-Button-stories-ts" class="headerlink" title="├─ Button.stories.ts"></a>├─ Button.stories.ts</h5><h5 id="└─-Collapse-stories-ts"><a href="#└─-Collapse-stories-ts" class="headerlink" title="└─ Collapse.stories.ts"></a>└─ Collapse.stories.ts</h5><h4 id="└─-vite-env-d-ts"><a href="#└─-vite-env-d-ts" class="headerlink" title="└─ vite-env.d.ts"></a>└─ vite-env.d.ts</h4><h3 id="├─-vite-config-ts-1"><a href="#├─-vite-config-ts-1" class="headerlink" title="├─ vite.config.ts"></a>├─ vite.config.ts</h3><h3 id="├─-README-md"><a href="#├─-README-md" class="headerlink" title="├─ README.md"></a>├─ README.md</h3><h3 id="└─-package-json-4"><a href="#└─-package-json-4" class="headerlink" title="└─ package.json"></a>└─ package.json</h3><p><strong>项目依赖</strong></p>
<blockquote>
<p>无，通过根目录继承</p>
</blockquote>
<p><strong>开发依赖</strong></p>
<blockquote>
<ul>
<li><code>@chromatic-com/storybook</code>：Chromatic 截图测试工具</li>
<li><code>@storybook/addon-*</code>：Storybook 的扩展插件</li>
<li><code>@storybook/vue3</code>：Storybook 的 Vue 3 支持</li>
<li><code>@storybook/vue3-vite</code>：Storybook 的 Vite 集成</li>
<li><code>@vitejs/plugin-vue</code>：Vite 的 Vue 插件</li>
<li><code>chromatic</code>：Chromatic 命令行工具</li>
<li><code>storybook</code>：Storybook 核心</li>
</ul>
</blockquote>
<h2 id="├─-theme"><a href="#├─-theme" class="headerlink" title="├─ theme"></a>├─ <em><del>theme</del></em></h2><blockquote>
<p>样式系统</p>
<p><strong>样式构建流程集中在 <code>core</code> 包</strong></p>
<p>采用 <strong>核心包托管模式</strong></p>
<p><code>theme</code> 包仅作为源码存在</p>
</blockquote>
<h3 id="├─-index-css"><a href="#├─-index-css" class="headerlink" title="├─ index.css"></a>├─ index.css</h3><h3 id="├─-package-json-3"><a href="#├─-package-json-3" class="headerlink" title="├─ package.json"></a>├─ package.json</h3><p><strong>项目依赖</strong></p>
<blockquote>
<p>无</p>
</blockquote>
<h3 id="└─-reset-css"><a href="#└─-reset-css" class="headerlink" title="└─ reset.css"></a>└─ reset.css</h3><h2 id="└─-utils"><a href="#└─-utils" class="headerlink" title="└─ utils"></a>└─ <em><del>utils</del></em></h2><blockquote>
<p>工具函数和辅助方法，支持组件库的底层逻辑</p>
</blockquote>
<h3 id="├─-error-ts"><a href="#├─-error-ts" class="headerlink" title="├─ error.ts"></a>├─ error.ts</h3><blockquote>
<p>错误处理相关的工具函数</p>
<p>例如 <strong>抛出错误</strong>、<strong>捕获异常</strong> 等</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; isString &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ErUIError</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Error</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">message</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(message);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&quot;ErUIError&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">throwError</span>(<span class="params"><span class="attr">scope</span>: <span class="built_in">string</span>, <span class="attr">msg</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ErUIError</span>(<span class="string">`[<span class="subst">$&#123;scope&#125;</span>] <span class="subst">$&#123;msg&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">debugWarn</span>(<span class="params"><span class="attr">error</span>: <span class="title class_">Error</span></span>): <span class="built_in">void</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">debugWarn</span>(<span class="params"><span class="attr">scope</span>: <span class="built_in">string</span>, <span class="attr">msg</span>: <span class="built_in">string</span></span>): <span class="built_in">void</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">debugWarn</span>(<span class="params"><span class="attr">scope</span>: <span class="built_in">string</span> | <span class="title class_">Error</span>, <span class="attr">msg</span>?: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&quot;production&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> err = <span class="title function_">isString</span>(scope) ? <span class="keyword">new</span> <span class="title class_">ErUIError</span>(<span class="string">`[<span class="subst">$&#123;scope&#125;</span>] <span class="subst">$&#123;msg&#125;</span>`</span>) : scope;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(err);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="├─-index-ts-23"><a href="#├─-index-ts-23" class="headerlink" title="├─ index.ts"></a>├─ index.ts</h3><blockquote>
<p>导出公共类型或接口</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineComponent &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; isFunction &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">RenderVnode</span> = <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">vNode</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: [<span class="title class_">String</span>, <span class="title class_">Object</span>, <span class="title class_">Function</span>],</span><br><span class="line">      <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> (<span class="title function_">isFunction</span>(props.<span class="property">vNode</span>) ? props.<span class="title function_">vNode</span>() : props.<span class="property">vNode</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> typeIconMap = <span class="keyword">new</span> <span class="title class_">Map</span>([</span><br><span class="line">  [<span class="string">&quot;info&quot;</span>, <span class="string">&quot;circle-info&quot;</span>],</span><br><span class="line">  [<span class="string">&quot;success&quot;</span>, <span class="string">&quot;check-circle&quot;</span>],</span><br><span class="line">  [<span class="string">&quot;warning&quot;</span>, <span class="string">&quot;circle-exclamation&quot;</span>],</span><br><span class="line">  [<span class="string">&quot;danger&quot;</span>, <span class="string">&quot;circle-xmark&quot;</span>],</span><br><span class="line">  [<span class="string">&quot;error&quot;</span>, <span class="string">&quot;circle-xmark&quot;</span>],</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./install&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./error&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&quot;./style&quot;</span>;</span><br></pre></td></tr></table></figure>



<h3 id="├─-install-ts"><a href="#├─-install-ts" class="headerlink" title="├─ install.ts"></a>├─ install.ts</h3><blockquote>
<p>给install附加一些方法和对象</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">App</span>, <span class="title class_">Plugin</span>, <span class="title class_">Directive</span> &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; noop &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">SFCWithInstall</span>&lt;T&gt; = T &amp; <span class="title class_">Plugin</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> withInstall = &lt;T&gt;<span class="function">(<span class="params"><span class="attr">component</span>: T</span>) =&gt;</span> &#123;</span><br><span class="line">  (component <span class="keyword">as</span> <span class="title class_">SFCWithInstall</span>&lt;T&gt;).<span class="property">install</span> = <span class="function">(<span class="params"><span class="attr">app</span>: <span class="title class_">App</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> name = (component <span class="keyword">as</span> <span class="built_in">any</span>)?.<span class="property">name</span> || <span class="string">&quot;UnnamedComponent&quot;</span>;</span><br><span class="line">    app.<span class="title function_">component</span>(name, component <span class="keyword">as</span> <span class="title class_">SFCWithInstall</span>&lt;T&gt;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> component <span class="keyword">as</span> <span class="title class_">SFCWithInstall</span>&lt;T&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> withInstallFunction = &lt;T&gt;<span class="function">(<span class="params"><span class="attr">fn</span>: T, <span class="attr">name</span>: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  (fn <span class="keyword">as</span> <span class="title class_">SFCWithInstall</span>&lt;T&gt;).<span class="property">install</span> = <span class="function">(<span class="params"><span class="attr">app</span>: <span class="title class_">App</span></span>) =&gt;</span> &#123;</span><br><span class="line">    app.<span class="property">config</span>.<span class="property">globalProperties</span>[name] = fn;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> fn <span class="keyword">as</span> <span class="title class_">SFCWithInstall</span>&lt;T&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> withInstallDirective = &lt;T <span class="keyword">extends</span> <span class="title class_">Directive</span>&gt;(</span><br><span class="line">  <span class="attr">directive</span>: T,</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">): <span class="title class_">SFCWithInstall</span>&lt;T&gt; =&gt; &#123;</span><br><span class="line">  (directive <span class="keyword">as</span> <span class="title class_">SFCWithInstall</span>&lt;T&gt;).<span class="property">install</span> = <span class="function">(<span class="params"><span class="attr">app</span>: <span class="title class_">App</span></span>) =&gt;</span> &#123;</span><br><span class="line">    app.<span class="title function_">directive</span>(name, directive);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> directive <span class="keyword">as</span> <span class="title class_">SFCWithInstall</span>&lt;T&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> withNoopInstall = &lt;T&gt;<span class="function">(<span class="params"><span class="attr">component</span>: T</span>) =&gt;</span> &#123;</span><br><span class="line">  (component <span class="keyword">as</span> <span class="title class_">SFCWithInstall</span>&lt;T&gt;).<span class="property">install</span> = noop;</span><br><span class="line">  <span class="keyword">return</span> component <span class="keyword">as</span> <span class="title class_">SFCWithInstall</span>&lt;T&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>使用举例</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErButton</span> = <span class="title function_">withInstall</span>(<span class="title class_">Button</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">ErButtonGroup</span> = <span class="title function_">withInstall</span>(<span class="title class_">ButtonGroup</span>);</span><br><span class="line">......</span><br></pre></td></tr></table></figure>



<h3 id="├─-package-json-4"><a href="#├─-package-json-4" class="headerlink" title="├─ package.json"></a>├─ package.json</h3><p><strong>依赖</strong></p>
<blockquote>
<p>无</p>
</blockquote>
<h3 id="├─-style-ts"><a href="#├─-style-ts" class="headerlink" title="├─ style.ts"></a>├─ style.ts</h3><blockquote>
<p>处理动态样式或 CSS 变量</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; isNumber, isString &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; debugWarn &#125; <span class="keyword">from</span> <span class="string">&quot;./error&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SCOPE</span> = <span class="string">&quot;utils/style&quot;</span> <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isStringNumber = (<span class="attr">val</span>: <span class="built_in">string</span>): <span class="function"><span class="params">boolean</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_">isString</span>(val)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> !<span class="title class_">Number</span>.<span class="built_in">isNaN</span>(<span class="title class_">Number</span>(val));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">addUnit</span>(<span class="params"><span class="attr">value</span>?: <span class="built_in">string</span> | <span class="built_in">number</span>, defaultUnit = <span class="string">&quot;px&quot;</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!value) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isNumber</span>(value) || <span class="title function_">isStringNumber</span>(value)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;value&#125;</span><span class="subst">$&#123;defaultUnit&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isString</span>(value)) &#123;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">debugWarn</span>(<span class="variable constant_">SCOPE</span>, <span class="string">&quot;binding value must be a string or number&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="└─-tests"><a href="#└─-tests" class="headerlink" title="└─ tests"></a>└─ <strong>tests</strong></h3><h4 id="├─-error-test-tsx"><a href="#├─-error-test-tsx" class="headerlink" title="├─ error.test.tsx"></a>├─ error.test.tsx</h4><blockquote>
<p>对 <code>error.ts</code> 的单元测试，验证错误处理逻辑是否正确</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;describe,expect,it,vi&#125; <span class="keyword">from</span> <span class="string">&#x27;vitest&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;debugWarn,throwError&#125; <span class="keyword">from</span> <span class="string">&#x27;../error&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;error&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;throwError should work&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="title function_">expect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">      <span class="title function_">throwError</span>(<span class="string">&#x27;scope&#x27;</span>, <span class="string">&#x27;message&#x27;</span>)</span><br><span class="line">    &#125;).<span class="title function_">toThrowError</span>(<span class="string">&#x27;[scope] message&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;debugWarn should work&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> warn = vi.<span class="title function_">spyOn</span>(<span class="variable language_">console</span>, <span class="string">&#x27;warn&#x27;</span>).<span class="title function_">mockImplementation</span>(<span class="function">()=&gt;</span> vi.<span class="property">fn</span>)</span><br><span class="line">    <span class="title function_">debugWarn</span>(<span class="string">&#x27;scope&#x27;</span>,<span class="string">&#x27;message&#x27;</span>)</span><br><span class="line">    <span class="title function_">debugWarn</span>(<span class="keyword">new</span> <span class="title class_">SyntaxError</span>(<span class="string">&#x27;custom error&#x27;</span>))</span><br><span class="line">    <span class="title function_">expect</span>(warn.<span class="property">mock</span>.<span class="property">calls</span>).<span class="title function_">toMatchInlineSnapshot</span>(<span class="string">`</span></span><br><span class="line"><span class="string">      [</span></span><br><span class="line"><span class="string">        [</span></span><br><span class="line"><span class="string">          [ErUIError: [scope] message],</span></span><br><span class="line"><span class="string">        ],</span></span><br><span class="line"><span class="string">        [</span></span><br><span class="line"><span class="string">          [SyntaxError: custom error],</span></span><br><span class="line"><span class="string">        ],</span></span><br><span class="line"><span class="string">      ]</span></span><br><span class="line"><span class="string">    `</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h4 id="├─-index-test-tsx-1"><a href="#├─-index-test-tsx-1" class="headerlink" title="├─ index.test.tsx"></a>├─ index.test.tsx</h4><blockquote>
<p>对 <code>utils</code> 入口文件的单元测试</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, expect, it &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  debugWarn,</span><br><span class="line">  throwError,</span><br><span class="line">  withInstall,</span><br><span class="line">  typeIconMap,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;../&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; each &#125; <span class="keyword">from</span> <span class="string">&quot;lodash-es&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;utils/index&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;debugWarn should be exported&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(debugWarn).<span class="title function_">toBeDefined</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;throwError should be exported&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(throwError).<span class="title function_">toBeDefined</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;withInstall should be exported&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(withInstall).<span class="title function_">toBeDefined</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;typeIconMap should be worked&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">expect</span>(typeIconMap).<span class="title function_">toBeDefined</span>();</span><br><span class="line">    <span class="title function_">each</span>(</span><br><span class="line">      [</span><br><span class="line">        [<span class="string">&quot;info&quot;</span>, <span class="string">&quot;circle-info&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;success&quot;</span>, <span class="string">&quot;check-circle&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;warning&quot;</span>, <span class="string">&quot;circle-exclamation&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;danger&quot;</span>, <span class="string">&quot;circle-xmark&quot;</span>],</span><br><span class="line">        [<span class="string">&quot;error&quot;</span>, <span class="string">&quot;circle-xmark&quot;</span>],</span><br><span class="line">      ],</span><br><span class="line">      <span class="function">(<span class="params">[<span class="keyword">type</span>, icon]</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">expect</span>(typeIconMap.<span class="title function_">get</span>(<span class="keyword">type</span>)).<span class="title function_">toBe</span>(icon);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h4 id="└─-install-test-tsx"><a href="#└─-install-test-tsx" class="headerlink" title="└─ install.test.tsx"></a>└─ install.test.tsx</h4><blockquote>
<p>对 <code>install.ts</code> 的单元测试，验证组件注册逻辑是否正常</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; describe, expect, it &#125; <span class="keyword">from</span> <span class="string">&quot;vitest&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; defineComponent, createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&quot;@vue/test-utils&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withInstall &#125; <span class="keyword">from</span> <span class="string">&quot;../install&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AppComp</span> = <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>app<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> componentA = <span class="title function_">withInstall</span>(</span><br><span class="line">  <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">    <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>test<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> componentB = <span class="title function_">withInstall</span>(</span><br><span class="line">  <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;test2&quot;</span>,</span><br><span class="line">    <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>test2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;install&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;withInstall should be worked&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wapper = <span class="title function_">mount</span>(<span class="function">() =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line">    <span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">AppComp</span>);</span><br><span class="line"></span><br><span class="line">    app.<span class="title function_">use</span>(componentA).<span class="title function_">use</span>(componentB).<span class="title function_">mount</span>(wapper.<span class="property">element</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(componentA.<span class="property">install</span>).<span class="title function_">toBeDefined</span>();</span><br><span class="line">    <span class="title function_">expect</span>(componentB.<span class="property">install</span>).<span class="title function_">toBeDefined</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wapper.<span class="title function_">findComponent</span>(componentA)).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wapper.<span class="title function_">findComponent</span>(componentB)).<span class="title function_">toBeTruthy</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h1 id="├─-package-json-5"><a href="#├─-package-json-5" class="headerlink" title="├─ package.json"></a>├─ <em><del>package.json</del></em></h1><blockquote>
<p>根目录依赖</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tyche&quot;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">		<span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pnpm --filter @tyche/play dev&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;story&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pnpm --filter @tyche/play storybook&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;docs:dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pnpm --filter @tyche/docs dev&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;docs:build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pnpm --filter @tyche/docs build&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pnpm --filter @tyche/components test&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;run-s build-hooks build-components&quot;</span><span class="punctuation">,</span><span class="comment">//构建 @tyche/docs 子项目的静态文档站点</span></span><br><span class="line">		<span class="attr">&quot;build-components&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cross-env NODE_ENV=production pnpm --filter tyche build&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;build-hooks&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cross-env NODE_ENV=production pnpm --filter @tyche/hooks build&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;build:dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;run-s build-hooks:dev build-components:dev&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;build-components:dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cross-env NODE_ENV=development pnpm --filter tyche build:watch&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;build-hooks:dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cross-env NODE_ENV=development pnpm --filter @tyche/hooks build&quot;</span></span><br><span class="line">	<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;keywords&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;packageManager&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pnpm@10.4.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="comment">//开发依赖</span></span><br><span class="line">		<span class="attr">&quot;@types/lodash-es&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.17.12&quot;</span><span class="punctuation">,</span>		<span class="comment">//Lodash 的 TypeScript 类型定义</span></span><br><span class="line">		<span class="attr">&quot;@types/node&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^20.12.12&quot;</span><span class="punctuation">,</span>			<span class="comment">//Node.js 的 TypeScript 类型定义</span></span><br><span class="line">		<span class="attr">&quot;@types/shelljs&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^0.8.15&quot;</span><span class="punctuation">,</span>		<span class="comment">//Shell.js 的 TypeScript 类型定义</span></span><br><span class="line">		<span class="attr">&quot;@vitejs/plugin-vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.2.3&quot;</span><span class="punctuation">,</span>		<span class="comment">//Vite 的 Vue 插件</span></span><br><span class="line">		<span class="attr">&quot;@vitejs/plugin-vue-jsx&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.1.0&quot;</span><span class="punctuation">,</span>	<span class="comment">//Vite 的 Vue JSX 插件</span></span><br><span class="line">		<span class="attr">&quot;@vitest/coverage-v8&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.6.1&quot;</span><span class="punctuation">,</span>	<span class="comment">//Vitest 的覆盖率插件</span></span><br><span class="line">		<span class="attr">&quot;@vue/test-utils&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.4.5&quot;</span><span class="punctuation">,</span>		<span class="comment">//Vue 测试工具</span></span><br><span class="line">		<span class="attr">&quot;@vue/tsconfig&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^0.5.1&quot;</span><span class="punctuation">,</span>			<span class="comment">//Vue 的 TypeScript 配置</span></span><br><span class="line">		<span class="attr">&quot;cross-env&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^7.0.3&quot;</span><span class="punctuation">,</span>				<span class="comment">//跨平台环境变量设置</span></span><br><span class="line">		<span class="attr">&quot;cssnano&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^7.0.1&quot;</span><span class="punctuation">,</span>				<span class="comment">//CSS 压缩工具</span></span><br><span class="line">		<span class="attr">&quot;jsdom&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^24.0.0&quot;</span><span class="punctuation">,</span>					<span class="comment">//JavaScript DOM 环境模拟</span></span><br><span class="line">		<span class="attr">&quot;npm-run-all&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.1.5&quot;</span><span class="punctuation">,</span>			<span class="comment">//并行运行脚本</span></span><br><span class="line">		<span class="attr">&quot;postcss-color-mix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.1.0&quot;</span><span class="punctuation">,</span>	<span class="comment">//PostCSS 插件</span></span><br><span class="line">		<span class="attr">&quot;postcss-each&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.1.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;postcss-each-variables&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^0.3.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;postcss-for&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.1.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;postcss-nested&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;prettier&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.2.5&quot;</span><span class="punctuation">,</span>			<span class="comment">//代码格式化工具</span></span><br><span class="line">		<span class="attr">&quot;rollup&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.18.0&quot;</span><span class="punctuation">,</span>			<span class="comment">//打包工具</span></span><br><span class="line">		<span class="attr">&quot;shelljs&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^0.8.5&quot;</span><span class="punctuation">,</span>			<span class="comment">//Shell 命令封装</span></span><br><span class="line">		<span class="attr">&quot;typescript&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.4.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;vite&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.4.14&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;vite-plugin-dts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.9.1&quot;</span><span class="punctuation">,</span>	<span class="comment">//生成 TypeScript 声明文件</span></span><br><span class="line">		<span class="attr">&quot;vitest&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.6.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;vue-tsc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.8.27&quot;</span>			<span class="comment">//Vue 的 TypeScript 编译器</span></span><br><span class="line">	<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">	<span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">		<span class="attr">&quot;@fortawesome/fontawesome-svg-core&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.5.2&quot;</span><span class="punctuation">,</span>	<span class="comment">//Font Awesome 图标库核心</span></span><br><span class="line">		<span class="attr">&quot;@fortawesome/free-solid-svg-icons&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.5.2&quot;</span><span class="punctuation">,</span>	<span class="comment">//Font Awesome 实体图标</span></span><br><span class="line">		<span class="attr">&quot;@fortawesome/vue-fontawesome&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.0.8&quot;</span><span class="punctuation">,</span>		<span class="comment">//Vue 3 的 Font Awesome 集成</span></span><br><span class="line">		<span class="attr">&quot;@popperjs/core&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.11.8&quot;</span><span class="punctuation">,</span>		<span class="comment">//用于弹窗定位的 Popper.js</span></span><br><span class="line">		<span class="attr">&quot;@tyche/components&quot;</span><span class="punctuation">:</span> <span class="string">&quot;workspace:*&quot;</span><span class="punctuation">,</span>	<span class="comment">//工作区内的组件库</span></span><br><span class="line">		<span class="attr">&quot;@tyche/hooks&quot;</span><span class="punctuation">:</span> <span class="string">&quot;workspace:*&quot;</span><span class="punctuation">,</span>		<span class="comment">//工作区内的钩子库</span></span><br><span class="line">		<span class="attr">&quot;@tyche/theme&quot;</span><span class="punctuation">:</span> <span class="string">&quot;workspace:*&quot;</span><span class="punctuation">,</span>		<span class="comment">//工作区内的主题库</span></span><br><span class="line">		<span class="attr">&quot;@tyche/utils&quot;</span><span class="punctuation">:</span> <span class="string">&quot;workspace:*&quot;</span><span class="punctuation">,</span>		<span class="comment">//工作区内的工具库</span></span><br><span class="line">		<span class="attr">&quot;@tyche/locale&quot;</span><span class="punctuation">:</span> <span class="string">&quot;workspace:*&quot;</span><span class="punctuation">,</span>		<span class="comment">//工作区内的国际化库</span></span><br><span class="line">		<span class="attr">&quot;@tyche/constants&quot;</span><span class="punctuation">:</span> <span class="string">&quot;workspace:*&quot;</span><span class="punctuation">,</span>	<span class="comment">//工作区内的常量库</span></span><br><span class="line">		<span class="attr">&quot;async-validator&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.2.5&quot;</span><span class="punctuation">,</span>		<span class="comment">//表单验证库</span></span><br><span class="line">		<span class="attr">&quot;lodash-es&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.17.21&quot;</span><span class="punctuation">,</span>			<span class="comment">//Lodash 的 ES 模块版本</span></span><br><span class="line">		<span class="attr">&quot;tyche&quot;</span><span class="punctuation">:</span> <span class="string">&quot;workspace:*&quot;</span><span class="punctuation">,</span></span><br><span class="line">		<span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.5.13&quot;</span>					<span class="comment">//Vue3核心库</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>开发依赖</strong></p>
<blockquote>
<ul>
<li><code>vue3-i18n</code>：Vue 国际化库</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">总结</span><br><span class="line">核心依赖：</span><br><span class="line">vue：所有 Vue 3 相关包的依赖。</span><br><span class="line">@fortawesome/fontawesome-svg-core：图标库。</span><br><span class="line">async-validator：表单验证。</span><br><span class="line">开发依赖：</span><br><span class="line">测试：vitest, @vue/test-utils。</span><br><span class="line">构建：vite, rollup。</span><br><span class="line">工具：typescript, prettier。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pnpm ls &lt;package-name&gt;  # 查看依赖树</span><br><span class="line">pnpm why &lt;package-name&gt; # 查看依赖原因</span><br></pre></td></tr></table></figure>

<h1 id="├─-pnpm-lock-yaml"><a href="#├─-pnpm-lock-yaml" class="headerlink" title="├─ pnpm-lock.yaml"></a>├─ <em><del>pnpm-lock.yaml</del></em></h1><blockquote>
<p>环境🔒</p>
</blockquote>
<h1 id="├─-pnpm-workspace-yaml"><a href="#├─-pnpm-workspace-yaml" class="headerlink" title="├─ pnpm-workspace.yaml"></a>├─ <em><del>pnpm-workspace.yaml</del></em></h1><blockquote>
<p>PNPM 工作区的配置文件，用于管理多个包之间的依赖关系</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">packages:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;packages/*&quot;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;libs/*&quot;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>所有位于 <code>packages</code> 目录下的子目录都被视为独立的包，并且是工作区的一部分</p>
<p>同样的，<code>libs</code> 目录下的子目录也被视为独立的包，被视为工作区的一部分</p>
</blockquote>
<blockquote>
<p>如果你有一个包在 <code>packages</code> 文件夹中依赖了另一个位于 <code>libs</code> 文件夹中的包，PNPM 不会从远程仓库下载该依赖，而是创建一个符号链接指向该本地包的位置。</p>
</blockquote>
<blockquote>
<p>当你在一个工作区内的任意一个包中安装依赖时，PNPM 会将这些依赖安装在工作区根目录下的 <code>node_modules</code> 文件夹内。工作区内所有的包可以共享相同的依赖版本，减少了重复安装和存储空间的浪费</p>
</blockquote>
<h1 id="├─-postcss-config-cjs"><a href="#├─-postcss-config-cjs" class="headerlink" title="├─ postcss.config.cjs"></a>├─ <em><del>postcss.config.cjs</del></em></h1><blockquote>
<p><em>PostCSS</em> 是一个使用 JavaScript 转换 CSS 的工具</p>
<p>该文件是 <em>PostCSS</em> 的配置文件</p>
<p>详情见文档 <a target="_blank" rel="noopener" href="https://www.postcss.com.cn/">PostCSS中文网</a>  或  <a target="_blank" rel="noopener" href="https://github.com/postcss/postcss#usage">Github&#x2F;postcss</a></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-env node */</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">	<span class="comment">// publicPath: process.env.NODE_ENV === &#x27;production&#x27; ? &#x27;/Tyche/&#x27; : &#x27;/&#x27;,</span></span><br><span class="line">	<span class="attr">plugins</span>: [<span class="comment">//一系列 PostCSS 插件</span></span><br><span class="line">		<span class="built_in">require</span>(<span class="string">&#x27;postcss-nested&#x27;</span>),<span class="comment">//支持嵌套</span></span><br><span class="line">		<span class="built_in">require</span>(<span class="string">&#x27;postcss-each-variables&#x27;</span>),<span class="comment">//循环功能</span></span><br><span class="line">		<span class="built_in">require</span>(<span class="string">&#x27;postcss-each&#x27;</span>)(&#123;</span><br><span class="line">			<span class="attr">plugins</span>: &#123;</span><br><span class="line">				<span class="attr">beforeEach</span>: [<span class="built_in">require</span>(<span class="string">&#x27;postcss-for&#x27;</span>), <span class="built_in">require</span>(<span class="string">&#x27;postcss-color-mix&#x27;</span>)],<span class="comment">//for：循环控制；color-mix：颜色混合</span></span><br><span class="line">			&#125;,</span><br><span class="line">		&#125;),</span><br><span class="line">	],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="├─-tsconfig-build-json"><a href="#├─-tsconfig-build-json" class="headerlink" title="├─ tsconfig.build.json"></a>├─ tsconfig.build.json</h1><blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="├─-tsconfig-json"><a href="#├─-tsconfig-json" class="headerlink" title="├─ tsconfig.json"></a>├─ <em><del>tsconfig.json</del></em></h1><blockquote>
<p>TypeScript 编译器的配置文件，定义如何编译项目中的 TypeScript 文件</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;extends&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@vue/tsconfig/tsconfig.dom.json&quot;</span><span class="punctuation">,</span><span class="comment">//使用 Vue 提供的基础 TypeScript 配置，并在其基础上进行扩展。</span></span><br><span class="line">    <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="comment">//包含一系列编译选项</span></span><br><span class="line">        <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ES2020&quot;</span><span class="punctuation">,</span><span class="comment">//编译后的 JavaScript 目标版本为 ES2020</span></span><br><span class="line">        <span class="attr">&quot;useDefineForClassFields&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ESNext&quot;</span><span class="punctuation">,</span><span class="comment">//使用 &quot;ESNext&quot; 模块系统为了支持最新的 ECMAScript 模块标准</span></span><br><span class="line">        <span class="attr">&quot;lib&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ES2020&quot;</span><span class="punctuation">,</span> <span class="string">&quot;DOM&quot;</span><span class="punctuation">,</span> <span class="string">&quot;DOM.Iterable&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="comment">//列出了编译过程中需要包含的库文件</span></span><br><span class="line">        <span class="attr">&quot;skipLibCheck&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span><span class="comment">//忽略所有声明文件（.d.ts）的类型检查，加快编译速度</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Bundler mode */</span></span><br><span class="line">        <span class="attr">&quot;moduleResolution&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bundler&quot;</span><span class="punctuation">,</span><span class="comment">//适应现代构建工具如 Vite 的模块解析机制</span></span><br><span class="line">        <span class="attr">&quot;allowImportingTsExtensions&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;resolveJsonModule&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;isolatedModules&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;noEmit&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;jsx&quot;</span><span class="punctuation">:</span> <span class="string">&quot;preserve&quot;</span><span class="punctuation">,</span><span class="comment">//JSX 将被保留以便后续处理</span></span><br><span class="line">        <span class="attr">&quot;jsxImportSource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue&quot;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Linting */</span></span><br><span class="line">        <span class="attr">&quot;strict&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span><span class="comment">//严格模式</span></span><br><span class="line">        <span class="attr">&quot;noUnusedLocals&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span><span class="comment">//禁止未使用的局部变量</span></span><br><span class="line">        <span class="attr">&quot;noUnusedParameters&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span><span class="comment">//禁止未使用的函数参数</span></span><br><span class="line">        <span class="attr">&quot;noFallthroughCasesInSwitch&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="comment">//应被包含在编译过程中的文件</span></span><br><span class="line">        <span class="string">&quot;env.d.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;packages/**/*.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;packages/**/*.tsx&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;packages/**/*.vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;packages/play/src/stories/*.stories.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;vitest.config.ts&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;packages/components/vitest.config.ts&quot;</span><span class="punctuation">,</span><span class="string">&quot;packages/components/index.test.ts&quot;</span><span class="punctuation">]</span><span class="comment">//应被排除在编译过程中的文件</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="├─-tsconfig-node-json"><a href="#├─-tsconfig-node-json" class="headerlink" title="├─ tsconfig.node.json"></a>├─ <em><del>tsconfig.node.json</del></em></h1><blockquote>
<p>专门为 Node.js 环境下的 TypeScript 配置文件</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	<span class="attr">&quot;extends&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@tsconfig/node18/tsconfig.json&quot;</span><span class="punctuation">,</span><span class="comment">//基于 Node.js 18 版本的标准配置</span></span><br><span class="line">	<span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;packages/**/**.config.ts&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="comment">//所有以 .config.ts 结尾的文件都应该被包含进来</span></span><br><span class="line">	<span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">		<span class="attr">&quot;composite&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span><span class="comment">//该项目是一个复合项目，可以与其他项目共享编译输出</span></span><br><span class="line">		<span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ESNext&quot;</span><span class="punctuation">,</span><span class="comment">//使用 &quot;ESNext&quot; 模块系统为了支持最新的 ECMAScript 模块标准</span></span><br><span class="line">		<span class="attr">&quot;moduleResolution&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Bundler&quot;</span><span class="punctuation">,</span><span class="comment">//适应现代构建工具如 Vite 的模块解析机制</span></span><br><span class="line">		<span class="attr">&quot;types&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;node&quot;</span><span class="punctuation">]</span><span class="comment">//指定要包含的类型声明，确保 Node.js 的全局变量和模块都能被正确识别</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="├─-vitest-config-ts"><a href="#├─-vitest-config-ts" class="headerlink" title="├─ vitest.config.ts"></a>├─ <em><del>vitest.config.ts</del></em></h1><blockquote>
<p>Vitest 测试框架的配置文件</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// &lt;reference types=&quot;vitest&quot; /&gt; //引用类型声明:告诉TypeScript编译器包含Vitest的类型定义</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span>; <span class="comment">//定义配置对象函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; resolve &#125; <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&quot;@vitejs/plugin-vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> vueJsx <span class="keyword">from</span> <span class="string">&quot;@vitejs/plugin-vue-jsx&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">    <span class="attr">plugins</span>: [<span class="title function_">vue</span>(), <span class="title function_">vueJsx</span>()],<span class="comment">//被应用到 Vite 构建过程中的插件[对 Vue 单文件组件的支持 &amp; JSX 语法的支持]</span></span><br><span class="line">    <span class="attr">define</span>: &#123; <span class="comment">//定义全局常量(PROD, DEV, TEST)</span></span><br><span class="line">        <span class="attr">PROD</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="literal">false</span>),</span><br><span class="line">        <span class="attr">DEV</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="literal">false</span>),</span><br><span class="line">        <span class="attr">TEST</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="literal">true</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">test</span>: &#123;</span><br><span class="line">        <span class="attr">globals</span>: <span class="literal">true</span>, <span class="comment">//将测试框架暴露为全局变量,可以直接使用 describe, it, expect 等而无需每次都导入</span></span><br><span class="line">        <span class="attr">environment</span>: <span class="string">&quot;jsdom&quot;</span>, <span class="comment">//测试将在模拟的浏览器环境中运行，对标需要 DOM 操作的测试</span></span><br><span class="line">        <span class="attr">setupFiles</span>:[<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./vitest.setup.ts&#x27;</span>)] <span class="comment">//指定vitest.setup.ts在所有测试之前自动运行，用于全局的初始化工作</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h1 id="└─-vitest-setup-ts"><a href="#└─-vitest-setup-ts" class="headerlink" title="└─ vitest.setup.ts"></a>└─ <em><del>vitest.setup.ts</del></em></h1><blockquote>
<p>通常用于在运行测试之前执行一些初始化逻辑</p>
<p>在这个项目中，初始化 FontAwesome 图标库，整个测试过程中使用 Solid 风格的图标</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; library &#125; <span class="keyword">from</span> <span class="string">&quot;@fortawesome/fontawesome-svg-core&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; fas &#125; <span class="keyword">from</span> <span class="string">&quot;@fortawesome/free-solid-svg-icons&quot;</span>;<span class="comment">//所有的 Solid 风格图标集</span></span><br><span class="line"></span><br><span class="line">library.<span class="title function_">add</span>(fas);<span class="comment">//将 Solid 图标添加到了 FontAwesome 的库中</span></span><br><span class="line"><span class="comment">//任何需要使用 Solid 图标的组件或测试都可以直接访问这些图标，而不需要再次单独引入它们</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>避免了由于图标未加载而导致的测试失败</p>
</blockquote>
<p><em>扩展</em></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; library &#125; <span class="keyword">from</span> <span class="string">&#x27;@fortawesome/fontawesome-svg-core&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; fas &#125; <span class="keyword">from</span> <span class="string">&#x27;@fortawesome/free-solid-svg-icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; far &#125; <span class="keyword">from</span> <span class="string">&#x27;@fortawesome/free-regular-svg-icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; fab &#125; <span class="keyword">from</span> <span class="string">&#x27;@fortawesome/free-brands-svg-icons&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">FontAwesomeIcon</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@fortawesome/vue-fontawesome&#x27;</span></span><br><span class="line">library.<span class="title function_">add</span>(fas,far,fab)</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">component</span>(<span class="string">&#x27;font-awesome-icon&#x27;</span>, <span class="title class_">FontAwesomeIcon</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//大小</span></span><br><span class="line">&lt;font-awesome-icon icon=<span class="string">&quot;fa-solid fa-house&quot;</span> size=<span class="string">&quot;xs&quot;</span>/&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font-awesome-icon</span> <span class="attr">icon</span>=<span class="string">&quot;fa-solid fa-house&quot;</span> <span class="attr">size</span>=<span class="string">&quot;lg&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font-awesome-icon</span> <span class="attr">icon</span>=<span class="string">&quot;fa-solid fa-house&quot;</span> <span class="attr">size</span>=<span class="string">&quot;2x&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font-awesome-icon</span> <span class="attr">icon</span>=<span class="string">&quot;fa-solid fa-house&quot;</span> <span class="attr">size</span>=<span class="string">&quot;4x&quot;</span>/&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//旋转</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font-awesome-icon</span> <span class="attr">icon</span>=<span class="string">&quot;fa-solid fa-house&quot;</span> <span class="attr">rotation</span>=<span class="string">&quot;0&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font-awesome-icon</span> <span class="attr">icon</span>=<span class="string">&quot;fa-solid fa-house&quot;</span> <span class="attr">rotation</span>=<span class="string">&quot;90&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font-awesome-icon</span> <span class="attr">icon</span>=<span class="string">&quot;fa-solid fa-house&quot;</span> <span class="attr">rotation</span>=<span class="string">&quot;180&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font-awesome-icon</span> <span class="attr">icon</span>=<span class="string">&quot;fa-solid fa-house&quot;</span> <span class="attr">rotation</span>=<span class="string">&quot;270&quot;</span>/&gt;</span></span></span><br></pre></td></tr></table></figure>

<h1 id="各工作区依赖环境详情"><a href="#各工作区依赖环境详情" class="headerlink" title="各工作区依赖环境详情"></a>各工作区依赖环境详情</h1><h2 id="根目录"><a href="#根目录" class="headerlink" title="根目录"></a>根目录</h2><ul>
<li><strong>生产环境依赖</strong><ul>
<li>@tyche&#x2F;components: workspace:*</li>
<li>@tyche&#x2F;hooks: workspace:*</li>
<li>@tyche&#x2F;theme: workspace:*</li>
<li>@tyche&#x2F;utils: workspace:*</li>
<li>@tyche&#x2F;locale: workspace:*</li>
<li>@tyche&#x2F;constants: workspace:*</li>
<li>@tyche&#x2F;vite-plugins: workspace:*</li>
<li>@fortawesome&#x2F;fontawesome-svg-core: ^6.5.2</li>
<li>@fortawesome&#x2F;free-solid-svg-icons: ^6.5.2</li>
<li>@fortawesome&#x2F;vue-fontawesome: ^3.0.8</li>
<li>@popperjs&#x2F;core: ^2.11.8</li>
<li>@vitepress-preview&#x2F;component: workspace:*</li>
<li>async-validator: ^4.2.5</li>
<li>eric-ui: workspace:*</li>
<li>lodash-es: ^4.17.21</li>
<li>vue: ^3.4.27</li>
</ul>
</li>
<li><strong>开发环境依赖</strong><ul>
<li>@types&#x2F;lodash-es: ^4.17.12</li>
<li>@types&#x2F;node: ^20.12.12</li>
<li>@types&#x2F;shelljs: ^0.8.15</li>
<li>@vitejs&#x2F;plugin-vue: ^5.0.4</li>
<li>@vitejs&#x2F;plugin-vue-jsx: ^3.1.0</li>
<li>@vitest&#x2F;coverage-v8: ^1.4.0</li>
<li>@vue&#x2F;test-utils: ^2.4.5</li>
<li>@vue&#x2F;tsconfig: ^0.5.1</li>
<li>cross-env: ^7.0.3</li>
<li>cssnano: ^7.0.1</li>
<li>jsdom: ^24.0.0</li>
<li>npm-run-all: ^4.1.5</li>
<li>postcss-color-mix: ^1.1.0</li>
<li>postcss-each: ^1.1.0</li>
<li>postcss-each-variables: ^0.3.0</li>
<li>postcss-for: ^2.1.1</li>
<li>postcss-nested: ^6.0.1</li>
<li>prettier: ^3.2.5</li>
<li>rollup: ^4.18.0</li>
<li>shelljs: ^0.8.5</li>
<li>typescript: ^5.4.5</li>
<li>vite: ^5.2.11</li>
<li>vite-plugin-dts: ^3.9.1</li>
<li>vitest: ^1.6.0</li>
<li>vue-tsc: ^1.8.27</li>
<li>vue3-i18n: ^1.1.5</li>
</ul>
</li>
</ul>
<h3 id="packages-utils"><a href="#packages-utils" class="headerlink" title="&#x2F;packages&#x2F;utils"></a>&#x2F;packages&#x2F;utils</h3><ul>
<li><strong>生产环境依赖</strong>: 无明确声明</li>
<li>开发环境依赖<ul>
<li>无（仅包含一个测试脚本）</li>
</ul>
</li>
</ul>
<h3 id="packages-components"><a href="#packages-components" class="headerlink" title="&#x2F;packages&#x2F;components"></a>&#x2F;packages&#x2F;components</h3><ul>
<li>生产环境依赖<ul>
<li>axios: ^1.6.8 (在 devDependencies 中, 可能是误置)</li>
</ul>
</li>
<li>开发环境依赖<ul>
<li>无明确声明（除了 axios 外）</li>
</ul>
</li>
</ul>
<h3 id="packages-constants"><a href="#packages-constants" class="headerlink" title="&#x2F;packages&#x2F;constants"></a>&#x2F;packages&#x2F;constants</h3><ul>
<li><strong>生产环境依赖</strong>: 无</li>
<li><strong>开发环境依赖</strong>: 无</li>
</ul>
<h3 id="packages-core"><a href="#packages-core" class="headerlink" title="&#x2F;packages&#x2F;core"></a>&#x2F;packages&#x2F;core</h3><ul>
<li>生产环境依赖<ul>
<li>@fortawesome&#x2F;fontawesome-svg-core: ^6.5.1</li>
<li>@fortawesome&#x2F;free-solid-svg-icons: ^6.5.1</li>
<li>@fortawesome&#x2F;vue-fontawesome: ^3.0.6</li>
<li>@popperjs&#x2F;core: ^2.11.8</li>
<li>async-validator: ^4.2.5</li>
</ul>
</li>
<li>开发环境依赖<ul>
<li>@rollup&#x2F;plugin-terser: ^0.4.4</li>
<li>rollup-plugin-visualizer: ^5.12.0</li>
<li>terser: ^5.31.0</li>
<li>vite-plugin-compression: ^0.5.1</li>
</ul>
</li>
</ul>
<h3 id="packages-docs"><a href="#packages-docs" class="headerlink" title="&#x2F;packages&#x2F;docs"></a>&#x2F;packages&#x2F;docs</h3><ul>
<li><strong>生产环境依赖</strong>: 无</li>
<li>开发环境依赖<ul>
<li>@vitepress-demo-preview&#x2F;component: ^2.3.2</li>
<li>@vitepress-demo-preview&#x2F;plugin: ^1.2.3</li>
<li>vitepress: 1.1.4</li>
</ul>
</li>
</ul>
<h3 id="packages-hooks"><a href="#packages-hooks" class="headerlink" title="&#x2F;packages&#x2F;hooks"></a>&#x2F;packages&#x2F;hooks</h3><ul>
<li><strong>生产环境依赖</strong>: 无</li>
<li>开发环境依赖<ul>
<li>无（但有 peerDependencies）</li>
<li>peerDependencies:<ul>
<li>vue: ^3.4.27</li>
<li>lodash-es: ^4.17.21</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="packages-locale"><a href="#packages-locale" class="headerlink" title="&#x2F;packages&#x2F;locale"></a>&#x2F;packages&#x2F;locale</h3><ul>
<li><strong>生产环境依赖</strong>: 无</li>
<li><strong>开发环境依赖</strong>: 无</li>
</ul>
<h3 id="packages-play"><a href="#packages-play" class="headerlink" title="&#x2F;packages&#x2F;play"></a>&#x2F;packages&#x2F;play</h3><ul>
<li><strong>生产环境依赖</strong>: 无</li>
<li><strong>开发环境依赖</strong>: 无</li>
</ul>
<h3 id="packages-theme"><a href="#packages-theme" class="headerlink" title="&#x2F;packages&#x2F;theme"></a>&#x2F;packages&#x2F;theme</h3><ul>
<li><strong>生产环境依赖</strong>: 无</li>
<li>开发环境依赖<ul>
<li>@chromatic-com&#x2F;storybook: 1.3.3</li>
<li>@storybook&#x2F;addon-essentials: ^8.0.10</li>
<li>@storybook&#x2F;addon-interactions: ^8.0.10</li>
<li>@storybook&#x2F;addon-links: ^8.0.10</li>
<li>@storybook&#x2F;blocks: ^8.0.10</li>
<li>@storybook&#x2F;test: ^8.0.10</li>
<li>@storybook&#x2F;vue3: ^8.0.10</li>
<li>@storybook&#x2F;vue3-vite: ^8.0.10</li>
<li>@vitejs&#x2F;plugin-vue: ^5.0.4</li>
<li>chromatic: ^11.3.1</li>
<li>storybook: ^8.0.10</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">请注意，对于 `/packages/components`，其中 `axios` 被放置在 `devDependencies` 中，这可能是错误配置，除非它确实只用于开发环境。此外，某些包如 `/packages/hooks` 使用了 `peerDependencies` 来定义其对其他包的依赖关系，这些依赖需要由使用者提供。</span><br></pre></td></tr></table></figure>

















</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="/img/512.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="/img/512.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">Breezli</div><div class="post-copyright__author_desc">“松间听风，忽见灵狸”</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/04/03/%E7%BB%84%E4%BB%B6%E5%BA%93/%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE%E5%85%A8%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%84/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/04/03/%E7%BB%84%E4%BB%B6%E5%BA%93/%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE%E5%85%A8%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%84/')">组件库全文件解构</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/04/03/%E7%BB%84%E4%BB%B6%E5%BA%93/%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE%E5%85%A8%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%84/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=undefined&amp;url=http://example.com/2025/04/03/%E7%BB%84%E4%BB%B6%E5%BA%93/%E7%BB%84%E4%BB%B6%E5%BA%93%E9%A1%B9%E7%9B%AE%E5%85%A8%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%84/&amp;pic=undefined" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">松风狸 | Breezli</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"></div></div></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2025/03/05/67c7e99e3513a.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/04/03/%E7%BB%84%E4%BB%B6%E5%BA%93/Tooltip%20%E6%96%87%E5%AD%97%E6%8F%90%E7%A4%BA/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif?_r_=167ae4e7-3967-04e0-c7ce-021d5a92bf18" onerror="onerror=null;src='https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Tooltip 文字组件</div></div></a></div><div class="next-post pull-right"><a href="/2025/04/03/%E6%8A%80%E6%9C%AF%E6%8E%A2%E7%B4%A2/%E5%8F%91%E5%B8%83%E8%87%AA%E5%B7%B1%E7%9A%84npm/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://bu.dusays.com/2025/04/03/67edd26e78e15.png" onerror="onerror=null;src='https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">npm发布</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="/img/512.png" onerror="this.onerror=null;this.src='https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://emotion.acs.pw/emotion/QQ/129.gif" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">错位的人格，错位的才情；</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">错位的时代，错位的人生。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">在错误的路口抢夺正确的结果，</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">用虚假的手段寻回真实的自己。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">在诗意，自由的“美丽新世界”。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Breezli</h1><div class="author-info__desc">“松间听风，忽见灵狸”</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Breezli" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/3546391152429457" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2025/08/09/68973be4ebc88.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2025/08/09/68973be4eca94.png) center center / 100% no-repeat"></div></div></div></div><div class="card-widget card-countdown"><div class="item-headline"><i></i><span></span></div><div class="item-content"><div class="cd-count-left">
  <span class="cd-text">距离</span>
  <span class="cd-name" id="eventName"></span>
  <span class="cd-time" id="daysUntil"></span>
  <span class="cd-date" id="eventDate"></span>
</div>
<div id="countRight" class="cd-count-right"></div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">项目结构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E8%A7%A3%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">项目解构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-nvmrc"><span class="toc-number">3.</span> <span class="toc-text">├─ .nvmrc</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-env-d-ts"><span class="toc-number">4.</span> <span class="toc-text">├─ env.d.ts</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-libs"><span class="toc-number">5.</span> <span class="toc-text">├─ libs</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%9C%E2%94%80-vite-plugins"><span class="toc-number">5.1.</span> <span class="toc-text">├─ vite-plugins</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-hooksPlugin-ts"><span class="toc-number">5.1.1.</span> <span class="toc-text">├─ hooksPlugin.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts"><span class="toc-number">5.1.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-package-json"><span class="toc-number">5.1.3.</span> <span class="toc-text">├─ package.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%94%E2%94%80-vite-config-ts"><span class="toc-number">5.1.4.</span> <span class="toc-text">└─ vite.config.ts</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%94%E2%94%80-vitepress-preview-component"><span class="toc-number">5.2.</span> <span class="toc-text">└─ vitepress-preview-component</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-container"><span class="toc-number">5.2.1.</span> <span class="toc-text">├─ container</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-packages"><span class="toc-number">6.</span> <span class="toc-text">├─ packages</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%9C%E2%94%80-components"><span class="toc-number">6.1.</span> <span class="toc-text">├─ components</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Alert"><span class="toc-number">6.1.1.</span> <span class="toc-text">├─ Alert</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93"><span class="toc-number">6.1.1.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Alert-test-tsx"><span class="toc-number">6.1.1.2.</span> <span class="toc-text">├─ Alert.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Alert-vue"><span class="toc-number">6.1.1.3.</span> <span class="toc-text">├─ Alert.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-1"><span class="toc-number">6.1.1.4.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css"><span class="toc-number">6.1.1.5.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts"><span class="toc-number">6.1.1.6.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Button"><span class="toc-number">6.1.2.</span> <span class="toc-text">├─ Button</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-1"><span class="toc-number">6.1.2.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Button-test-tsx"><span class="toc-number">6.1.2.2.</span> <span class="toc-text">├─ Button.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Button-vue"><span class="toc-number">6.1.2.3.</span> <span class="toc-text">├─ Button.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-ButtonGroup-vue"><span class="toc-number">6.1.2.4.</span> <span class="toc-text">├─ ButtonGroup.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-constants-ts"><span class="toc-number">6.1.2.5.</span> <span class="toc-text">├─ constants.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-2"><span class="toc-number">6.1.2.6.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-1"><span class="toc-number">6.1.2.7.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-1"><span class="toc-number">6.1.2.8.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Collapse"><span class="toc-number">6.1.3.</span> <span class="toc-text">├─ Collapse</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-2"><span class="toc-number">6.1.3.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Collapse-test-tsx"><span class="toc-number">6.1.3.2.</span> <span class="toc-text">├─ Collapse.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Collapse-vue"><span class="toc-number">6.1.3.3.</span> <span class="toc-text">├─ Collapse.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-CollapseItem-vue"><span class="toc-number">6.1.3.4.</span> <span class="toc-text">├─ CollapseItem.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-constants-ts-1"><span class="toc-number">6.1.3.5.</span> <span class="toc-text">├─ constants.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-3"><span class="toc-number">6.1.3.6.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-2"><span class="toc-number">6.1.3.7.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-transitionEvents-ts"><span class="toc-number">6.1.3.8.</span> <span class="toc-text">├─ transitionEvents.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-2"><span class="toc-number">6.1.3.9.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-ConfigProvider"><span class="toc-number">6.1.4.</span> <span class="toc-text">├─ ConfigProvider</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-3"><span class="toc-number">6.1.4.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-ConfigProvider-vue"><span class="toc-number">6.1.4.2.</span> <span class="toc-text">├─ ConfigProvider.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-constants-ts-2"><span class="toc-number">6.1.4.3.</span> <span class="toc-text">├─ constants.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-hooks-ts"><span class="toc-number">6.1.4.4.</span> <span class="toc-text">├─ hooks.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-4"><span class="toc-number">6.1.4.5.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-3"><span class="toc-number">6.1.4.6.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Dropdown"><span class="toc-number">6.1.5.</span> <span class="toc-text">├─ Dropdown</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-4"><span class="toc-number">6.1.5.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-constants-ts-3"><span class="toc-number">6.1.5.2.</span> <span class="toc-text">├─ constants.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Dropdown-test-tsx"><span class="toc-number">6.1.5.3.</span> <span class="toc-text">├─ Dropdown.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Dropdown-vue"><span class="toc-number">6.1.5.4.</span> <span class="toc-text">├─ Dropdown.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-DropdownItem-vue"><span class="toc-number">6.1.5.5.</span> <span class="toc-text">├─ DropdownItem.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-5"><span class="toc-number">6.1.5.6.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-3"><span class="toc-number">6.1.5.7.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-4"><span class="toc-number">6.1.5.8.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Form"><span class="toc-number">6.1.6.</span> <span class="toc-text">├─ Form</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-5"><span class="toc-number">6.1.6.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-constants-ts-4"><span class="toc-number">6.1.6.2.</span> <span class="toc-text">├─ constants.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Form-vue"><span class="toc-number">6.1.6.3.</span> <span class="toc-text">├─ Form.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-FormItem-vue"><span class="toc-number">6.1.6.4.</span> <span class="toc-text">├─ FormItem.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-hooks-ts-1"><span class="toc-number">6.1.6.5.</span> <span class="toc-text">├─ hooks.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-6"><span class="toc-number">6.1.6.6.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-4"><span class="toc-number">6.1.6.7.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-5"><span class="toc-number">6.1.6.8.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Icon"><span class="toc-number">6.1.7.</span> <span class="toc-text">├─ Icon</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Icon-vue"><span class="toc-number">6.1.7.1.</span> <span class="toc-text">├─ Icon.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-7"><span class="toc-number">6.1.7.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-5"><span class="toc-number">6.1.7.3.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-6"><span class="toc-number">6.1.7.4.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Input"><span class="toc-number">6.1.8.</span> <span class="toc-text">├─ Input</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-6"><span class="toc-number">6.1.8.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-8"><span class="toc-number">6.1.8.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Input-test-tsx"><span class="toc-number">6.1.8.3.</span> <span class="toc-text">├─ Input.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Input-vue"><span class="toc-number">6.1.8.4.</span> <span class="toc-text">├─ Input.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-6"><span class="toc-number">6.1.8.5.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-7"><span class="toc-number">6.1.8.6.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Loading"><span class="toc-number">6.1.9.</span> <span class="toc-text">├─ Loading</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-7"><span class="toc-number">6.1.9.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-directive-ts"><span class="toc-number">6.1.9.2.</span> <span class="toc-text">├─ directive.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-9"><span class="toc-number">6.1.9.3.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Loading-test-tsx"><span class="toc-number">6.1.9.4.</span> <span class="toc-text">├─ Loading.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Loading-vue"><span class="toc-number">6.1.9.5.</span> <span class="toc-text">├─ Loading.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-service-ts"><span class="toc-number">6.1.9.6.</span> <span class="toc-text">├─ service.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-7"><span class="toc-number">6.1.9.7.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-8"><span class="toc-number">6.1.9.8.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Message"><span class="toc-number">6.1.10.</span> <span class="toc-text">├─ Message</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-8"><span class="toc-number">6.1.10.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-10"><span class="toc-number">6.1.10.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Message-test-tsx"><span class="toc-number">6.1.10.3.</span> <span class="toc-text">├─ Message.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Message-vue"><span class="toc-number">6.1.10.4.</span> <span class="toc-text">├─ Message.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-methods-ts"><span class="toc-number">6.1.10.5.</span> <span class="toc-text">├─ methods.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-8"><span class="toc-number">6.1.10.6.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-9"><span class="toc-number">6.1.10.7.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-MessageBox"><span class="toc-number">6.1.11.</span> <span class="toc-text">├─ MessageBox</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-9"><span class="toc-number">6.1.11.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-11"><span class="toc-number">6.1.11.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-MessageBox-test-tsx"><span class="toc-number">6.1.11.3.</span> <span class="toc-text">├─ MessageBox.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-MessageBox-vue"><span class="toc-number">6.1.11.4.</span> <span class="toc-text">├─ MessageBox.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-methods-ts-1"><span class="toc-number">6.1.11.5.</span> <span class="toc-text">├─ methods.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-9"><span class="toc-number">6.1.11.6.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-10"><span class="toc-number">6.1.11.7.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Notification"><span class="toc-number">6.1.12.</span> <span class="toc-text">├─ Notification</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-10"><span class="toc-number">6.1.12.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-12"><span class="toc-number">6.1.12.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-methods-ts-2"><span class="toc-number">6.1.12.3.</span> <span class="toc-text">├─ methods.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Notification-test-tsx"><span class="toc-number">6.1.12.4.</span> <span class="toc-text">├─ Notification.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Notification-vue"><span class="toc-number">6.1.12.5.</span> <span class="toc-text">├─ Notification.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-10"><span class="toc-number">6.1.12.6.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-11"><span class="toc-number">6.1.12.7.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Overlay"><span class="toc-number">6.1.13.</span> <span class="toc-text">├─ Overlay</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-11"><span class="toc-number">6.1.13.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Overlay-vue"><span class="toc-number">6.1.13.2.</span> <span class="toc-text">├─ Overlay.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-12"><span class="toc-number">6.1.13.3.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Popconfirm"><span class="toc-number">6.1.14.</span> <span class="toc-text">├─ Popconfirm</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-12"><span class="toc-number">6.1.14.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-13"><span class="toc-number">6.1.14.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Popconfirm-test-tsx"><span class="toc-number">6.1.14.3.</span> <span class="toc-text">├─ Popconfirm.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Popconfirm-vue"><span class="toc-number">6.1.14.4.</span> <span class="toc-text">├─ Popconfirm.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-11"><span class="toc-number">6.1.14.5.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-13"><span class="toc-number">6.1.14.6.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Select"><span class="toc-number">6.1.15.</span> <span class="toc-text">├─ Select</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-13"><span class="toc-number">6.1.15.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-constants-ts-5"><span class="toc-number">6.1.15.2.</span> <span class="toc-text">├─ constants.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-14"><span class="toc-number">6.1.15.3.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Option-vue"><span class="toc-number">6.1.15.4.</span> <span class="toc-text">├─ Option.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Select-vue"><span class="toc-number">6.1.15.5.</span> <span class="toc-text">├─ Select.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-12"><span class="toc-number">6.1.15.6.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-types-ts"><span class="toc-number">6.1.15.7.</span> <span class="toc-text">├─ types.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-useKeyMap-ts"><span class="toc-number">6.1.15.8.</span> <span class="toc-text">└─ useKeyMap.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Switch"><span class="toc-number">6.1.16.</span> <span class="toc-text">├─ Switch</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-14"><span class="toc-number">6.1.16.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-15"><span class="toc-number">6.1.16.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-13"><span class="toc-number">6.1.16.3.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Switch-test-tsx"><span class="toc-number">6.1.16.4.</span> <span class="toc-text">├─ Switch.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Switch-vue"><span class="toc-number">6.1.16.5.</span> <span class="toc-text">├─ Switch.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-types-ts-14"><span class="toc-number">6.1.16.6.</span> <span class="toc-text">└─ types.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Tooltip"><span class="toc-number">6.1.17.</span> <span class="toc-text">├─ Tooltip</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-15"><span class="toc-number">6.1.17.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-16"><span class="toc-number">6.1.17.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-css-14"><span class="toc-number">6.1.17.3.</span> <span class="toc-text">├─ style.css</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Tooltip-test-tsx"><span class="toc-number">6.1.17.4.</span> <span class="toc-text">├─ Tooltip.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Tooltip-vue"><span class="toc-number">6.1.17.5.</span> <span class="toc-text">├─ Tooltip.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-types-ts-1"><span class="toc-number">6.1.17.6.</span> <span class="toc-text">├─ types.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-useEventsToTiggerNode-ts"><span class="toc-number">6.1.17.7.</span> <span class="toc-text">└─ useEventsToTiggerNode.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Upload"><span class="toc-number">6.1.18.</span> <span class="toc-text">├─ Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%80%93API%E2%80%93-16"><span class="toc-number">6.1.18.1.</span> <span class="toc-text">–API–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-17"><span class="toc-number">6.1.18.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-types-ts-2"><span class="toc-number">6.1.18.3.</span> <span class="toc-text">├─ types.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Upload-vue"><span class="toc-number">6.1.18.4.</span> <span class="toc-text">├─ Upload.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-UploadList-vue"><span class="toc-number">6.1.18.5.</span> <span class="toc-text">└─ UploadList.vue</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-test-ts"><span class="toc-number">6.1.19.</span> <span class="toc-text">├─ index.test.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-18"><span class="toc-number">6.1.20.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%94%E2%94%80-package-json"><span class="toc-number">6.1.21.</span> <span class="toc-text">└─ package.json</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%9C%E2%94%80-constants"><span class="toc-number">6.2.</span> <span class="toc-text">├─ constants</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-19"><span class="toc-number">6.2.1.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-key-ts"><span class="toc-number">6.2.2.</span> <span class="toc-text">├─ key.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%94%E2%94%80-package-json-1"><span class="toc-number">6.2.3.</span> <span class="toc-text">└─ package.json</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%9C%E2%94%80-core"><span class="toc-number">6.3.</span> <span class="toc-text">├─ core</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-build"><span class="toc-number">6.3.1.</span> <span class="toc-text">├─ build</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-vite-es-config-ts"><span class="toc-number">6.3.1.1.</span> <span class="toc-text">├─ vite.es.config.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-vite-umd-config-ts"><span class="toc-number">6.3.1.2.</span> <span class="toc-text">└─ vite.umd.config.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-componens-ts"><span class="toc-number">6.3.2.</span> <span class="toc-text">├─ componens.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-20"><span class="toc-number">6.3.3.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-makeInstaller-ts"><span class="toc-number">6.3.4.</span> <span class="toc-text">├─ makeInstaller.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-package-json-1"><span class="toc-number">6.3.5.</span> <span class="toc-text">├─ package.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%94%E2%94%80-pringLogo-ts"><span class="toc-number">6.3.6.</span> <span class="toc-text">└─ pringLogo.ts</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%9C%E2%94%80-docs"><span class="toc-number">6.4.</span> <span class="toc-text">├─ docs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-vitepress"><span class="toc-number">6.4.1.</span> <span class="toc-text">├─ .vitepress</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-config-ts"><span class="toc-number">6.4.1.1.</span> <span class="toc-text">├─ config.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-theme"><span class="toc-number">6.4.1.2.</span> <span class="toc-text">└─ theme</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%94%94%E2%94%80-index-ts"><span class="toc-number">6.4.1.2.1.</span> <span class="toc-text">└─ index.ts</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-components-1"><span class="toc-number">6.4.2.</span> <span class="toc-text">├─ components</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-alert-md"><span class="toc-number">6.4.2.1.</span> <span class="toc-text">├─ alert.md</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-button-md"><span class="toc-number">6.4.2.2.</span> <span class="toc-text">├─ button.md</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-collapse-md"><span class="toc-number">6.4.2.3.</span> <span class="toc-text">├─ collapse.md</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-dropdown-md"><span class="toc-number">6.4.2.4.</span> <span class="toc-text">├─ dropdown.md</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-form-md"><span class="toc-number">6.4.2.5.</span> <span class="toc-text">├─ form.md</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-loading-md"><span class="toc-number">6.4.2.6.</span> <span class="toc-text">├─ loading.md</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-message-md"><span class="toc-number">6.4.2.7.</span> <span class="toc-text">├─ message.md</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-messagebox-md"><span class="toc-number">6.4.2.8.</span> <span class="toc-text">├─ messagebox.md</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-notification-md"><span class="toc-number">6.4.2.9.</span> <span class="toc-text">├─ notification.md</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-popconfirm-md"><span class="toc-number">6.4.2.10.</span> <span class="toc-text">├─ popconfirm.md</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-tooltip-md"><span class="toc-number">6.4.2.11.</span> <span class="toc-text">└─ tooltip.md</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-demo"><span class="toc-number">6.4.3.</span> <span class="toc-text">├─ demo</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-alert"><span class="toc-number">6.4.3.1.</span> <span class="toc-text">├─ alert</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-button"><span class="toc-number">6.4.3.2.</span> <span class="toc-text">├─ button</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-collapse"><span class="toc-number">6.4.3.3.</span> <span class="toc-text">├─ collapse</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%82-%E2%94%82-%E2%94%82-%E2%94%9C%E2%94%80-dropdown"><span class="toc-number">6.4.3.4.</span> <span class="toc-text">│  │  │  ├─ dropdown</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-form"><span class="toc-number">6.4.3.5.</span> <span class="toc-text">├─ form</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-loading"><span class="toc-number">6.4.3.6.</span> <span class="toc-text">├─ loading</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-message"><span class="toc-number">6.4.3.7.</span> <span class="toc-text">├─ message</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-messagebox"><span class="toc-number">6.4.3.8.</span> <span class="toc-text">├─ messagebox</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-notification"><span class="toc-number">6.4.3.9.</span> <span class="toc-text">├─ notification</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-popconfirm"><span class="toc-number">6.4.3.10.</span> <span class="toc-text">├─ popconfirm</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-tooltip"><span class="toc-number">6.4.3.11.</span> <span class="toc-text">└─ tooltip</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-get-started-md"><span class="toc-number">6.4.4.</span> <span class="toc-text">├─ get-started.md</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-md"><span class="toc-number">6.4.5.</span> <span class="toc-text">├─ index.md</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%94%E2%94%80-package-json-2"><span class="toc-number">6.4.6.</span> <span class="toc-text">└─ package.json</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%9C%E2%94%80-hooks"><span class="toc-number">6.5.</span> <span class="toc-text">├─ hooks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-21"><span class="toc-number">6.5.1.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-package-json-2"><span class="toc-number">6.5.2.</span> <span class="toc-text">├─ package.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-useClickOutside-ts"><span class="toc-number">6.5.3.</span> <span class="toc-text">├─ useClickOutside.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-useDisabledStyle-ts"><span class="toc-number">6.5.4.</span> <span class="toc-text">├─ useDisabledStyle.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-useEventListener-ts"><span class="toc-number">6.5.5.</span> <span class="toc-text">├─ useEventListener.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-useFocusController-ts"><span class="toc-number">6.5.6.</span> <span class="toc-text">├─ useFocusController.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-useId-ts"><span class="toc-number">6.5.7.</span> <span class="toc-text">├─ useId.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-useLocale-ts"><span class="toc-number">6.5.8.</span> <span class="toc-text">├─ useLocale.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-useOffset-ts"><span class="toc-number">6.5.9.</span> <span class="toc-text">├─ useOffset.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-useProp-ts"><span class="toc-number">6.5.10.</span> <span class="toc-text">├─ useProp.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-useZIndex-ts"><span class="toc-number">6.5.11.</span> <span class="toc-text">├─ useZIndex.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-vite-config-ts"><span class="toc-number">6.5.12.</span> <span class="toc-text">├─ vite.config.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%94%E2%94%80-test"><span class="toc-number">6.5.13.</span> <span class="toc-text">└─ test</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-test-tsx"><span class="toc-number">6.5.13.1.</span> <span class="toc-text">├─ index.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-useClickOutset-test-tsx"><span class="toc-number">6.5.13.2.</span> <span class="toc-text">├─ useClickOutset.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-useEventListener-test-tsx"><span class="toc-number">6.5.13.3.</span> <span class="toc-text">└─ useEventListener.test.tsx</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%9C%E2%94%80-locale"><span class="toc-number">6.6.</span> <span class="toc-text">├─ locale</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-22"><span class="toc-number">6.6.1.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-lang"><span class="toc-number">6.6.2.</span> <span class="toc-text">├─ lang</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-en-ts"><span class="toc-number">6.6.2.1.</span> <span class="toc-text">├─ en.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-ja-ts"><span class="toc-number">6.6.2.2.</span> <span class="toc-text">├─ ja.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-ko-ts"><span class="toc-number">6.6.2.3.</span> <span class="toc-text">├─ ko.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-zh-cn-ts"><span class="toc-number">6.6.2.4.</span> <span class="toc-text">├─ zh-cn.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-zh-tw-ts"><span class="toc-number">6.6.2.5.</span> <span class="toc-text">└─ zh-tw.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%94%E2%94%80-package-json-3"><span class="toc-number">6.6.3.</span> <span class="toc-text">└─ package.json</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%9C%E2%94%80-play"><span class="toc-number">6.7.</span> <span class="toc-text">├─ play</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-storybook"><span class="toc-number">6.7.1.</span> <span class="toc-text">├─ .storybook</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-main-js"><span class="toc-number">6.7.1.1.</span> <span class="toc-text">├─ main.js</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-preview-js"><span class="toc-number">6.7.1.2.</span> <span class="toc-text">└─ preview.js</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-html"><span class="toc-number">6.7.2.</span> <span class="toc-text">├─ index.html</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-public"><span class="toc-number">6.7.3.</span> <span class="toc-text">├─ public</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-vite-svg"><span class="toc-number">6.7.3.1.</span> <span class="toc-text">└─ vite.svg</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-src"><span class="toc-number">6.7.4.</span> <span class="toc-text">├─ src</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-App-vue"><span class="toc-number">6.7.4.1.</span> <span class="toc-text">├─ App.vue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-main-ts"><span class="toc-number">6.7.4.2.</span> <span class="toc-text">├─ main.ts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-stories"><span class="toc-number">6.7.4.3.</span> <span class="toc-text">├─ stories</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Alert-stories-tsx"><span class="toc-number">6.7.4.3.1.</span> <span class="toc-text">├─ Alert.stories.tsx</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%94%9C%E2%94%80-Button-stories-ts"><span class="toc-number">6.7.4.3.2.</span> <span class="toc-text">├─ Button.stories.ts</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%94%94%E2%94%80-Collapse-stories-ts"><span class="toc-number">6.7.4.3.3.</span> <span class="toc-text">└─ Collapse.stories.ts</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-vite-env-d-ts"><span class="toc-number">6.7.4.4.</span> <span class="toc-text">└─ vite-env.d.ts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-vite-config-ts-1"><span class="toc-number">6.7.5.</span> <span class="toc-text">├─ vite.config.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-README-md"><span class="toc-number">6.7.6.</span> <span class="toc-text">├─ README.md</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%94%E2%94%80-package-json-4"><span class="toc-number">6.7.7.</span> <span class="toc-text">└─ package.json</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%9C%E2%94%80-theme"><span class="toc-number">6.8.</span> <span class="toc-text">├─ theme</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-css"><span class="toc-number">6.8.1.</span> <span class="toc-text">├─ index.css</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-package-json-3"><span class="toc-number">6.8.2.</span> <span class="toc-text">├─ package.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%94%E2%94%80-reset-css"><span class="toc-number">6.8.3.</span> <span class="toc-text">└─ reset.css</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%94%94%E2%94%80-utils"><span class="toc-number">6.9.</span> <span class="toc-text">└─ utils</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-error-ts"><span class="toc-number">6.9.1.</span> <span class="toc-text">├─ error.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-ts-23"><span class="toc-number">6.9.2.</span> <span class="toc-text">├─ index.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-install-ts"><span class="toc-number">6.9.3.</span> <span class="toc-text">├─ install.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-package-json-4"><span class="toc-number">6.9.4.</span> <span class="toc-text">├─ package.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%9C%E2%94%80-style-ts"><span class="toc-number">6.9.5.</span> <span class="toc-text">├─ style.ts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%94%94%E2%94%80-tests"><span class="toc-number">6.9.6.</span> <span class="toc-text">└─ tests</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-error-test-tsx"><span class="toc-number">6.9.6.1.</span> <span class="toc-text">├─ error.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%9C%E2%94%80-index-test-tsx-1"><span class="toc-number">6.9.6.2.</span> <span class="toc-text">├─ index.test.tsx</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%94%94%E2%94%80-install-test-tsx"><span class="toc-number">6.9.6.3.</span> <span class="toc-text">└─ install.test.tsx</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-package-json-5"><span class="toc-number">7.</span> <span class="toc-text">├─ package.json</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-pnpm-lock-yaml"><span class="toc-number">8.</span> <span class="toc-text">├─ pnpm-lock.yaml</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-pnpm-workspace-yaml"><span class="toc-number">9.</span> <span class="toc-text">├─ pnpm-workspace.yaml</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-postcss-config-cjs"><span class="toc-number">10.</span> <span class="toc-text">├─ postcss.config.cjs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-tsconfig-build-json"><span class="toc-number">11.</span> <span class="toc-text">├─ tsconfig.build.json</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-tsconfig-json"><span class="toc-number">12.</span> <span class="toc-text">├─ tsconfig.json</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-tsconfig-node-json"><span class="toc-number">13.</span> <span class="toc-text">├─ tsconfig.node.json</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%9C%E2%94%80-vitest-config-ts"><span class="toc-number">14.</span> <span class="toc-text">├─ vitest.config.ts</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E2%94%94%E2%94%80-vitest-setup-ts"><span class="toc-number">15.</span> <span class="toc-text">└─ vitest.setup.ts</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%84%E5%B7%A5%E4%BD%9C%E5%8C%BA%E4%BE%9D%E8%B5%96%E7%8E%AF%E5%A2%83%E8%AF%A6%E6%83%85"><span class="toc-number">16.</span> <span class="toc-text">各工作区依赖环境详情</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B9%E7%9B%AE%E5%BD%95"><span class="toc-number">16.1.</span> <span class="toc-text">根目录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#packages-utils"><span class="toc-number">16.1.1.</span> <span class="toc-text">&#x2F;packages&#x2F;utils</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages-components"><span class="toc-number">16.1.2.</span> <span class="toc-text">&#x2F;packages&#x2F;components</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages-constants"><span class="toc-number">16.1.3.</span> <span class="toc-text">&#x2F;packages&#x2F;constants</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages-core"><span class="toc-number">16.1.4.</span> <span class="toc-text">&#x2F;packages&#x2F;core</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages-docs"><span class="toc-number">16.1.5.</span> <span class="toc-text">&#x2F;packages&#x2F;docs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages-hooks"><span class="toc-number">16.1.6.</span> <span class="toc-text">&#x2F;packages&#x2F;hooks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages-locale"><span class="toc-number">16.1.7.</span> <span class="toc-text">&#x2F;packages&#x2F;locale</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages-play"><span class="toc-number">16.1.8.</span> <span class="toc-text">&#x2F;packages&#x2F;play</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages-theme"><span class="toc-number">16.1.9.</span> <span class="toc-text">&#x2F;packages&#x2F;theme</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/05/12/JS/%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2/" title="隐式转换"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://bu.dusays.com/2025/03/05/67c7e99e3513a.png" onerror="this.onerror=null;this.src='https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif'" alt="隐式转换"/></a><div class="content"><a class="title" href="/2025/05/12/JS/%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2/" title="隐式转换">隐式转换</a><time datetime="2025-05-11T16:14:38.220Z" title="发表于 2025-05-12 00:14:38">2025-05-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/12/JS/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="数据类型"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://bu.dusays.com/2025/03/05/67c7e99e3513a.png" onerror="this.onerror=null;this.src='https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif'" alt="数据类型"/></a><div class="content"><a class="title" href="/2025/05/12/JS/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="数据类型">数据类型</a><time datetime="2025-05-11T16:14:07.985Z" title="发表于 2025-05-12 00:14:07">2025-05-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/12/JS/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/" title="单点登录"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://bu.dusays.com/2025/03/05/67c7e99e3513a.png" onerror="this.onerror=null;this.src='https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif'" alt="单点登录"/></a><div class="content"><a class="title" href="/2025/05/12/JS/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/" title="单点登录">单点登录</a><time datetime="2025-05-11T16:13:30.112Z" title="发表于 2025-05-12 00:13:30">2025-05-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/12/JS/%E5%8E%9F%E5%9E%8B%E5%8E%9F%E5%9E%8B%E9%93%BE/" title="原型原型链"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://bu.dusays.com/2025/03/05/67c7e99e3513a.png" onerror="this.onerror=null;this.src='https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif'" alt="原型原型链"/></a><div class="content"><a class="title" href="/2025/05/12/JS/%E5%8E%9F%E5%9E%8B%E5%8E%9F%E5%9E%8B%E9%93%BE/" title="原型原型链">原型原型链</a><time datetime="2025-05-11T16:11:59.720Z" title="发表于 2025-05-12 00:11:59">2025-05-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/11/JS/new%E6%93%8D%E4%BD%9C%E7%AC%A6/" title="new操作符"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://bu.dusays.com/2025/03/05/67c7e99e3513a.png" onerror="this.onerror=null;this.src='https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif'" alt="new操作符"/></a><div class="content"><a class="title" href="/2025/05/11/JS/new%E6%93%8D%E4%BD%9C%E7%AC%A6/" title="new操作符">new操作符</a><time datetime="2025-05-11T13:27:12.318Z" title="发表于 2025-05-11 21:27:12">2025-05-11</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2025 By <a class="footer-bar-link" href="/" title="Breezli" target="_blank">Breezli</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#footer-type-tips", {
      strings: ["总思念，紫竹萧萧月如钩，溪光摇荡屋如舟","思念那，青山在，绿水流。","-----","花繁一瞬，形色浮云","撇去眼前浮云，方得心之自由。","-----","即使最后归于空寂","过程之间的有情","也同样动容。","-----"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("footer-type-tips").innerHTML = '总思念，紫竹萧萧月如钩，溪光摇荡屋如舟'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">9</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">使用</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://docs.anheyu.com/" title="安知鱼主题"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://docs.anheyu.com/favicon.ico" alt="安知鱼主题"/><span class="back-menu-item-text">安知鱼主题</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://7bu.top/" title="去不图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://bu.dusays.com/2025/03/05/67c7f047dfa72.gif&quot;" data-lazy-src="https://7bu.top/favicon.ico" alt="去不图床"/><span class="back-menu-item-text">去不图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><span> 首页</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/music/?id=13242559326&amp;server=netease"><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/charts/"><i class="anzhiyufont anzhiyu-icon-cube faa-tada" style="font-size: 0.9em;"></i><span> 统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 梦境</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-plant-fill faa-tada" style="font-size: 0.9em;"></i><span> 簪花人间</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/cinema/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 匣中秋水</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/gallerygroup/"><i class="anzhiyufont anzhiyu-icon-instagram faa-tada" style="font-size: 0.9em;"></i><span> 彩云霁月</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 社交</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友链</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/games/"><i class="anzhiyufont anzhiyu-icon-rocket faa-tada" style="font-size: 0.9em;"></i><span> 游戏</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="13242559326" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.5"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/#/playlist?id=13242559326&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>var meting_api = "https://meting.qjqq.cn/?server=:server&type=:type&id=:id&auth=:auth&r=:r";
</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  //- const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  const grt = new Date("2025-3-1");
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);

  const ascll = [
    `   原来我这几十年的岁月，不过只是这样一个简单的故事.`,
    `
                                                                         
██████╗ ██████╗ ███████╗███████╗███████╗██╗     ██╗
██╔══██╗██╔══██╗██╔════╝██╔════╝╚══███╔╝██║     ██║
██████╔╝██████╔╝█████╗  █████╗    ███╔╝ ██║     ██║
██╔══██╗██╔══██╗██╔══╝  ██╔══╝   ███╔╝  ██║     ██║
██████╔╝██║  ██║███████╗███████╗███████╗███████╗██║
╚═════╝ ╚═╝  ╚═╝╚══════╝╚══════╝╚══════╝╚══════╝╚═╝

    `,
    "   已上线", dnum, "天",
    "©2025 By 松风狸 V1.6.14",
  ];

  setTimeout(
    Log.bind(
      console,
      "%c ⚡ %c 你正在访问 Breezli 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}%c\n`,
      "color:#ffb07c",
      "color:#ffb07c",
      "color:#ffb07c",
      "color:#ffb07c",
      "color:#ffb07c",
      "color:#ffb07c",
      "color:#425AEF"
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好,旅行客。", "color:white; background-color:#4f90d9", ""));
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script src="/countdown/countdown.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/echarts/4.9.0-rc.1/echarts.min.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>